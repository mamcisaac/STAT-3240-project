<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Chapter 3</title>
    <meta charset="utf-8" />
    <meta name="author" content="Michael McIsaac" />
    <script src="chapter3_files/header-attrs/header-attrs.js"></script>
    <script src="chapter3_files/htmlwidgets/htmlwidgets.js"></script>
    <link href="chapter3_files/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="chapter3_files/datatables-binding/datatables.js"></script>
    <script src="chapter3_files/jquery/jquery-3.6.0.min.js"></script>
    <link href="chapter3_files/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="chapter3_files/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="chapter3_files/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="chapter3_files/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="chapter3_files/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Chapter 3
]
.subtitle[
## STAT 3240
]
.author[
### Michael McIsaac
]
.institute[
### UPEI
]

---












### 3: Diagnostics and Remedial Measures

We can't be certain in advance that a regression model is appropriate. 

The features of the model, such as linearity of the regression function or normality of the error terms, may not be appropriate for the particular data at hand. 

It is important to examine the aptness of the model for the data before inferences based on that model are undertaken. 

---

### Learning Objectives for Sections 3.1-3.3 

After Sections 3.1-3.3, you should be able to 

- Distinguish between residual, studentized residuals, and error term
- Identify outlying `\(X\)` values that could influence the regression function	
- Use residual plots to conduct regression diagnostics


---

### 3.1: Diagnostics for Predictor Variable

We begin by considering some graphic diagnostics for the predictor variable. 

We need diagnostic information about the predictor variable to see if there are any outlying `\(X\)` values that could **influence** the appropriateness of the fitted regression function.


---

&lt;img src="chapter3_files/figure-html/unnamed-chunk-1-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

&lt;img src="chapter3_files/figure-html/unnamed-chunk-2-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

&lt;img src="chapter3_files/figure-html/unnamed-chunk-3-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

&lt;img src="chapter3_files/figure-html/unnamed-chunk-4-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
boxplot(x, horizontal=TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-5-1.png" width="504" style="display: block; margin: auto;" /&gt;


```r
dotPlot(~x)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-6-1.png" width="504" style="display: block; margin: auto;" /&gt;



---
layout: true
class: inverse

---

Income and Clothing Expenditure for a small subset of the Survey of Household Spending are displayed below:
 

```r
clothing_model = lm(clothing_expenditure~income, data=spending_subset)
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-7-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
boxplot(spending_subset$income, horizontal = TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-8-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
dotPlot(~income, data=spending_subset)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-8-2.png" width="504" style="display: block; margin: auto;" /&gt;


---
### CDI: Pearson Correlation - physicians vs hospital beds


```r
xyplot(number_physicians ~ number_hospital_beds, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-9-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
boxplot(cdi$number_hospital_beds, horizontal = TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-10-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
dotPlot(~number_hospital_beds, data=cdi, cex=15, nint=20)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-10-2.png" width="504" style="display: block; margin: auto;" /&gt;


---
### CDI: Pearson Correlation - physicians vs population 



```r
xyplot(number_physicians ~ population, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-11-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
boxplot(cdi$population, horizontal = TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-12-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
dotPlot(~population, data=cdi, cex=15, nint=20)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-12-2.png" width="504" style="display: block; margin: auto;" /&gt;




---

### CDI: Pearson Correlation - physicians vs total income


```r
xyplot(number_physicians ~ total_personal_income, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-13-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
boxplot(cdi$total_personal_income, horizontal = TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-14-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
dotPlot(~total_personal_income, data=cdi, cex=15, nint=20)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-14-2.png" width="504" style="display: block; margin: auto;" /&gt;



&lt;!-- Need to be VERY BRIEF in my lectures; do most explaining through examples throughout. Do not try to present everything. Let them read the book! --&gt;

---

layout: false 

### 3.2 Residuals


The **residual** `\(e_i\)` is the difference between the observed value and the fitted value:
`$$e_i = Y_i - \hat Y_i$$`

--

The residual may be regarded as the observed error, in distinction to the unknown **true error** in the regression model:
`$$\varepsilon_i = Y_i - E[Y_i].$$`

--

The error terms `\(\varepsilon_i\)` are assumed to be independent normal random variables, with mean 0 and constant variance `\(\sigma^2\)`. 

If the model is appropriate for the data at hand, the observed residuals `\(e_i\)` should then reflect these properties.




---

### Semistudentized Residuals:


$$ e^\ast_i = \frac{e_i - \bar e}{\sqrt{MSE}} = \frac{e_i}{\sqrt{MSE}}.$$

--

&lt;!-- If `\(\sqrt{MSE}\)` were an estimate of the standard deviation of the residual `\(e_i\)`, we would call `\(e^\ast_i\)` a *studentized residual*.  --&gt;

* The standard deviation of `\(e_i\)` is complex and varies for the different residuals `\(e_i\)`
* `\(\sqrt{MSE}\)` is only an approximation of the standard deviation of `\(e_i\)`. 

Hence, we call the statistic `\(e^\ast_i\)` a **semistudentized residual** 

--

Studentized residuals (which divide by the true sample standard deviation) are in Chapter 10. 

Both semistudentized residuals and studentized residuals can be very helpful in identifying outlying observations.

---

### Departures from Model to Be Studied by Residuals

Six important types of departures from the simple linear regression model with normal errors:

1. The regression function is not linear.
2. The error terms do not have constant variance.
3. The error terms are not independent.
4. The model fits all but one or a few outlier observations.
5. The error terms are not normally distributed.
6. One or several important predictor variables have been omitted from the model.

--

The following plots of residuals (or semistudentized residuals) will be used:

1. Plot of residuals against predictor variable.
2. Plot of absolute or squared residuals against predictor variable.
3. Plot of residuals against fitted values.
4. Plot of residuals against time or other sequence.
5. Plots of residuals against omitted predictor variables.
6. Box plot of residuals.
7. Normal probability plot of residuals.


&lt;!-- herehere: basically only examples for all the following --&gt;
---

### Nonlinearity of Regression Function

* Plot of residuals against predictor variable.
* Plot of residuals against fitted values.

We are looking at whether points fall within a band around the regression line. 

I.e., we are looking at whether residuals fall in a horizontal band around 0. 

.pull-left[
&lt;img src="img/Figure3p4a.png" width="60%" style="display: block; margin: auto;" /&gt;
]

vs, for example, 

.pull-right[
&lt;img src="img/Figure3p4b.png" width="60%" style="display: block; margin: auto;" /&gt;
]

---
layout: true
class: inverse

---


```r
xyplot(resid(clothing_model)~predict(clothing_model), ylab="Residuals", xlab="Predicted Values", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-18-1.png" width="504" style="display: block; margin: auto;" /&gt;


* **Evaluate the appropriateness of the regression model based on the provided residual plots.**


---
layout: false

### Nonconstancy of Error Variance

* Plot of residuals against predictor variable.
* Plot of absolute or squared residual sagainst predictor variable.

We are looking for a constant variance in the residuals.

I.e., we are looking at whether residuals fall in a horizontal band around 0. 

.pull-left[
&lt;img src="img/Figure3p4a.png" width="60%" style="display: block; margin: auto;" /&gt;
]

vs, for example, 

.pull-right[
&lt;img src="img/Figure3p4c.png" width="60%" style="display: block; margin: auto;" /&gt;
]

---
layout: true
class: inverse
---


```r
xyplot(resid(clothing_model)~predict(clothing_model), ylab="Residuals", xlab="Predicted Values", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-21-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(abs(resid(clothing_model))~predict(clothing_model), ylab="Absolute Residuals", xlab="Predicted Values", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-21-2.png" width="504" style="display: block; margin: auto;" /&gt;

---

&lt;!-- ### physicians vs hospital beds --&gt;


```r
xyplot(resid(mod_physician_beds)~predict(mod_physician_beds), ylab="Residuals", xlab="Predicted Values", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-22-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(abs(resid(mod_physician_beds))~predict(mod_physician_beds), ylab="Absolute Residuals", xlab="Predicted Values", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-22-2.png" width="504" style="display: block; margin: auto;" /&gt;



---
layout: false


### Presence of Outliers
* Plot of residuals against predictor variable.
* Plot of residuals against fitted values.
* Box plot of (semi-studentized) residuals.

We are looking for extreme observations. 

Outliers can create great difficulty: their *squared deviation* will be huge and will disproportionately impact the least squares estimates. 

---
layout: true
class: inverse
---


```r
boxplot(resid(clothing_model), ylab="Residuals", horizontal=TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-23-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
boxplot(resid(clothing_model)/summary(clothing_model)$sigma, ylab="Residuals", horizontal=TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-23-2.png" width="504" style="display: block; margin: auto;" /&gt;
--

A rough rule of thumb ... is to consider semistudentized residuals with absolute value of four or more to be outliers.

---

&lt;!-- ### physicians vs hospital beds --&gt;


```r
xyplot(number_physicians ~ number_hospital_beds, data=cdi, ylab="Residuals", xlab="Predicted Values", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-24-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
boxplot(resid(mod_physician_beds)/summary(mod_physician_beds)$sigma, ylab="Semi-studentized Residuals", horizontal=TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-24-2.png" width="504" style="display: block; margin: auto;" /&gt;


---
layout: false

### Nonindependence of Error Terms
* Plot of residuals against time or other sequence.


&lt;img src="img/Figure3p4d.png" width="60%" style="display: block; margin: auto;" /&gt;

---

This type of plot usually makes more sense for experimental studies, where we are worried that something changes over time as the experiment runs (processes change, protocols evolve, tools breakdown, etc). 

For observational studies, we normally need to explore the study design for potential violations to the independence assumption: 

* clustering of students in schools
* similar spending habits in different provinces
* etc.

---

### Nonnormality of Error Terms

* Box plot of residuals.
* Normal probability plot of residuals.

Look for linearity in a normal probability (Q-Q) plot


&lt;img src="img/Figure3p9.png" width="978" style="display: block; margin: auto;" /&gt;



---
layout: true
class: inverse
---


```r
car::qqPlot(resid(clothing_model), ylab="Residuals")
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-27-1.png" width="504" style="display: block; margin: auto;" /&gt;


---


```r
xyplot(resid(clothing_model)~predict(clothing_model), ylab="Residuals", xlab="Predicted Values", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-28-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
boxplot(resid(clothing_model), ylab="Residuals", horizontal=TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-28-2.png" width="504" style="display: block; margin: auto;" /&gt;


---

### physicians vs hospital beds


```r
car::qqPlot(resid(mod_physician_beds), ylab="Residuals")
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-29-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
xyplot(resid(mod_physician_beds)~predict(mod_physician_beds), ylab="Residuals", xlab="Predicted Values", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-30-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
boxplot(resid(mod_physician_beds), ylab="Residuals", horizontal=TRUE)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-30-2.png" width="504" style="display: block; margin: auto;" /&gt;

---
layout: false


### Omission of Important Predictor Variables

* Plots of residuals against omitted predictor variables.

Look at whether there are other key variables that could provide important additional descriptive and predictive power to the model.

These additional variables may make our assumptions more tenable, or they may simply make our model better at predicting. 

&lt;img src="img/Figure3p4d.png" width="370" style="display: block; margin: auto;" /&gt;


---
layout: true
class: inverse
---


```r
clothing_model = lm(clothing_expenditure~income, data=spending_subset)
xyplot(resid(clothing_model)~spending_subset$food_expenditure, ylab="Residuals = clothing_expenditure - (b0 + b1 income) ", xlab="Food Expenditure", type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-32-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
xyplot(resid(mod_physician_beds)~cdi$population, ylab="Residuals", xlab="Population", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-33-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(resid(mod_physician_beds)~cdi$total_personal_income, ylab="Residuals", xlab="Total Personal Income", type=c("p", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-33-2.png" width="504" style="display: block; margin: auto;" /&gt;


---
layout: false

### Some Final Comments

1. Several types of departures may occur together. 

2. Although graphic analysis of residuals is only an informal method of analysis, in many cases it suffices for examining the aptness of a model.

3. The basic approach to residual analysis explained here applies not only to simple linear regression but also to more complex regression and other types of statistical models.

---

### Some Final Comments


* The presence of outliers can be serious for smaller data sets when their influence is large. 

* nonindependence of error terms results in estimators that are unbiased but whose variances are seriously biased. 

* Nonconstancy of error variance tends to be less serious, leading to less efficient estimates and invalid error variance estimates. 

---

### Recap: Sections 3.1-3.3 

After Sections 3.1-3.3, you should be able to 

- Distinguish between residual, studentized residuals, and error term
- Identify outlying `\(X\)` values that could influence the regression function	
- Use residual plots to conduct regression diagnostics





---

### Learning Objectives for Sections 3.4-3.7

After Sections 3.4-3.7, you should be able to 

-	Understand that their are formal tests for residual diagnostics	
- Apply formal tests for normality and constant variance
- Carry out and interpret the F test for lack of fit. 


---

### 3.4: Overview of Tests Involving Residuals

Graphic analysis of residuals is inherently subjective. 

Nevertheless, subjective analysis of a variety of interrelated residual plots will frequently reveal difficulties with the model more clearly than particular formal tests. 

There are occasions, however, when one wishes to put specific questions to a test. 

We will *briefly* review some of the relevant tests.

---


### Tests for Outliers

A simple test for identifying an outlier observation involves fitting a new regression line to the other `\(n-1\)` observations and determining the probability that, in `\(n\)` observations, a deviation from the fitted line as great as that of the outlier will be obtained by chance. 

* We will discuss this more in Chapter 10. 

---

### Tests for Normality

Goodness of fit tests can be used for examining the normality of the error terms. 

For instance, the chi-square test or the Kolmogorov-Smirnov test and its modification, the Lilliefors test, can be employed for testing the normality of the error terms by analyzing the residuals. 

---

### 3.5: Correlation Test for Normality

In addition to visually assessing the approximate linearity of the points plotted in a normal probability plot, a formal test for normality of the error terms can be conducted by calculating the coefficient of correlation between the residuals `\(e_i\)` and their expected values under normality. 

A high value ( `\(&gt; .987\)` for `\(n \geq 100\)`; see Table B.6) of the correlation coefficient is indicative of normality. 


---

layout: true
class: inverse

---



```r
olsrr::ols_test_correlation(clothing_model)
```

```
## [1] 0.9561807
```

```r
olsrr::ols_test_normality(clothing_model)
```

```
## -----------------------------------------------
##        Test             Statistic       pvalue  
## -----------------------------------------------
## Shapiro-Wilk              0.9134         0.0000 
## Kolmogorov-Smirnov        0.1131         0.0120 
## Cramer-von Mises         17.7917         0.0000 
## Anderson-Darling          4.1848         0.0000 
## -----------------------------------------------
```


```r
car::qqPlot(resid(clothing_model), ylab="Residuals")
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-35-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

layout: false


&lt;img src="img/Lumley.png" width="60%" style="display: block; margin: auto;" /&gt;

&lt;!-- errors being normally distributed ==&gt; \beta_0 and \beta_1 being normally distributed ==&gt; \hat Y being normally distributed, so CIs and hypothesis testing are appropriate.  --&gt;
&lt;!-- However, we can get \beta_0 and \beta_1 being normally distributed from the CLT if n is big enough ("big enough" depends on the degree of non-normality of errors) --&gt;


---


&gt; The t-test and least-squares linear regression do not require any assumption of Normal distribution in sufficiently large samples. Previous simulations studies show that “sufficiently large” is often under 100, and even for our extremely non-Normal medical cost data it is less than 500.

--

&gt; Formal  statistical  tests for Normality are especially undesirable as they will have low power in the small samples where the distribution matters and high power only in large samples where the distribution is unimportant.


---
class: inverse

### SHS: Sampling distribution of `\(b_1\)`

```r
b1 = lm(clothing_expenditure~income, data=spending_subset)$coef[2]
for (i in 1:1000)
{ n=200
  spending_subset_resample = dplyr::sample_n(spending_subset_all, size=n, replace=TRUE)
  b1 = c(b1, lm(clothing_expenditure~income, data=spending_subset_resample)$coef[2])}
```

.pull-left[

```r
histogram(b1)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-38-1.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
qqPlot(b1)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-39-1.png" width="504" style="display: block; margin: auto;" /&gt;
]

--


```r
confint(clothing_model)[2,]
```

```
##      2.5 %     97.5 % 
## 0.00814473 0.03426691
```


---

&gt; A more important assumption is that the variance of `\(Y\)` is constant... differences in the variance of `\(Y\)` for different values of `\(X\)` (heteroscedasticity) result in coefficient estimates `\(\hat \beta\)` that still have a Normal distribution, ... [but] the variance estimates may be incorrect.


---

### 3.6: Tests for Constancy of Error Variance

Simple tests for constancy of the error variance:

* look at the rank correlation between the absolute values of the residuals and the corresponding values of the predictor variable

* the Brown-Forsythe test

* the Breusch-Pagan test

---

### Brown-Forsythe test

We want to know if the variance of `\(e_i\)` changes as `\(X\)` changes.

1. Divide the residuals into two groups: those from small `\(X\)` and those from large `\(X\)`

2. Find the absolute deviations of the residuals around the median 

3. Test whether these deviations have the same mean in the two different groups

--

This will tell us if the residuals tend to vary a lot more in one of the groups. 

---
layout:true

class: inverse
---


```r
spending_subset$income_range = gtools::quantcut(spending_subset$income, 2)
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b0ac9a3a359afd6be457" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b0ac9a3a359afd6be457">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],["NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL"],["single_detached","single_detached","single_detached","row_house","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","single_detached","single_detached","apartment","apartment","apartment","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","semi_detached","duplex","single_detached","semi_detached","semi_detached","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","semi_detached","single_detached","single_detached","single_detached","single_detached","semi_detached","semi_detached","semi_detached","row_house","row_house","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","single_detached","duplex","duplex","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","duplex","duplex","single_detached","duplex","duplex","row_house","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","duplex","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","duplex","other","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","semi_detached","semi_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","semi_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","row_house","single_detached","single_detached","semi_detached","single_detached","single_detached","semi_detached"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000,33000,57000,50000,38000,75000,76000,74000,21000,45000,66000,38000,23000,26000,15000,69000,24000,60000,38000,36000,60000,30000,30000,40000,68000,52000,52000,21000,42000,60000,54000,53000,40000,70000,25000,59000,65000,31000,13000,35000,35000,45000,50000,50000,30000,42000,75000,69000,37000,95000,45000,37000,30000,40000,28000,45000,29000,28000,37000,60000,34000,41000,50000,58000,52000,69000,40000,90000,31000,33000,60000,35000,17000,27000,19000,43000,24000,46000,20000,45000,10000,84000,34000,55000,20000,32000,40000,26000,30000,70000,44000,46000,41000,70000,50000,82000,42000,23000,35000,33000,16000,54000,20000,32000,62000,27000,33000,24000,46000,77000,31000,32000,34000,19000,50000,31000,75000,25000,55000,29000,55000,25000,29000,43000,65000,53000,26000,43000,27000,50000,23000,14000,32000,38000,53000,30000,30000,45000,28000,50000,55000,60000,59000,55000,24000,42000,21000,54000,50000,48000,8000,52000,26000,45000,42000,21000,51000,37000,26000,59000,22000,37000,28000,30000,66000,25000,62000,49000,74000,34000,42000],["never_married","never_married","married","never_married","married","married","other","married","never_married","other","married","never_married","other","other","never_married","never_married","other","married","never_married","other","other","never_married","married","married","married","married","other","other","married","married","other","never_married","other","never_married","other","never_married","never_married","married","married","never_married","never_married","married","married","married","married","never_married","married","married","married","never_married","married","married","never_married","married","never_married","married","never_married","married","married","married","married","married","married","married","married","other","married","married","married","married","other","married","never_married","never_married","never_married","married","married","married","married","married","other","married","married","married","other","other","married","never_married","married","married","other","other","married","married","never_married","married","married","never_married","married","married","married","married","married","other","married","married","married","other","other","married","married","married","married","married","never_married","other","other","married","married","married","never_married","married","married","married","married","married","never_married","married","married","married","other","other","married","married","married","married","married","married","other","married","married","married","married","married","married","married","never_married","married","married","married","married","never_married","married","married","married","never_married","married","married","married","other","never_married","married","married","married","married","married","married","never_married","married","married","married","married","married","married","married","married","married","married","never_married","married","other","married","married","never_married","married","married","married","married","married","married","married","married","married","never_married","married","married","married","married","never_married","married"],["30-34","25-29","35-39","30-34","25-29","25-29","55-59","55-59","25-29","40-44","50-54","25-29","50-54","50-54","&lt;25","&lt;25","50-54","40-44","35-39","40-44","50-54","50-54","55-59","45-49","30-34","25-29","35-39","60-64","25-29","30-34","30-34","&lt;25","55-59","25-29","55-59","40-44","30-34","35-39","55-59","30-34","25-29","60-64","45-49","55-59","25-29","&lt;25","45-49","40-44","40-44","40-44","40-44","25-29","25-29","50-54","30-34","45-49","30-34","50-54","40-44","60-64","55-59","40-44","25-29","45-49","40-44","65-69","30-34","&lt;25","45-49","45-49","40-44","40-44","45-49","40-44","35-39","45-49","35-39","35-39","35-39","25-29","60-64","25-29","50-54","40-44","45-49","40-44","45-49","55-59","40-44","45-49","40-44","55-59","30-34","45-49","35-39","25-29","45-49","25-29","&lt;25","55-59","55-59","65-69","25-29","50-54","45-49","40-44","55-59","50-54","30-34","50-54","35-39","40-44","50-54","30-34","35-39","40-44","50-54","25-29","30-34","50-54","25-29","35-39","30-34","40-44","50-54","50-54","40-44","55-59","50-54","35-39","50-54","60-64","60-64","55-59","35-39","50-54","35-39","40-44","65-69","50-54","60-64","55-59","35-39","35-39","40-44","50-54","40-44","35-39","50-54","35-39","45-49","30-34","45-49","45-49","30-34","60-64","40-44","45-49","45-49","55-59","35-39","55-59","35-39","50-54","40-44","55-59","40-44","25-29","60-64","45-49","35-39","50-54","40-44","45-49","40-44","45-49","55-59","50-54","30-34","30-34","40-44","&lt;25","45-49","40-44","40-44","50-54","50-54","50-54","55-59","45-49","45-49","40-44","50-54","45-49","45-49","30-34","45-49","40-44","25-29","65-69"],["female","male","male","female","female","male","female","male","female","female","female","male","male","female","female","female","female","female","male","male","female","female","female","male","male","male","male","female","female","female","female","male","female","female","male","female","male","male","male","female","male","male","female","female","male","female","female","male","male","male","female","male","female","male","female","male","female","male","male","male","male","male","male","female","male","male","male","female","male","female","male","male","female","female","male","male","male","male","male","male","female","female","male","male","female","female","female","female","female","male","female","female","male","male","male","male","male","female","female","male","male","female","female","female","male","female","male","female","male","male","male","female","male","male","female","female","female","female","male","female","female","male","male","male","male","male","female","female","male","female","female","female","male","male","female","male","male","female","female","female","male","female","female","male","male","male","male","female","male","male","male","female","male","female","male","female","male","male","male","male","female","male","female","male","male","male","male","female","male","male","male","male","male","male","male","male","male","female","female","male","female","female","male","male","female","male","female","female","male","male","female","female","male","female","female","male","female","female","female","male"],[3940,7350,5150,6240,4480,10120,3200,10200,2850,6500,5400,5180,8100,6040,3800,2800,8880,10825,4450,9120,4300,4440,8400,9000,4800,3010,6000,3950,8740,4500,5340,3300,3000,2350,7140,2650,8150,6700,12900,2200,4840,7570,14080,5800,8850,4420,10400,8800,5050,5410,8000,7060,3800,3490,5440,9200,6000,9890,7800,6280,5430,9710,5600,4500,10800,11100,6000,5700,5160,7050,4940,7460,3450,9500,6400,7800,6860,7350,7300,4780,2600,6815,5500,6800,6100,6750,3300,7900,15800,7830,11440,4200,9580,6650,6400,3350,9620,3240,4000,8500,7100,7780,11000,3900,6700,9260,14404,2700,5200,6480,9500,7200,5680,4940,6200,16900,7740,760,8500,3460,4318,6860,6600,7700,9000,6250,3950,6400,4900,3380,7800,1810,6440,6000,14600,5000,6420,7700,4500,5750,9120,10800,6300,6540,8900,6400,7800,1290,7850,5900,5400,9800,7200,6960,5400,3800,11300,8100,8100,3640,5440,7100,8800,5895,8550,6200,13000,4400,11440,8050,5550,3290,7800,6300,4950,5090,6760,7800,1850,4775,2810,5400,5400,4750,12600,4940,13396,6470,10520,5800,8050,8650,5044,5800,6600,5150,11880,6440,2260,3900],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800,313,3000,3440,1570,2475,630,1570,3001,955,3790,1910,1860,2205,4180,7790,1900,1000,3280,2355,1740,5520,1240,3450,1130,3140,3040,1500,1408,455,1000,1120,3410,2655,1800,3830,2250,1100,500,1200,3545,200,3620,2172,3940,1644,2090,909,935,1730,1870,1250,1095,982,1555,5140,1660,1670,4810,2300,1050,4670,3500,2700,2370,3650,910,3100,550,2500,3885,970,1380,2395,1300,1550,7075,4030,1270,1100,820,5505,2400,2390,1130,3250,3470,1790,1850,3400,980,3198,3225,5060,5380,4000,2780,360,4050,1510,3052,3800,525,1609,1510,6840,4140,3415,3350,8600,3560,7890,4660,1540,2215,2710,1550,715,3745,2415,3880,3650,2760,4895,4075,2825,575,4095,1895,2509,232,1135,1419,6120,1930,3995,1580,6105,3025,3340,1360,4190,2440,1655,1460,5210,5300,1410,3050,2550,1260,1550,400,2675,1680,3600,2760,1700,1310,3675,1270,3100,7350,1270,1363,1676,5380,2610,5800,2300,485],[32670,8396,3456,5308,11576,4501,7846,7982,560,6649,12601,6481,24900,2640,2550,5029,8343,8450,4405,9910,8206,22450,6440,10340,7282,4090,150,4622,4751,6062,60,9478,10666,7371,4670,4454,4578,4826,8326,22616,2266,6420,3821,3296,12695,6590,4940,21049,555,5370,7640,3748,15394,3274,4300,3664,40,4815,15166,8054,4850,9880,10147,5440,16718,4188,3841,4280,23202,4840,2040,26080,4145,6444,8960,10412,5567,23193,3776,9376,18930,38620,8428,29320,9285,550,5952,5690,4406,16553,4830,4370,11102,8700,20130,32700,11860,1160,1200,9080,2326,3664,5966,6596,10970,26333,9526,70,2580,5676,8906,12288,9442,4940,4380,5860,13298,3514,26940,3950,3478,17020,15426,9286,5360,4020,3305,10630,4470,3780,9146,2246,5876,5812,12800,11360,7580,4626,4600,12040,4682,5262,7780,3026,6992,11372,5817,6616,6390,24216,4512,1040,5036,4830,5422,2510,4750,36151,5475,1486,364,4300,10168,7750,7986,4155,23325,4201,3590,3700,6126,6126,3670,4788,3670,4530,26769,8340,9330,2880,2050,3510,5482,6100,5530,26945,5700,6900,3908,39509,10845,15961,5452,6146,34985,10752,15276,7900,3150,3662],[1125,1280,1350,1290,490,1870,903,1280,710,1830,760,1530,1140,720,1330,1655,1450,1855,170,766,565,650,635,1690,300,404,135,645,1900,1660,920,990,314,485,1120,1527,545,1950,2120,1410,930,1155,1920,825,1550,1367,650,1460,392,530,1640,1180,1150,255,1880,600,465,1225,880,1020,685,1180,1275,650,925,430,880,400,225,2125,310,790,1090,3040,445,750,1150,970,720,900,300,1020,578,1035,1700,1135,1470,3300,1700,1500,1550,610,2300,960,550,910,890,545,560,800,800,435,880,910,1605,2180,1042,725,220,415,2090,1400,2579,465,810,1200,1490,578,2480,1550,1300,2670,710,1130,850,1010,846,1550,615,350,1050,278,485,310,1670,1355,1650,1500,1700,1436,1645,880,548,730,915,815,130,1360,770,2040,1380,935,2274,787,1740,365,1405,670,400,70,535,1047,1523,870,865,325,1616,1150,1375,1250,2400,2300,3520,1100,2240,1680,1290,740,1090,880,480,985,1075,285,2360,1080,1150,880,1625,740,825,1200,876,1060,555,2080,1080,2325,505,240],[2637,5247,2610,2300,1410,1360,2480,6980,1240,4185,3947,2028,4680,800,625,5050,5415,7510,4145,2920,1178,1450,1344,3070,5980,2027,1495,2505,4032,1600,1231,6215,899,1195,4520,1106,3000,2030,2740,2155,2671,2807,1215,2415,5470,1780,1510,1560,3402,6120,4210,5556,1457,600,2065,6357,1300,1790,1400,1275,1122,2510,2318,1164,6523,911,2648,600,1518,3110,1075,2050,1430,4155,2468,5998,3224,4206,2950,2265,1723,2760,982,4799,1457,2927,1840,1827,4410,1816,3500,597,4362,3220,5240,825,4542,600,2900,4661,1210,7729,5040,1261,1080,5160,1425,708,420,2450,2398,3895,5728,1269,1035,1647,1931,4880,2500,5720,4694,1335,5250,3020,1722,9137,680,9255,1198,1880,2790,504,922,1906,4765,590,5360,3225,820,3908,7075,1693,3382,2150,2836,3184,1085,6345,2078,4000,6119,2747,4280,2838,2080,943,5118,2615,1207,680,1655,1410,3275,8064,5205,1519,3802,3077,746,1317,7185,4917,1154,3477,4856,796,6116,3835,1935,1740,2985,560,2343,3443,8320,635,3018,1225,1110,860,3423,9190,3322,2120,2475,5490,5664,3610,1832,708],[760,620,900,300,1040,20,2816,3212,105,520,560,0,5230,880,4575,1505,300,331,0,2500,2560,288,1200,2900,390,530,369,3660,0,650,4685,3810,2220,3864,4000,120,1100,5280,1560,410,6980,2568,5350,45,2800,1980,1000,9980,0,1780,1960,50,540,14610,960,3432,1312,11380,75,850,300,360,0,0,2480,900,100,1775,3640,5265,3280,0,3620,12450,1410,4920,20,30,2875,120,200,1500,1800,50,2800,250,400,700,500,1075,0,600,50,1230,4200,1990,1200,100,1200,100,1020,4000,50,340,1200,1815,4800,78,2600,400,20,200,2640,980,1220,200,2300,0,1100,2000,100,240,1000,1470,300,4440,1074,2100,2910,4715,1200,0,300,2580,3000,1200,370,3220,600,4350,3160,1500,7060,700,2420,6495,500,752,50,3570,2802,1796,2600,2855,1294,25,5080,4590,10565,1000,892,1300,1900,1765,6310,1860,5680,1235,0,200,300,1800,800,150,6200,0,2020,1820,640,684,200,200,400,2380,0,50,520,600,710,600,200,2476,1600,444,200,900,12925,0,1950,150],[851,740,255,240,480,888,1307,680,90,784,2096,55,200,492,307,1104,748,1499,77,236,182,312,100,260,1200,350,35,363,1402,743,72,1085,835,271,455,1370,845,500,676,930,1797,395,310,340,990,680,45,1575,120,185,144,437,505,1378,1150,168,132,723,443,250,687,844,1370,200,940,1143,315,240,213,405,735,871,741,823,560,405,314,1083,366,1002,216,480,311,450,965,546,540,1713,800,464,322,200,419,50,476,100,240,68,200,855,1653,760,792,144,305,410,497,52,200,885,266,1080,1109,524,1044,144,140,664,150,858,120,240,256,462,2057,780,437,560,360,240,735,411,259,2256,370,160,100,696,580,350,1150,230,156,613,180,805,775,2405,192,1180,287,210,986,1003,570,355,1416,510,2569,490,72,448,117,683,800,168,300,203,797,1350,325,561,917,415,260,280,744,682,633,1122,541,20,310,596,546,700,950,880,219,140,360,577,142,780,140,894,1085,1118,394,448],[57695,46271,28466,33029,49198,76120,37661,58537,11970,58871,37931,19970,63855,36752,23702,34688,64441,73373,24589,32152,30660,47712,42323,64010,47847,28819,19928,39992,55650,34505,35315,60379,33679,27460,53383,34371,41153,40677,57737,62771,35809,30446,50961,32836,67675,32915,28379,66713,33223,40703,68042,40682,45657,33961,41466,49995,20374,59966,50344,47639,25883,67355,56536,36166,60185,34402,37317,23407,50420,58008,24142,63184,28001,60291,38310,60501,45521,64189,51837,42280,52204,75037,34379,66570,45255,25243,34359,60070,61345,52315,48337,28693,51118,45730,85927,73830,52103,24953,34318,47304,29121,37383,51393,28969,44175,70780,55882,14471,37805,41753,63855,55543,43633,33698,30955,57065,44351,49780,76960,36538,30198,48930,53292,37466,41469,40678,18234,46195,22810,26069,38825,15590,26089,34702,61165,34655,44959,44127,30065,46247,48838,44714,54787,28475,35320,42611,27499,53078,30268,65781,41407,39707,42605,38045,32963,15094,56068,65856,52091,14640,19297,23817,54396,39672,45925,35630,64289,31649,31535,36892,52928,46721,30678,31501,46832,33826,62926,43417,43020,37485,42314,20225,27598,26779,41138,43912,39201,34146,29709,59936,44588,65103,32037,30117,57926,56902,74574,59409,32678,20167],[75801,61511,43010,38586,71187,96812,46051,85446,13320,77883,65928,26926,84792,46330,27712,48319,85928,99228,38718,40161,48232,59347,65330,97759,80193,40914,25856,66920,96494,55567,43298,68449,51487,34738,73467,63307,60052,51939,76388,89450,51857,35796,69348,51214,89403,49632,69577,90667,42835,58232,76163,48438,56630,60738,56720,61766,21237,81803,68135,65553,58102,93124,89804,57472,86945,49590,44010,31410,55945,75934,37686,89716,44650,65630,39147,84312,66029,77258,85225,58296,55172,83553,46715,87734,57763,27640,50278,86172,96517,65834,57815,44230,74223,73006,98615,95258,90642,28458,51244,72395,37052,54676,65919,32240,69091,93133,70171,17471,55334,66631,79883,82429,74919,37404,36755,58745,46387,67479,98082,54331,45971,66691,81921,50223,90037,67748,20394,51807,30350,26601,48600,20429,32041,56864,82908,55522,55059,56965,54851,58823,53538,56802,61196,47476,48106,60342,32784,85075,36252,84860,46792,39477,54273,60501,48223,21762,81755,69521,71816,19365,18307,37142,66470,61598,53265,47131,82028,32954,56118,57844,85857,64916,46996,39676,61294,44720,90639,69146,50603,60342,55382,32306,37828,39018,59750,58624,58221,51455,51655,63806,67618,78367,44627,57850,78425,85001,90925,86168,39334,28158],[52,52,52,26,52,52,39,52,52,52,52,52,52,52,52,52,52,48,52,52,52,42,52,42,52,22,52,43,44,40,38,48,52,52,52,52,52,16,52,52,52,36,35,52,30,52,52,52,52,52,52,52,52,26,26,28,28,52,52,52,52,52,52,52,52,22,32,52,52,52,52,20,52,50,44,52,52,52,52,25,30,35,39,52,52,40,28,52,52,52,52,52,52,52,30,52,52,20,52,52,52,52,40,52,26,52,52,52,52,40,52,52,52,52,52,46,16,36,52,52,52,24,48,52,52,52,30,52,20,44,52,52,52,52,16,40,52,52,52,52,40,52,52,30,52,52,52,52,18,52,20,24,52,52,17,52,36,32,52,18,20,20,52,44,45,18,52,16,24,52,20,52,52,52,51,52,52,52,46,16,48,20,52,22,48,26,26,23,25,52,22,52,52,52,26,52,52,52,52,44],["(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province<\/th>\n      <th>type_of_dwelling<\/th>\n      <th>income<\/th>\n      <th>marital_status<\/th>\n      <th>age_group<\/th>\n      <th>sex<\/th>\n      <th>food_expenditure<\/th>\n      <th>clothing_expenditure<\/th>\n      <th>transportation_expenditure<\/th>\n      <th>personal_care_expenditure<\/th>\n      <th>recreation_expenditure<\/th>\n      <th>tobacco_alcohol_expenditure<\/th>\n      <th>miscellaneous_expenditure<\/th>\n      <th>total_consumption_expenditure<\/th>\n      <th>total_expenditure<\/th>\n      <th>weeks_worked<\/th>\n      <th>income_range<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":300,"columnDefs":[{"className":"dt-right","targets":[3,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
residuals_lowest_earners = residuals(clothing_model)[spending_subset$income_range == levels(spending_subset$income_range)[1]]

residuals_highest_earners = residuals(clothing_model)[spending_subset$income_range == levels(spending_subset$income_range)[2]]

deviations_lowest_earners = abs(residuals_lowest_earners - median(residuals_lowest_earners))

deviations_highest_earners = abs(residuals_highest_earners - median(residuals_highest_earners))

t.test(deviations_lowest_earners , deviations_highest_earners)
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  deviations_lowest_earners and deviations_highest_earners
## t = -0.2898, df = 195.17, p-value = 0.7723
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -368.5517  274.1160
## sample estimates:
## mean of x mean of y 
##  1207.436  1254.654
```

---
layout: false

### Breusch-Pagan test

Determine whether there is a relationship between the squared residuals and `\(X\)`:

* Test `\(H_0: \gamma_1 = 0 \quad\)` in `\(\qquad \ln \sigma_i^2 = \gamma_0 + \gamma_1 X_i\)`



```r
lmtest::bptest(clothing_model)
```

```
## 
## 	studentized Breusch-Pagan test
## 
## data:  clothing_model
## BP = 1.9527, df = 1, p-value = 0.1623
```

--

The Breusch-Pagan test can be modified to allow for different relationships between the error variance and the level of `\(X\)`. 

---

### 3.7: `\(F\)` Test for Lack of Fit

We can apply the *General Linear Test Approach* to determine whether a specific type of regression function adequately fits the data.

The lack of fit test requires at least some **replication**: repeat observations at one or more `\(X\)` levels.

---

layout: false

Notation: 

* `\(X_1, \ldots, X_c\)` now represent the `\(c\)` different levels of the study
* `\(n_1, \ldots, n_c\)` represent the number of *replicates* at each level of `\(X\)`. 
* `\(Y_{ij}\)` represents the `\(i\)`th replicate at level `\(X_j\)`. 

Full Model:

`$$Y_{ij} = \mu_j + \epsilon_{ij}$$`

Reduced Model:

`$$Y_{ij} = \beta_0 + \beta_1 X_j + \epsilon_{ij}$$`

--

Notice that in the Full model `\(\hat Y_{ij} = \hat \mu_j = \bar Y_j\)`.

In the Reduced model `\(\hat Y_{ij} = b_0 + b_1 X_j = \hat Y_j\)`	

---

`$$\begin{align*}
SSE(F) &amp;= \sum_j \sum_i (Y_{ij} - \bar Y_j)^2 = SSPE \text{ (Pure Error)}\\
SSE(R) &amp;= \sum_j \sum_i (Y_{ij} - \hat Y_j)^2 = SSE
\end{align*}$$`

* `\(SSE\)` captures the "error" in `\(Y\)` that cannot be explained by a linear relationship with `\(X\)`. 
* `\(SSPE\)` captures the "pure error" in `\(Y\)` that cannot be explained any relationship with `\(X\)`.


--

The **Lack of Fit sum of squares** captures the difference:
$$ SSLF = SSE - SSPE$$

`$$\begin{align*}
F^\ast &amp;= \frac{SSE(R)−SSE(F)}{df_R−df_F} \div \frac{SSE(F)}{df_F}\\
&amp;= \frac{SSLF}{c−2} \div \frac{SSPE}{n-c}\\
&amp;= \boxed{\frac{MSLF}{MSPE}}
\end{align*}$$`

---

&lt;img src="img/Figure3p6b.png" width="100%" style="display: block; margin: auto;" /&gt;

---




```r
bank_data %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-abac5d80d29f1c558849" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-abac5d80d29f1c558849">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11"],[125,100,200,75,150,175,75,175,125,200,100],[160,112,124,28,152,156,42,124,150,104,136]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>size_of_minimum_deposits<\/th>\n      <th>number_of_new_accounts<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":300,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
bank_model = lm(number_of_new_accounts~size_of_minimum_deposits, data=bank_data)
anova(bank_model)
```

```
## Analysis of Variance Table
## 
## Response: number_of_new_accounts
##                          Df  Sum Sq Mean Sq F value Pr(&gt;F)
## size_of_minimum_deposits  1  5141.3  5141.3  3.1389 0.1102
## Residuals                 9 14741.6  1638.0
```

```r
alr3::pureErrorAnova(lm(number_of_new_accounts~size_of_minimum_deposits, data=bank_data))
```

```
## Analysis of Variance Table
## 
## Response: number_of_new_accounts
##                          Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
## size_of_minimum_deposits  1  5141.3  5141.3  22.393 0.005186 **
## Residuals                 9 14741.6  1638.0                    
##  Lack of fit              4 13593.6  3398.4  14.801 0.005594 **
##  Pure Error               5  1148.0   229.6                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

```r
bank_model = lm(number_of_new_accounts~size_of_minimum_deposits, data=bank_data)
anova(bank_model)
```

```
## Analysis of Variance Table
## 
## Response: number_of_new_accounts
##                          Df  Sum Sq Mean Sq F value Pr(&gt;F)
## size_of_minimum_deposits  1  5141.3  5141.3  3.1389 0.1102
## Residuals                 9 14741.6  1638.0
```

```r
bank_model_full = lm(number_of_new_accounts~factor(size_of_minimum_deposits), data=bank_data)
anova(bank_model, bank_model_full)
```

```
## Analysis of Variance Table
## 
## Model 1: number_of_new_accounts ~ size_of_minimum_deposits
## Model 2: number_of_new_accounts ~ factor(size_of_minimum_deposits)
##   Res.Df   RSS Df Sum of Sq      F   Pr(&gt;F)   
## 1      9 14742                                
## 2      5  1148  4     13594 14.801 0.005594 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

```r
plot(bank_data$size_of_minimum_deposits, bank_data$number_of_new_accounts);  abline(bank_model,col="red"); newx = 50:200; preds = predict(bank_model, newdata=data.frame(size_of_minimum_deposits=newx), interval="confidence"); lines(newx, preds[,3], lty="dashed", col="red"); lines(newx, preds[,2], lty="dashed", col="red")
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-49-1.png" width="504" style="display: block; margin: auto;" /&gt;

--

* There is no *linear association* between minimum deposit size and number of new accounts. 
* However, there is a definite relationship, but the regression function is not linear. 
* A study of residuals can be helpful in identifying an appropriate function.

This illustrates the importance of always examining the appropriateness of a model before any inferences are drawn.

---

layout: true
class: inverse

---
### SHS: Lack of Fit


```r
clothing_model = lm(clothing_expenditure~income, data=spending_subset)

clothing_model_full = lm(clothing_expenditure~factor(income), data=spending_subset)
```


```r
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-51-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
anova(clothing_model)
```

```
## Analysis of Variance Table
## 
## Response: clothing_expenditure
##            Df    Sum Sq  Mean Sq F value   Pr(&gt;F)   
## income      1  27477746 27477746  10.251 0.001592 **
## Residuals 198 530729724  2680453                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
anova(clothing_model, clothing_model_full)
```

```
## Analysis of Variance Table
## 
## Model 1: clothing_expenditure ~ income
## Model 2: clothing_expenditure ~ factor(income)
##   Res.Df       RSS Df Sum of Sq      F Pr(&gt;F)
## 1    198 530729724                           
## 2    136 351920325 62 178809400 1.1145 0.2983
```

Notice that the “Pure Error SS” is 351920325 and the “Lack of Fit SS” is 178809400.

* **Report the "Pure Error Mean Square" (351920325/136), and the "Lack of Fit Mean Square" (178809400/62), and the p-value testing lack of fit (0.2983)**

---



### CDI: Lack of Fit - physicians vs hospital beds


```r
xyplot(number_physicians ~ number_hospital_beds, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-53-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
mod_physician_beds = lm(number_physicians ~ number_hospital_beds, data=cdi)
anova(mod_physician_beds)
```

```
## Analysis of Variance Table
## 
## Response: number_physicians
##                       Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
## number_hospital_beds   1 1270342254 1270342254  4095.3 &lt; 2.2e-16 ***
## Residuals            438  135864045     310192                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
mod_physician_beds_full = lm(number_physicians ~ factor(number_hospital_beds), data=cdi)
anova(mod_physician_beds, mod_physician_beds_full)
```

```
## Analysis of Variance Table
## 
## Model 1: number_physicians ~ number_hospital_beds
## Model 2: number_physicians ~ factor(number_hospital_beds)
##   Res.Df       RSS  Df Sum of Sq      F    Pr(&gt;F)    
## 1    438 135864045                                   
## 2     49   1357864 389 134506181 12.478 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

* **In your own words, interpret this output.**




---
### CDI: Lack of Fit - physicians vs population 



```r
xyplot(number_physicians ~ population, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-55-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
mod_physician_pop = lm(number_physicians ~ population, data=cdi)
anova(mod_physician_pop)
```

```
## Analysis of Variance Table
## 
## Response: number_physicians
##             Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
## population   1 1243181164 1243181164  3340.1 &lt; 2.2e-16 ***
## Residuals  438  163025135     372204                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
mod_physician_pop_full = lm(number_physicians ~ factor(population), data=cdi)
anova(mod_physician_pop, mod_physician_pop_full)
```

```
## Analysis of Variance Table
## 
## Model 1: number_physicians ~ population
## Model 2: number_physicians ~ factor(population)
##   Res.Df       RSS  Df Sum of Sq   F Pr(&gt;F)
## 1    438 163025135                         
## 2      0         0 438 163025135 NaN    NaN
```


* **In your own words, interpret this output.**



---

### CDI: Lack of Fit - physicians vs total income


```r
xyplot(number_physicians ~ total_personal_income, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-57-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
mod_physician_income = lm(number_physicians ~ total_personal_income, data=cdi)
anova(mod_physician_income)
```

```
## Analysis of Variance Table
## 
## Response: number_physicians
##                        Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
## total_personal_income   1 1264058045 1264058045  3894.9 &lt; 2.2e-16 ***
## Residuals             438  142148254     324539                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
mod_physician_income_full = lm(number_physicians ~ factor(total_personal_income), data=cdi)
anova(mod_physician_income, mod_physician_income_full)
```

```
## Analysis of Variance Table
## 
## Model 1: number_physicians ~ total_personal_income
## Model 2: number_physicians ~ factor(total_personal_income)
##   Res.Df       RSS  Df Sum of Sq      F    Pr(&gt;F)    
## 1    438 142148254                                   
## 2     12     64864 426 142083391 61.704 1.156e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

* **In your own words, interpret this output.**



---

layout: false

### Recap: Sections 3.4-3.7

After Sections 3.4-3.7, you should be able to 

-	Understand that their are formal tests for residual diagnostics	
- Apply formal tests for normality and constant variance
- Carry out and interpret the F test for lack of fit. 









---

### Learning Objectives for Sections 3.8-3.10

After Sections 3.8-3.10, you should be able to 

-	Understand the utility of transformations and when they could be applied.
- Assess the shape of the regression function using smoothed curves. 


---

### 3.8: Overview of Remedial Measures

If the simple linear regression model is not appropriate for a data set, there are two basic choices:

1. Develop a more complex model on the original data
2. Employ some transformation on the data so that regression model (2.1) is appropriate for the transformed data.

--

Successful use of transformations leads to relatively simple methods of estimation and may involve fewer parameters than a complex model, an advantage when the sample size is small. 

Transformations may obscure the fundamental interconnections between the variables, though at other times they may illuminate them.



---

### 3.9: Transformations

Simple transformations of either the response variable `\(Y\)` or the predictor variable `\(X\)`, or of both, are often sufficient to make the simple linear regression model appropriate for the transformed data.


---

### Transformations for Nonlinear Relation Only

Consider transformations for linearizing a nonlinear regression relation when 

* the distribution of the error terms is reasonably close to a normal distribution and 
* the error terms have approximately constant variance. 

--

In this situation, transformations on `\(X\)` should be attempted. 

Transformations on `\(Y\)` may not be desirable here because something like `\(Y' = \sqrt{y}\)`, may materially change the shape of the distribution of the error terms from the normal distribution and may also lead to substantially differing error term variances.


---
.pull-left[

```r
n=500
X = runif(n, min=1, max=20)
Y = rnorm(n, mean=X^2, sd=10)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-60-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(Y~X^2, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-60-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
n=500
X = runif(n, min=1, max=5)
Y = rnorm(n, mean=exp(X), sd=5)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-61-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(Y~exp(X), type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-61-2.png" width="504" style="display: block; margin: auto;" /&gt;
]


---

.pull-left[

```r
n=500
X = runif(n, min=1, max=20)
Y = rnorm(n, mean=sqrt(X), sd=.1)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-62-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(Y~sqrt(X), type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-62-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
n=500
X = runif(n, min=1, max=20)
Y = rnorm(n, mean=log(X), sd=.1)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-63-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(Y~log(X), type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-63-2.png" width="504" style="display: block; margin: auto;" /&gt;
]



---

.pull-left[

```r
n=500
X = runif(n, min=.1, max=2)
Y = rnorm(n, mean=1/X, sd=.2)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-64-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(Y~1/X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-64-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
n=500
X = runif(n, min=.1, max=2)
Y = rnorm(n, mean=exp(-X), sd=.02)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-65-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(Y~exp(-X), type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-65-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

---

Several alternative transformations may be tried. 

Scatter plots and residual plots based on each transformation should then be prepared and analyzed, to decide which transformation is most effective.

---

### Transformations for Nonnormality and Unequal Error Variances


To remedy unequal error variances and nonnormality of the error terms, we can try a transformation on `\(Y\)`.

A transformation on `\(Y\)` may also at the same time help to linearize a curvilinear regression relation. 

At other times, a simultaneous transformation on `\(X\)` may be needed to obtain or maintain a linear regression relation.

--

Frequently, the skewness and variability of the distributions of the error terms increasing as `\(E[Y]\)` increases. 



For example, in a regression of yearly household expenditures for vacations (Y) on household income (X), there will tend to be more variation and greater positive skewness (i.e., some very high yearly vacation expenditures) for high-income households than for low-income households, who tend to consistently spend much less for vacations. 


---

.pull-left[

```r
n=500
X = runif(n, min=2, max=20)
sqrtY = rnorm(n, mean=X, sd=1)
Y = sqrtY^2
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-66-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(sqrt(Y)~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-66-2.png" width="504" style="display: block; margin: auto;" /&gt;
]



.pull-right[

```r
n=500
X = runif(n, min=5, max=10)
logY = rnorm(n, mean=X, sd=.1)
Y = exp(logY)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-67-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(log(Y)~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-67-2.png" width="504" style="display: block; margin: auto;" /&gt;
]



---

.pull-left[

```r
n=500
X = runif(n, min=5, max=20)
invY = rnorm(n, mean=X, sd=1)
Y = 1/invY
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-68-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot((1/Y)~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-68-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
n=500
X = runif(n, min=5, max=30)
expY = rnorm(n, mean=X, sd=1)
Y = log(expY)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-69-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(exp(Y)~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-69-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

---

1. At times it may be desirable to introduce a constant into a transformation of `\(Y\)`, such as when `\(Y\)` may be negative.
	+ For instance, the logarithmic transformation to shift the origin in `\(Y\)` and make all `\(Y\)` observations positive would be `\(Y' = log(Y+k)\)`, where `\(k\)` is an appropriately chosen constant.

2. When unequal error variances are present but the regression relation is linear, a transformation on `\(Y\)` may not be sufficient. While such a transformation may stabilize the error variance, it will also change the linear relationship to a curvilinear one. A transformation on `\(X\)` may therefore also be required. 
	+ This case can also be handled by using weighted least squares (Chapter 11).

---


```r
n=500
logX = runif(n, min=1, max=4)
X = exp(logX)
logY = rnorm(n, mean=logX, sd=.1)
Y = exp(logY)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-70-1.png" width="504" style="display: block; margin: auto;" /&gt;

.pull-left[

```r
xyplot(log(Y)~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-71-1.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
xyplot(log(Y)~log(X), type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-72-1.png" width="504" style="display: block; margin: auto;" /&gt;
]


---
### Box-Cox Transformations


It is often difficult to determine from diagnostic plots which transformation of `\(Y\)` is most appropriate for correcting skewness of the distributions of error terms, unequal error variances, and nonlinearity of the regression function.

The Box-Cox procedure automatically identifies a transformation from the family of power transformations on `\(Y\)`:
`$$Y(\lambda) = \beta_0 + \beta_1 X + \varepsilon,$$`
where

`$${Y(\lambda) = \left \{ \begin{array}{ll} (Y^\lambda-1)/\lambda, &amp; \text{ if } \lambda \neq 0 \\ \log Y, &amp; \text{ if } \lambda = 0 \\ \end{array} \right. }$$`

--

Note that the transformation `\((Y^\lambda-1)/\lambda\)` essentially amounts to using the transformation `\(Y^\lambda\)`.


---

.pull-left[

```r
n=500
X = runif(n, min=2, max=20)
sqrtY = rnorm(n, mean=X, sd=1)
Y = sqrtY^2
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-73-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
MASS::boxcox(lm(Y~X))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-73-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
n=500
X = runif(n, min=5, max=10)
invY = rnorm(n, mean=X, sd=1)
Y = 1/invY
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-74-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
MASS::boxcox(lm(Y~X))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-74-2.png" width="504" style="display: block; margin: auto;" /&gt;
]



---

.pull-left[

```r
n=500
X = runif(n, min=5, max=10)
logY = rnorm(n, mean=X, sd=.1)
Y = exp(logY)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-75-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
MASS::boxcox(lm(Y~X))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-75-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
n=500
X = runif(n, min=5, max=30)
expY = rnorm(n, mean=X, sd=1)
Y = log(expY)
xyplot(Y~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-76-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
MASS::boxcox(lm(Y~X), seq(-5, 5, 1/10))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-76-2.png" width="504" style="display: block; margin: auto;" /&gt;
]

---

.pull-left[

```r
n=500
X = runif(n, min=5, max=30)
expY = rnorm(n, mean=X, sd=1)
Y = log(expY)
xyplot(Y^4~X, type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-77-1.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
MASS::boxcox(lm(Y^4~X), seq(-5, 5, 1/10))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-78-1.png" width="504" style="display: block; margin: auto;" /&gt;
]


---
layout: true
class: inverse

---

### SHS: Transformations


The Canadian Survey of Household Spending is carried out annually across Canada. 

(http://dli-idd-nesstar.statcan.gc.ca.proxy.library.upei.ca/webview/) 

The main purpose of the survey is to obtain detailed information about household spending. Information is also collected about dwelling characteristics as well as household equipment. 

The survey data are used by the following groups:

* Government departments use the data to help formulate policy; 
* Community groups, social agencies and consumer groups use the data to support their positions and to lobby governments for social changes; 
* Lawyers and their clients use the data to determine what is fair for child support and other compensation; 
* Labour and contract negotiators rely on the data when discussing wage and cost-of-living clauses; 
* Individuals and families can use the data to compare their spending habits with those of similar types of households. 

---


```r
###A subset of the latest Survey of Household Spending data are displayed below:
spending_subset %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4cf244dab681b10cb8d5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4cf244dab681b10cb8d5">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],["NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL"],["single_detached","single_detached","single_detached","row_house","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","single_detached","single_detached","apartment","apartment","apartment","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","semi_detached","duplex","single_detached","semi_detached","semi_detached","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","semi_detached","single_detached","single_detached","single_detached","single_detached","semi_detached","semi_detached","semi_detached","row_house","row_house","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","single_detached","duplex","duplex","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","duplex","duplex","single_detached","duplex","duplex","row_house","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","duplex","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","duplex","other","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","semi_detached","semi_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","semi_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","row_house","single_detached","single_detached","semi_detached","single_detached","single_detached","semi_detached"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000,33000,57000,50000,38000,75000,76000,74000,21000,45000,66000,38000,23000,26000,15000,69000,24000,60000,38000,36000,60000,30000,30000,40000,68000,52000,52000,21000,42000,60000,54000,53000,40000,70000,25000,59000,65000,31000,13000,35000,35000,45000,50000,50000,30000,42000,75000,69000,37000,95000,45000,37000,30000,40000,28000,45000,29000,28000,37000,60000,34000,41000,50000,58000,52000,69000,40000,90000,31000,33000,60000,35000,17000,27000,19000,43000,24000,46000,20000,45000,10000,84000,34000,55000,20000,32000,40000,26000,30000,70000,44000,46000,41000,70000,50000,82000,42000,23000,35000,33000,16000,54000,20000,32000,62000,27000,33000,24000,46000,77000,31000,32000,34000,19000,50000,31000,75000,25000,55000,29000,55000,25000,29000,43000,65000,53000,26000,43000,27000,50000,23000,14000,32000,38000,53000,30000,30000,45000,28000,50000,55000,60000,59000,55000,24000,42000,21000,54000,50000,48000,8000,52000,26000,45000,42000,21000,51000,37000,26000,59000,22000,37000,28000,30000,66000,25000,62000,49000,74000,34000,42000],["never_married","never_married","married","never_married","married","married","other","married","never_married","other","married","never_married","other","other","never_married","never_married","other","married","never_married","other","other","never_married","married","married","married","married","other","other","married","married","other","never_married","other","never_married","other","never_married","never_married","married","married","never_married","never_married","married","married","married","married","never_married","married","married","married","never_married","married","married","never_married","married","never_married","married","never_married","married","married","married","married","married","married","married","married","other","married","married","married","married","other","married","never_married","never_married","never_married","married","married","married","married","married","other","married","married","married","other","other","married","never_married","married","married","other","other","married","married","never_married","married","married","never_married","married","married","married","married","married","other","married","married","married","other","other","married","married","married","married","married","never_married","other","other","married","married","married","never_married","married","married","married","married","married","never_married","married","married","married","other","other","married","married","married","married","married","married","other","married","married","married","married","married","married","married","never_married","married","married","married","married","never_married","married","married","married","never_married","married","married","married","other","never_married","married","married","married","married","married","married","never_married","married","married","married","married","married","married","married","married","married","married","never_married","married","other","married","married","never_married","married","married","married","married","married","married","married","married","married","never_married","married","married","married","married","never_married","married"],["30-34","25-29","35-39","30-34","25-29","25-29","55-59","55-59","25-29","40-44","50-54","25-29","50-54","50-54","&lt;25","&lt;25","50-54","40-44","35-39","40-44","50-54","50-54","55-59","45-49","30-34","25-29","35-39","60-64","25-29","30-34","30-34","&lt;25","55-59","25-29","55-59","40-44","30-34","35-39","55-59","30-34","25-29","60-64","45-49","55-59","25-29","&lt;25","45-49","40-44","40-44","40-44","40-44","25-29","25-29","50-54","30-34","45-49","30-34","50-54","40-44","60-64","55-59","40-44","25-29","45-49","40-44","65-69","30-34","&lt;25","45-49","45-49","40-44","40-44","45-49","40-44","35-39","45-49","35-39","35-39","35-39","25-29","60-64","25-29","50-54","40-44","45-49","40-44","45-49","55-59","40-44","45-49","40-44","55-59","30-34","45-49","35-39","25-29","45-49","25-29","&lt;25","55-59","55-59","65-69","25-29","50-54","45-49","40-44","55-59","50-54","30-34","50-54","35-39","40-44","50-54","30-34","35-39","40-44","50-54","25-29","30-34","50-54","25-29","35-39","30-34","40-44","50-54","50-54","40-44","55-59","50-54","35-39","50-54","60-64","60-64","55-59","35-39","50-54","35-39","40-44","65-69","50-54","60-64","55-59","35-39","35-39","40-44","50-54","40-44","35-39","50-54","35-39","45-49","30-34","45-49","45-49","30-34","60-64","40-44","45-49","45-49","55-59","35-39","55-59","35-39","50-54","40-44","55-59","40-44","25-29","60-64","45-49","35-39","50-54","40-44","45-49","40-44","45-49","55-59","50-54","30-34","30-34","40-44","&lt;25","45-49","40-44","40-44","50-54","50-54","50-54","55-59","45-49","45-49","40-44","50-54","45-49","45-49","30-34","45-49","40-44","25-29","65-69"],["female","male","male","female","female","male","female","male","female","female","female","male","male","female","female","female","female","female","male","male","female","female","female","male","male","male","male","female","female","female","female","male","female","female","male","female","male","male","male","female","male","male","female","female","male","female","female","male","male","male","female","male","female","male","female","male","female","male","male","male","male","male","male","female","male","male","male","female","male","female","male","male","female","female","male","male","male","male","male","male","female","female","male","male","female","female","female","female","female","male","female","female","male","male","male","male","male","female","female","male","male","female","female","female","male","female","male","female","male","male","male","female","male","male","female","female","female","female","male","female","female","male","male","male","male","male","female","female","male","female","female","female","male","male","female","male","male","female","female","female","male","female","female","male","male","male","male","female","male","male","male","female","male","female","male","female","male","male","male","male","female","male","female","male","male","male","male","female","male","male","male","male","male","male","male","male","male","female","female","male","female","female","male","male","female","male","female","female","male","male","female","female","male","female","female","male","female","female","female","male"],[3940,7350,5150,6240,4480,10120,3200,10200,2850,6500,5400,5180,8100,6040,3800,2800,8880,10825,4450,9120,4300,4440,8400,9000,4800,3010,6000,3950,8740,4500,5340,3300,3000,2350,7140,2650,8150,6700,12900,2200,4840,7570,14080,5800,8850,4420,10400,8800,5050,5410,8000,7060,3800,3490,5440,9200,6000,9890,7800,6280,5430,9710,5600,4500,10800,11100,6000,5700,5160,7050,4940,7460,3450,9500,6400,7800,6860,7350,7300,4780,2600,6815,5500,6800,6100,6750,3300,7900,15800,7830,11440,4200,9580,6650,6400,3350,9620,3240,4000,8500,7100,7780,11000,3900,6700,9260,14404,2700,5200,6480,9500,7200,5680,4940,6200,16900,7740,760,8500,3460,4318,6860,6600,7700,9000,6250,3950,6400,4900,3380,7800,1810,6440,6000,14600,5000,6420,7700,4500,5750,9120,10800,6300,6540,8900,6400,7800,1290,7850,5900,5400,9800,7200,6960,5400,3800,11300,8100,8100,3640,5440,7100,8800,5895,8550,6200,13000,4400,11440,8050,5550,3290,7800,6300,4950,5090,6760,7800,1850,4775,2810,5400,5400,4750,12600,4940,13396,6470,10520,5800,8050,8650,5044,5800,6600,5150,11880,6440,2260,3900],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800,313,3000,3440,1570,2475,630,1570,3001,955,3790,1910,1860,2205,4180,7790,1900,1000,3280,2355,1740,5520,1240,3450,1130,3140,3040,1500,1408,455,1000,1120,3410,2655,1800,3830,2250,1100,500,1200,3545,200,3620,2172,3940,1644,2090,909,935,1730,1870,1250,1095,982,1555,5140,1660,1670,4810,2300,1050,4670,3500,2700,2370,3650,910,3100,550,2500,3885,970,1380,2395,1300,1550,7075,4030,1270,1100,820,5505,2400,2390,1130,3250,3470,1790,1850,3400,980,3198,3225,5060,5380,4000,2780,360,4050,1510,3052,3800,525,1609,1510,6840,4140,3415,3350,8600,3560,7890,4660,1540,2215,2710,1550,715,3745,2415,3880,3650,2760,4895,4075,2825,575,4095,1895,2509,232,1135,1419,6120,1930,3995,1580,6105,3025,3340,1360,4190,2440,1655,1460,5210,5300,1410,3050,2550,1260,1550,400,2675,1680,3600,2760,1700,1310,3675,1270,3100,7350,1270,1363,1676,5380,2610,5800,2300,485],[32670,8396,3456,5308,11576,4501,7846,7982,560,6649,12601,6481,24900,2640,2550,5029,8343,8450,4405,9910,8206,22450,6440,10340,7282,4090,150,4622,4751,6062,60,9478,10666,7371,4670,4454,4578,4826,8326,22616,2266,6420,3821,3296,12695,6590,4940,21049,555,5370,7640,3748,15394,3274,4300,3664,40,4815,15166,8054,4850,9880,10147,5440,16718,4188,3841,4280,23202,4840,2040,26080,4145,6444,8960,10412,5567,23193,3776,9376,18930,38620,8428,29320,9285,550,5952,5690,4406,16553,4830,4370,11102,8700,20130,32700,11860,1160,1200,9080,2326,3664,5966,6596,10970,26333,9526,70,2580,5676,8906,12288,9442,4940,4380,5860,13298,3514,26940,3950,3478,17020,15426,9286,5360,4020,3305,10630,4470,3780,9146,2246,5876,5812,12800,11360,7580,4626,4600,12040,4682,5262,7780,3026,6992,11372,5817,6616,6390,24216,4512,1040,5036,4830,5422,2510,4750,36151,5475,1486,364,4300,10168,7750,7986,4155,23325,4201,3590,3700,6126,6126,3670,4788,3670,4530,26769,8340,9330,2880,2050,3510,5482,6100,5530,26945,5700,6900,3908,39509,10845,15961,5452,6146,34985,10752,15276,7900,3150,3662],[1125,1280,1350,1290,490,1870,903,1280,710,1830,760,1530,1140,720,1330,1655,1450,1855,170,766,565,650,635,1690,300,404,135,645,1900,1660,920,990,314,485,1120,1527,545,1950,2120,1410,930,1155,1920,825,1550,1367,650,1460,392,530,1640,1180,1150,255,1880,600,465,1225,880,1020,685,1180,1275,650,925,430,880,400,225,2125,310,790,1090,3040,445,750,1150,970,720,900,300,1020,578,1035,1700,1135,1470,3300,1700,1500,1550,610,2300,960,550,910,890,545,560,800,800,435,880,910,1605,2180,1042,725,220,415,2090,1400,2579,465,810,1200,1490,578,2480,1550,1300,2670,710,1130,850,1010,846,1550,615,350,1050,278,485,310,1670,1355,1650,1500,1700,1436,1645,880,548,730,915,815,130,1360,770,2040,1380,935,2274,787,1740,365,1405,670,400,70,535,1047,1523,870,865,325,1616,1150,1375,1250,2400,2300,3520,1100,2240,1680,1290,740,1090,880,480,985,1075,285,2360,1080,1150,880,1625,740,825,1200,876,1060,555,2080,1080,2325,505,240],[2637,5247,2610,2300,1410,1360,2480,6980,1240,4185,3947,2028,4680,800,625,5050,5415,7510,4145,2920,1178,1450,1344,3070,5980,2027,1495,2505,4032,1600,1231,6215,899,1195,4520,1106,3000,2030,2740,2155,2671,2807,1215,2415,5470,1780,1510,1560,3402,6120,4210,5556,1457,600,2065,6357,1300,1790,1400,1275,1122,2510,2318,1164,6523,911,2648,600,1518,3110,1075,2050,1430,4155,2468,5998,3224,4206,2950,2265,1723,2760,982,4799,1457,2927,1840,1827,4410,1816,3500,597,4362,3220,5240,825,4542,600,2900,4661,1210,7729,5040,1261,1080,5160,1425,708,420,2450,2398,3895,5728,1269,1035,1647,1931,4880,2500,5720,4694,1335,5250,3020,1722,9137,680,9255,1198,1880,2790,504,922,1906,4765,590,5360,3225,820,3908,7075,1693,3382,2150,2836,3184,1085,6345,2078,4000,6119,2747,4280,2838,2080,943,5118,2615,1207,680,1655,1410,3275,8064,5205,1519,3802,3077,746,1317,7185,4917,1154,3477,4856,796,6116,3835,1935,1740,2985,560,2343,3443,8320,635,3018,1225,1110,860,3423,9190,3322,2120,2475,5490,5664,3610,1832,708],[760,620,900,300,1040,20,2816,3212,105,520,560,0,5230,880,4575,1505,300,331,0,2500,2560,288,1200,2900,390,530,369,3660,0,650,4685,3810,2220,3864,4000,120,1100,5280,1560,410,6980,2568,5350,45,2800,1980,1000,9980,0,1780,1960,50,540,14610,960,3432,1312,11380,75,850,300,360,0,0,2480,900,100,1775,3640,5265,3280,0,3620,12450,1410,4920,20,30,2875,120,200,1500,1800,50,2800,250,400,700,500,1075,0,600,50,1230,4200,1990,1200,100,1200,100,1020,4000,50,340,1200,1815,4800,78,2600,400,20,200,2640,980,1220,200,2300,0,1100,2000,100,240,1000,1470,300,4440,1074,2100,2910,4715,1200,0,300,2580,3000,1200,370,3220,600,4350,3160,1500,7060,700,2420,6495,500,752,50,3570,2802,1796,2600,2855,1294,25,5080,4590,10565,1000,892,1300,1900,1765,6310,1860,5680,1235,0,200,300,1800,800,150,6200,0,2020,1820,640,684,200,200,400,2380,0,50,520,600,710,600,200,2476,1600,444,200,900,12925,0,1950,150],[851,740,255,240,480,888,1307,680,90,784,2096,55,200,492,307,1104,748,1499,77,236,182,312,100,260,1200,350,35,363,1402,743,72,1085,835,271,455,1370,845,500,676,930,1797,395,310,340,990,680,45,1575,120,185,144,437,505,1378,1150,168,132,723,443,250,687,844,1370,200,940,1143,315,240,213,405,735,871,741,823,560,405,314,1083,366,1002,216,480,311,450,965,546,540,1713,800,464,322,200,419,50,476,100,240,68,200,855,1653,760,792,144,305,410,497,52,200,885,266,1080,1109,524,1044,144,140,664,150,858,120,240,256,462,2057,780,437,560,360,240,735,411,259,2256,370,160,100,696,580,350,1150,230,156,613,180,805,775,2405,192,1180,287,210,986,1003,570,355,1416,510,2569,490,72,448,117,683,800,168,300,203,797,1350,325,561,917,415,260,280,744,682,633,1122,541,20,310,596,546,700,950,880,219,140,360,577,142,780,140,894,1085,1118,394,448],[57695,46271,28466,33029,49198,76120,37661,58537,11970,58871,37931,19970,63855,36752,23702,34688,64441,73373,24589,32152,30660,47712,42323,64010,47847,28819,19928,39992,55650,34505,35315,60379,33679,27460,53383,34371,41153,40677,57737,62771,35809,30446,50961,32836,67675,32915,28379,66713,33223,40703,68042,40682,45657,33961,41466,49995,20374,59966,50344,47639,25883,67355,56536,36166,60185,34402,37317,23407,50420,58008,24142,63184,28001,60291,38310,60501,45521,64189,51837,42280,52204,75037,34379,66570,45255,25243,34359,60070,61345,52315,48337,28693,51118,45730,85927,73830,52103,24953,34318,47304,29121,37383,51393,28969,44175,70780,55882,14471,37805,41753,63855,55543,43633,33698,30955,57065,44351,49780,76960,36538,30198,48930,53292,37466,41469,40678,18234,46195,22810,26069,38825,15590,26089,34702,61165,34655,44959,44127,30065,46247,48838,44714,54787,28475,35320,42611,27499,53078,30268,65781,41407,39707,42605,38045,32963,15094,56068,65856,52091,14640,19297,23817,54396,39672,45925,35630,64289,31649,31535,36892,52928,46721,30678,31501,46832,33826,62926,43417,43020,37485,42314,20225,27598,26779,41138,43912,39201,34146,29709,59936,44588,65103,32037,30117,57926,56902,74574,59409,32678,20167],[75801,61511,43010,38586,71187,96812,46051,85446,13320,77883,65928,26926,84792,46330,27712,48319,85928,99228,38718,40161,48232,59347,65330,97759,80193,40914,25856,66920,96494,55567,43298,68449,51487,34738,73467,63307,60052,51939,76388,89450,51857,35796,69348,51214,89403,49632,69577,90667,42835,58232,76163,48438,56630,60738,56720,61766,21237,81803,68135,65553,58102,93124,89804,57472,86945,49590,44010,31410,55945,75934,37686,89716,44650,65630,39147,84312,66029,77258,85225,58296,55172,83553,46715,87734,57763,27640,50278,86172,96517,65834,57815,44230,74223,73006,98615,95258,90642,28458,51244,72395,37052,54676,65919,32240,69091,93133,70171,17471,55334,66631,79883,82429,74919,37404,36755,58745,46387,67479,98082,54331,45971,66691,81921,50223,90037,67748,20394,51807,30350,26601,48600,20429,32041,56864,82908,55522,55059,56965,54851,58823,53538,56802,61196,47476,48106,60342,32784,85075,36252,84860,46792,39477,54273,60501,48223,21762,81755,69521,71816,19365,18307,37142,66470,61598,53265,47131,82028,32954,56118,57844,85857,64916,46996,39676,61294,44720,90639,69146,50603,60342,55382,32306,37828,39018,59750,58624,58221,51455,51655,63806,67618,78367,44627,57850,78425,85001,90925,86168,39334,28158],[52,52,52,26,52,52,39,52,52,52,52,52,52,52,52,52,52,48,52,52,52,42,52,42,52,22,52,43,44,40,38,48,52,52,52,52,52,16,52,52,52,36,35,52,30,52,52,52,52,52,52,52,52,26,26,28,28,52,52,52,52,52,52,52,52,22,32,52,52,52,52,20,52,50,44,52,52,52,52,25,30,35,39,52,52,40,28,52,52,52,52,52,52,52,30,52,52,20,52,52,52,52,40,52,26,52,52,52,52,40,52,52,52,52,52,46,16,36,52,52,52,24,48,52,52,52,30,52,20,44,52,52,52,52,16,40,52,52,52,52,40,52,52,30,52,52,52,52,18,52,20,24,52,52,17,52,36,32,52,18,20,20,52,44,45,18,52,16,24,52,20,52,52,52,51,52,52,52,46,16,48,20,52,22,48,26,26,23,25,52,22,52,52,52,26,52,52,52,52,44],["(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","(4e+04,9.5e+04]","[8e+03,4e+04]","(4e+04,9.5e+04]"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province<\/th>\n      <th>type_of_dwelling<\/th>\n      <th>income<\/th>\n      <th>marital_status<\/th>\n      <th>age_group<\/th>\n      <th>sex<\/th>\n      <th>food_expenditure<\/th>\n      <th>clothing_expenditure<\/th>\n      <th>transportation_expenditure<\/th>\n      <th>personal_care_expenditure<\/th>\n      <th>recreation_expenditure<\/th>\n      <th>tobacco_alcohol_expenditure<\/th>\n      <th>miscellaneous_expenditure<\/th>\n      <th>total_consumption_expenditure<\/th>\n      <th>total_expenditure<\/th>\n      <th>weeks_worked<\/th>\n      <th>income_range<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":300,"columnDefs":[{"className":"dt-right","targets":[3,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

We are interested in the potential relationship between the income of working Canadians and the amount that they spend on clothing in a year.


---

Income and Clothing Expenditure for a small subset of the Survey of Household Spending are displayed below:
 

```r
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-80-1.png" width="504" style="display: block; margin: auto;" /&gt;



---



```r
clothing_model = lm(clothing_expenditure~income, data=spending_subset)
out = MASS::boxcox(clothing_model)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-81-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
range(out$x[out$y &gt; max(out$y)-qchisq(0.95,1)/2])
```

```
## [1] 0.2222222 0.4646465
```

---



```r
xyplot(I(clothing_expenditure^(.25))~income, data=spending_subset,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-82-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
clothing_model_25 = lm(I(clothing_expenditure^(.25))~income, data=spending_subset)
msummary(clothing_model_25)
```

```
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 6.162e+00  2.140e-01  28.796  &lt; 2e-16 ***
## income      1.633e-05  4.648e-06   3.515 0.000546 ***
## 
## Residual standard error: 1.149 on 198 degrees of freedom
## Multiple R-squared:  0.05872,	Adjusted R-squared:  0.05397 
## F-statistic: 12.35 on 1 and 198 DF,  p-value: 0.0005457
```

---


```r
xyplot(I(log(clothing_expenditure))~income, data=spending_subset,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-83-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
clothing_model_log = lm(I(log(clothing_expenditure))~income, data=spending_subset)
msummary(clothing_model_log)
```

```
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 7.199e+00  1.339e-01  53.757  &lt; 2e-16 ***
## income      1.030e-05  2.908e-06   3.541 0.000497 ***
## 
## Residual standard error: 0.719 on 198 degrees of freedom
## Multiple R-squared:  0.05955,	Adjusted R-squared:  0.0548 
## F-statistic: 12.54 on 1 and 198 DF,  p-value: 0.0004973
```

---


```r
xyplot(clothing_expenditure~I(income^4), data=spending_subset,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-84-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
clothing_model_x4 = lm(clothing_expenditure~I(income^4), data=spending_subset)
msummary(clothing_model_x4)
```

```
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.393e+03  1.367e+02   17.51  &lt; 2e-16 ***
## I(income^4) 2.784e-17  9.669e-18    2.88  0.00442 ** 
## 
## Residual standard error: 1645 on 198 degrees of freedom
## Multiple R-squared:  0.0402,	Adjusted R-squared:  0.03535 
## F-statistic: 8.292 on 1 and 198 DF,  p-value: 0.00442
```
---


```r
plot(spending_subset$income, spending_subset$clothing_expenditure)
abline(clothing_model, col="black", lwd=3)
orderX = order(clothing_model_25$model[,2])
lines(clothing_model_25$model[orderX,2], (predict(clothing_model_25)^4)[orderX], col="blue", lwd=3)
lines(clothing_model_log$model[orderX,2], exp(predict(clothing_model_log))[orderX], col="green", lwd=3)
lines((clothing_model_x4$model[orderX,2])^(1/4), predict(clothing_model_x4)[orderX], col="red", lwd=3)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-85-1.png" width="504" style="display: block; margin: auto;" /&gt;
---
### CDI: Transformations - physicians vs hospital beds

This data set provides selected county demographic information (CDI) for 440 of the most populous counties in the United States. 

Each line of the data set has an identification number with a county name and state abbreviation and provides information on 14 variables for a single county. 

Counties with missing data were deleted from the data set.

---

```r
cdi %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c2423acd5a541cee7f81" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c2423acd5a541cee7f81">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440"],["Los_Angeles","Cook","Harris","San_Diego","Orange","Kings","Maricopa","Wayne","Dade","Dallas","Philadelphia","King","Santa_Clara","San_Bernardino","Cuyahoga","Middlesex","Allegheny","Suffolk","Nassau","Alameda","Broward","Bexar","Riverside","Tarrant","Oakland","Sacramento","Hennepin","St._Louis","Erie","Franklin","Milwaukee","Westchester","Hamilton","Palm_Beach","Hartford","Pinellas","Honolulu","Hillsborough","Fairfield","Shelby","Bergen","Fairfax_County","New_Haven","Contra_Costa","Marion","DuPage","Essex","Montgomery","Clark","Baltimore_City","Prince_George's","Salt_Lake","San_Francisco","Macomb","Monroe","Worcester","Baltimore","Montgomery","Orange","Duval","Middlesex","Essex","Ventura","Fresno","Pima","Jefferson","Suffolk","Jefferson","San_Mateo","Fulton","Jackson","Norfolk","District_of_Columbia","Oklahoma","Providence","El_Paso","Pierce","Multnomah","Travis","Montgomery","Monmouth","Hudson","Delaware","De_Kalb","Kern","Bucks","Lake","Summit","Mecklenburg","Davidson","Bristol","Tulsa","Camden","Kent","Orleans","Union","Ramsey","San_Joaquin","Bernalillo","Lake","Onondaga","Denver","Snohomish","Lucas","Hampden","Passaic","Jefferson","Cobb","New_Castle","Jefferson","Plymouth","Ocean","Genesee","Anne_Arundel","Wake","Lancaster","Morris","Douglas","Polk","Sedgwick","Brevard","El_Paso","St._Louis_City","Burlington","VA_Beach_City","Arapahoe","Sonoma","Hidalgo","East_Baton_Rouge","Mobile","Chester","Volusia","Stanislaus","Westmoreland","Santa_Barbara","Stark","Dane","Spokane","Will","Monterey","Johnson","Gwinnett","Pulaski","Guilford","Solano","York","Berks","Hillsborough","Knox","Lee","Luzerne","Mercer","Greenville","Kane","Tulare","Washington","Orange","Waukesha","Allen","Charleston","Albany","Butler","Nueces","Lehigh","Seminole","Richland","Hamilton","Washtenaw","Lane","Ingham","Pasco","Clackamas","Sarasota","Erie","Dakota","Cumberland","Denton","Lorain","Forsyth","Rockland","Adams","Mahoning","Collin","Utah","St._Clair","Escambia","Norfolk_City","Cameron","Dutchess","New_London","Washoe","Hinds","Winnebago","Oneida","Madison","Caddo","Northampton","St._Joseph","Rockingham","Cumberland","Somerset","Jefferson","Madison","Clark","Dauphin","Marin","Gloucester","Santa_Cruz","Marion","Trumbull","Spartanburg","Fort_Bend","Fayette","Boulder","Atlantic","Kalamazoo","Lubbock","Niagara","Lackawanna","Galveston","San_Luis_Obispo","Chatham","Prince_William_County","Lake","Lancaster","St._Charles","Broome","Saginaw","Manatee","Montgomery","Greene","Kanawha","Ada","Washington","St._Louis","Cumberland","Marion","Brown","Leon","Brazoria","Bell","Kitsap","Richmond","McLennan","Yakima","Davis","Ottawa","Howard","Barnstable","Larimer","Beaver","McHenry","Peoria","Montgomery","Harford","Butte","Clayton","Durham","Alachua","Saratoga","Muscogee","Merced","Sangamon","Gaston","Racine","Buncombe","Cleveland","Litchfield","Champaign","Placer","Jefferson","Arlington_County","Newport_News_City","Calcasieu","Lexington","Harrison","Ulster","Vanderburgh","Lafayette","York","Cambria","Wyandotte","Berrien","Thurston","Kent","Shawnee","Muskegon","Weber","Elkhart","Rensselaer","Clay","Schuylkill","Lake","Collier","Butler","Chesapeake_City","Smith","Tuscaloosa","Frederick","Clermont","St._Lucie","Bibb","Onslow","Jackson","Schenectady","Rock_Island","Clark","Shasta","Penobscot","Hampshire","Jackson","Washington","St._Clair","Fayette","Anderson","St._Tammany","Horry","Okaloosa","Sullivan","Middlesex","Portage","Ouachita","Kenton","Chautauqua","Yolo","Outagamie","Winnebago","Williamson","Rock","Berkshire","Cumberland","Greene","Calhoun","Dona_Ana","Hampton_City","Monroe","Webb","Weld","Chittenden","Rapides","York","Sussex","Madison","Tippecanoe","Blair","McLean","Porter","Tolland","Licking","Kenosha","Whatcom","Bay","Davidson","Richland","El_Dorado","Minnehaha","Centre","Tazewell","Carroll","Pueblo","Wichita","Medina","Brazos","Oswego","Franklin","Mercer","Aiken","Hawaii","New_Hanover","Merrimack","Delaware","Taylor","Humboldt","Ector","Stearns","Lycoming","Rutherford","Catawba","Macon","Pinal","Calhoun","Kennebec","Livingston","Marathon","Jackson","Florence","Lebanon","Yellowstone","Washington","Wood","Benton","Boone","St._Lawrence","Bay","Comanche","Alexandria_City","Kent","Charlotte","Jefferson","Napa","Rowan","Washington","Allen","Imperial","Monroe","Hamilton","Columbiana","Alamance","Pitt","Hunterdon","Osceola","Yavapai","La_Porte","La_Salle","Yuma","Midland","Randolph","Olmsted","Vigo","Clay","Androscoggin","Robeson","Gregg","Wayne","Strafford","Sheboygan","Fairfield","Sumner","Cass","Sumter","Sarpy","Windham","Kings","Wayne","Charles","Hernando","Martin","Montgomery","Maui","Morgan"],["CA","IL","TX","CA","CA","NY","AZ","MI","FL","TX","PA","WA","CA","CA","OH","MA","PA","NY","NY","CA","FL","TX","CA","TX","MI","CA","MN","MO","NY","OH","WI","NY","OH","FL","CT","FL","HI","FL","CT","TN","NJ","VA","CT","CA","IN","IL","NJ","MD","NV","MD","MD","UT","CA","MI","NY","MA","MD","PA","FL","FL","NJ","MA","CA","CA","AZ","KY","MA","AL","CA","GA","MO","MA","DC","OK","RI","TX","WA","OR","TX","OH","NJ","NJ","PA","GA","CA","PA","IL","OH","NC","TN","MA","OK","NJ","MI","LA","NJ","MN","CA","NM","IN","NY","CO","WA","OH","MA","NJ","LA","GA","DE","CO","MA","NJ","MI","MD","NC","PA","NJ","NE","FL","KS","FL","CO","MO","NJ","VA","CO","CA","TX","LA","AL","PA","FL","CA","PA","CA","OH","WI","WA","IL","CA","KS","GA","AR","NC","CA","PA","PA","NH","TN","FL","PA","NJ","SC","IL","CA","OR","NY","WI","IN","SC","NY","OH","TX","PA","FL","SC","TN","MI","OR","MI","FL","OR","FL","PA","MN","NC","TX","OH","NC","NY","CO","OH","TX","UT","IL","FL","VA","TX","NY","CT","NV","MS","IL","NY","IL","LA","PA","IN","NH","ME","NJ","TX","AL","WA","PA","CA","NJ","CA","OR","OH","SC","TX","KY","CO","NJ","MI","TX","NY","PA","TX","CA","GA","VA","OH","NE","MO","NY","MI","FL","AL","MO","WV","ID","PA","MN","PA","FL","WI","FL","TX","TX","WA","GA","TX","WA","UT","MI","MD","MA","CO","PA","IL","IL","TX","MD","CA","GA","NC","FL","NY","GA","CA","IL","NC","WI","NC","OK","CT","IL","CA","MO","VA","VA","LA","SC","MS","NY","IN","LA","ME","PA","KS","MI","WA","RI","KS","MI","UT","IN","NY","MO","PA","FL","FL","PA","VA","TX","AL","MD","OH","FL","GA","NC","MI","NY","IL","OH","CA","ME","MA","OR","MN","MI","PA","SC","LA","SC","FL","TN","CT","OH","LA","KY","NY","CA","WI","WI","TX","WI","MA","NJ","OH","MI","NM","VA","MI","TX","CO","VT","LA","SC","NJ","IN","IN","PA","IL","IN","CT","OH","WI","WA","FL","NC","OH","CA","SD","PA","IL","MD","CO","TX","OH","TX","NY","PA","PA","SC","HI","NC","NH","IN","TX","CA","TX","MN","PA","TN","NC","IL","AZ","AL","ME","MI","WI","MS","SC","PA","MT","AR","OH","WA","MO","NY","MI","OK","VA","DE","FL","NY","CA","NC","RI","OH","CA","IN","IN","OH","NC","NC","NJ","FL","AZ","IN","IL","AZ","TX","NC","MN","IN","FL","ME","NC","TX","NC","NH","WI","OH","TN","ND","SC","NE","CT","CA","OH","MD","FL","FL","TN","HI","AL"],[4060,946,1729,4205,790,71,9204,614,1945,880,135,2126,1291,20062,458,824,730,911,287,738,1209,1247,7208,864,873,966,557,508,1045,540,242,433,407,1974,736,280,600,1051,626,755,234,396,606,720,396,334,126,495,7911,81,486,737,47,480,659,1513,599,483,908,774,311,498,1846,5963,9187,385,59,1113,449,529,605,400,61,709,413,1013,1676,435,989,462,472,47,184,268,8142,608,448,413,527,502,556,570,222,856,181,103,156,1399,1166,497,780,153,2090,340,619,185,306,340,426,772,661,636,640,416,834,949,469,331,1875,1000,1019,2127,62,805,248,803,1576,1569,456,1233,756,1106,1495,1023,2739,576,1202,1764,837,3322,477,433,771,650,828,905,859,877,509,804,891,226,792,521,4824,724,816,556,657,917,524,467,836,347,308,757,543,710,4554,559,745,1868,572,802,570,653,889,493,410,174,1192,415,848,1998,664,664,54,906,802,666,6343,869,514,1213,725,882,374,457,695,836,305,904,805,628,525,520,325,446,1185,616,811,875,285,743,561,562,900,523,459,399,3305,440,338,228,839,561,707,809,741,790,675,903,1055,857,6226,550,1579,529,667,1387,1059,396,324,1042,4296,305,566,252,396,2601,435,604,620,1044,440,1640,143,291,874,812,216,1929,868,357,333,656,536,920,997,1404,657,26,68,1071,701,581,1127,235,270,991,688,151,571,727,170,550,509,576,464,654,397,779,953,2026,789,341,929,1325,663,452,573,250,767,707,206,427,400,3786,3396,529,2785,392,725,790,718,854,1134,936,413,369,492,611,163,1062,1012,640,439,1124,721,931,489,415,709,3807,52,551,3357,3993,539,1323,683,521,452,500,526,1184,418,410,687,273,2120,764,552,497,1712,809,1108,649,449,2389,628,422,586,953,772,672,1073,4028,199,935,393,916,3573,901,1345,1235,619,400,581,5370,609,868,568,1545,727,799,362,2635,950,617,1703,685,2686,444,1069,15,591,694,1272,754,511,333,405,4175,394,398,533,431,652,430,1322,8124,598,1135,5514,900,788,653,403,601,470,949,274,553,369,514,506,529,1766,666,241,513,1390,555,461,478,556,539,1159,582],[8863164,5105067,2818199,2498016,2410556,2300664,2122101,2111687,1937094,1852810,1585577,1507319,1497577,1418380,1412140,1398468,1336449,1321864,1287348,1279182,1255488,1185394,1170413,1170103,1083592,1041219,1032431,993529,968532,961437,959275,874866,866228,863518,851783,851659,836231,834054,827645,826330,825380,818584,804219,803732,797159,781666,778206,757027,741459,736014,729268,725956,723959,717400,713968,709705,692134,678111,677491,672971,671780,670080,669016,667490,666880,664937,663906,651525,649623,648951,633232,616087,606900,599611,596270,591610,586203,583887,576407,573809,553124,553099,547651,545837,543477,541174,516418,514990,511433,510784,506325,503341,502824,500631,496938,493819,485765,480628,480577,475594,468973,467610,465642,462361,456310,453060,448306,447745,441946,438430,435276,433203,430459,427239,423380,422822,421353,416444,405382,403662,398978,397014,396685,395066,393069,391511,388222,383545,380105,378643,376396,370712,370522,370321,369608,367585,367085,361364,357313,355660,355054,352910,349660,347420,340421,339574,336523,336073,335749,335113,328149,325824,320167,317471,311921,311554,307647,304715,300836,295039,292594,291479,291145,291130,287529,285720,285536,282937,282912,281912,281131,278850,277776,275572,275227,274566,273525,271126,265878,265475,265038,264806,264036,263590,262852,262798,261229,260120,259462,254957,254667,254441,252913,250836,249238,248253,247105,247052,245845,243135,240279,239397,238912,238053,237813,230096,230082,229734,228483,227813,226800,225421,225366,225339,224327,223411,222636,220756,219039,217399,217162,216935,215686,215499,213641,212907,212160,211946,211707,209085,207949,207619,205775,204584,198213,195257,194833,194594,192493,191707,191088,189731,189719,189123,188823,187941,187768,187328,186605,186136,186093,183241,182827,182201,182132,182120,182052,181835,181596,181276,179278,178403,178386,175093,175034,174821,174253,174092,173025,172796,171380,170936,170045,168134,167611,165365,165304,165058,164762,164587,163029,161993,161378,161238,161135,160976,158983,158330,156198,154429,153411,152585,152104,152099,152013,151976,151309,150522,150208,150187,150171,149967,149838,149756,149285,148723,147548,147036,146601,146568,146389,145896,145607,145351,145196,144508,144053,143776,143596,143196,142585,142191,142031,141895,141092,140510,140320,139551,139510,139352,138053,136731,135982,135510,133793,133600,133239,131821,131761,131556,131497,130943,130669,130598,130542,129180,128932,128699,128300,128181,127780,126994,126677,126137,125995,123809,123786,123692,123372,123051,122378,122354,121862,121771,121082,121003,120940,120317,120284,120005,119659,119655,119118,118934,118791,118710,118570,118412,117206,116379,116034,115904,115645,115400,115243,114344,113744,113419,113409,113269,112560,112379,111974,111723,111486,111183,110993,110975,110943,110765,110605,110006,109755,109303,108978,108936,108276,108213,107924,107776,107728,107714,107066,106913,106895,106611,106546,106470,106107,105986,105259,105179,104948,104666,104233,103877,103461,103281,102874,102637,102583,102525,101469,101461,101154,101115,100900,100498,100374,100043],[32.1,29.2,31.3,33.5,32.6,28.3,29.2,27.4,27.1,32.6,29.1,30.1,32.6,30.1,26.3,31.7,26.2,27.9,25.7,30.8,25.3,29.5,27.9,32.2,27.6,29.7,31.6,26.1,27.3,33.5,29.3,26.3,28,23.3,28.3,22.4,30.6,29.4,26.7,29.4,25.4,29.2,28.7,26.5,30.6,29,28.6,28.6,29,30,33.7,27.8,32.2,28.2,29,29.2,27.8,26.1,33.2,30.7,31.6,27.3,28.8,28.3,28.9,27,39.2,26.7,28.4,31.6,28.1,28.8,33.6,28.4,29.9,29.5,29.5,28.4,38,28.1,25.6,31.5,27.6,32.6,28.3,26.6,28.9,26.8,32,32.1,27.6,28.2,27.5,29.6,28.3,26.8,31,27.7,29.2,25.5,29.4,30.3,28.1,27.8,27.8,28.9,28.1,31.7,30.6,26.9,27.1,22.4,27.2,29.6,34.5,27.2,26.7,29,23.9,28.5,26.2,31.7,28.7,28.8,35.3,28.3,25.8,26.4,31.5,26.7,27.1,24.3,27.4,23.3,32.8,24.9,35.6,27,27.4,32.6,27.5,32.6,28.5,30.4,29.7,26.6,26.1,30,30,21.5,24.1,29.2,28.2,27.8,26.3,27.6,28,24.4,27.4,34.1,30.4,29.9,27.3,26.3,27.9,34.7,26.3,39.5,27.4,37.4,18.4,23.1,18.2,27.5,30.6,37.4,36.9,26.4,29.2,25.5,29.6,23.5,29.8,33.9,26.8,29.2,41.7,25.9,29,31.2,29.5,29.5,26.5,27.7,26.2,25.2,26.9,28.2,29,29.1,28.6,25.8,31.4,25.3,26.8,24.7,28,29.9,25.7,23.9,27,26.8,34.9,34.2,29,32.4,34.1,25.8,24.3,26.9,31.4,28.5,32.3,26.4,33.9,29,28.6,25.5,21,28.4,31,23.9,27.6,23.7,24.3,28.6,21.6,29.6,38.5,28.7,34.6,27.7,31.1,30,25.1,26.2,28.9,29.8,22.1,32.1,23.6,26.3,26,25.5,28.8,28.2,32.4,33.7,40.1,28.4,30.6,28.2,25.8,27.3,26,24.8,33.9,25.4,41.6,23.5,28.5,37.6,33.9,26.6,27.8,30,27.8,27,31.1,26.4,23,27.4,25.2,25.3,26.2,26.2,25.8,26,26.8,29.8,28.3,22.9,19,22.4,27,28.6,26.2,33.3,28.7,28.1,22.9,27.5,49.7,27.1,26.1,24.9,25.3,22.8,30,38.2,22.1,26.5,25.9,22.9,25.5,24.2,28.2,30.8,24.6,28.4,33.6,28.3,28.3,25.7,36.5,28.2,30.3,29.1,26.2,26,26.7,28.5,25.1,31.4,33,26.1,28.5,29.6,35.8,26.8,28.7,26.3,25.5,42.3,23.7,37,26.4,33.9,26.2,27.5,28.8,27.7,26.9,25,23,29.7,45,23.9,26.6,24.1,29.5,24.5,49.4,29.8,25.5,24.5,26.7,22.5,29,27.7,32.9,30.7,27.5,27.1,33.6,25.4,33.1,27.2,24.1,24.4,28.8,26.1,25.3,25.9,25.9,26.2,25.3,25.6,32,34.5,25.1,40.9,31.2,25.4,34.5,38.3,29.7,16.6,32.7,24.5,26,31,26.2,25.5,45.8,25.1,23.4,27.3,35.4,25.6,27.1,18.3,26,23.8,27.4,26.8,27.1,29.3,30.2,26.3,27.9,26.7,26.4,29.7,34.8,25.4,25.2,25.5,34.4,31.6,30.4,28.5,33.7,26.3,29.9,16.4,20.4,35.7,26.2,26.3],[9.699999999999999,12.4,7.1,10.9,9.199999999999999,12.4,12.5,12.5,13.9,8.199999999999999,15.2,11.1,8.699999999999999,8.800000000000001,15.6,12.5,17.4,10.8,14.2,10.6,20.7,9.9,13.2,8.300000000000001,10.9,10.6,11.3,13.1,15.2,9.6,13.6,14.4,13.3,24.4,14.1,26,11,12.2,13.3,10.4,15.3,6.5,14.7,10.9,11.7,8.699999999999999,12.7,10.2,10.5,13.7,6.9,8.5,14.5,12.3,12.5,13.7,14,15,10.6,10.7,11.8,14.1,9.4,10.4,13.7,13.4,12.1,14,12.3,10,13.1,14.1,12.8,12.1,15.8,8.1,10.5,13.6,7.3,12.6,12.7,12.7,15.5,8.5,9.699999999999999,10.9,8.4,13.8,9.4,11.6,14.4,11.5,12.2,10.8,13,15,12.2,11.1,10.5,12.3,13,13.8,9.5,13,14.8,12.9,10.2,6.3,11.4,8,11.6,23.2,10.2,8.800000000000001,7.8,13.1,10.6,11.4,18.6,11.4,16.6,8,16.6,10.7,5.9,7.4,13.4,10.1,9.199999999999999,11.8,10.9,22.8,10.8,17.1,12.3,14.4,9.300000000000001,13.2,8.6,9.800000000000001,9.4,4.7,11.5,11.9,8.199999999999999,13.1,15.6,10.3,12.7,24.7,19.7,13,11.9,9.300000000000001,10.8,10.1,10.4,9.800000000000001,11.4,10.1,14.7,10.2,10.1,15.4,10.3,9.5,13.5,7.5,13.1,8.699999999999999,32.3,11.5,32.1,13.8,6.4,6.2,5,11.6,12.3,10.1,7.6,17.1,5.3,7,12.7,11.9,10.5,10.6,11.4,11.9,10.3,11.2,12.7,15.5,13.9,13.3,15,14.1,9.199999999999999,13,10.8,14,8.9,10.6,14.3,12.3,10.8,11.3,14.3,14.4,12.6,4.9,9.9,7.6,14.5,10.6,9.800000000000001,15.1,19.8,10.5,14.1,12.8,3,12,10.8,6.9,15,12,28.1,11.6,13.3,15.7,10.4,17.5,16.9,13.4,22.1,10.8,8.199999999999999,7.8,8.800000000000001,10.7,10,13.6,13,6.1,9.800000000000001,6.1,22,9.6,16.9,9.4,14.2,8.6,8.300000000000001,17.3,5.8,10.7,9.300000000000001,10.3,10.8,9.199999999999999,13.8,12.1,12,16.1,6.7,14.1,8.800000000000001,12,8.300000000000001,11.3,9.300000000000001,10.9,8.9,10.8,13,15.7,8.300000000000001,12.6,18.7,13,13.7,11.7,15.1,13.1,13,11.1,11.2,13.2,10.4,20,27.5,22.8,13.5,8.4,13.7,11.4,9.4,8.699999999999999,21,12.9,4.4,12.3,16.5,15,13.8,14.1,11.5,11.6,16.2,6.6,12.3,18,13.6,8.9,12.7,9.300000000000001,14.3,13.1,9.4,11.2,11.5,15.7,9.6,11.1,12.8,7.6,12.6,16.9,13.5,9.800000000000001,13.3,8.800000000000001,9.6,10.4,7.9,10.2,8.1,12,10.6,8.9,14,9.5,17,10.5,9.800000000000001,9,11.8,12.6,12.5,12,12,12.9,11.8,11.6,9,13.2,10.2,15.2,12.8,9.699999999999999,6.7,10.7,14.4,17.2,11.4,12.6,12.5,12.1,12.7,12,12.3,9.300000000000001,10.5,15.1,8.4,11.9,14.5,13.7,12.4,13.4,8.199999999999999,12.7,9.4,11.2,15,12.4,11.2,10.2,10.1,8.4,12.1,13.4,8.699999999999999,10.3,10.3,33.8,10.9,16.5,15.2,12.3,13.4,10.2,8.6,8.199999999999999,14.9,14.8,9.9,9.5,13.9,23.8,13.1,17.2,13.8,9,12.2,10,15.1,8.5,13.4,10.7,13.3,10.2,10.7,14.6,11.3,10.2,9.800000000000001,9.4,4.8,12.5,7.7,11.6,6.5,30.7,27.5,7.9,11.3,11.7],[23677,15153,7553,5905,6062,4861,4320,3823,6274,4718,6641,5280,4101,2463,5620,5158,5281,3021,6147,3169,2456,3062,1385,1677,4020,2464,3706,1194,2748,2675,2774,4577,3164,1833,2851,1620,2025,2012,2417,2489,3226,1694,3161,1761,2936,2157,2811,4635,969,5444,1253,2094,4761,705,2438,1902,1269,3237,1367,1538,1637,1185,1168,1188,1841,2171,5674,2532,1814,3368,1695,2758,3674,1922,1862,795,915,2571,1254,1313,1300,1036,1374,1036,682,879,1093,1216,1114,2293,572,1158,1255,1007,2500,1362,1512,666,1585,707,1534,2867,502,1391,904,831,1237,622,1038,551,576,513,692,616,761,574,1147,1603,559,930,563,548,4189,719,679,583,840,311,841,850,594,495,558,522,875,595,1603,852,298,515,1173,271,1510,676,481,460,567,587,984,509,594,994,650,473,358,353,479,687,552,1357,1257,308,584,637,357,999,738,2188,497,729,308,462,631,468,201,291,216,291,1194,931,439,601,282,291,329,522,1101,270,535,486,603,1076,521,437,275,898,459,417,343,732,783,449,399,256,824,1001,199,429,376,225,375,231,1248,452,379,614,655,239,429,950,424,494,196,233,389,172,460,335,322,419,490,569,367,236,406,375,235,289,413,156,513,233,1032,301,231,166,163,695,336,278,197,160,581,125,247,327,191,1944,1180,215,360,185,600,142,234,469,217,278,382,329,61,615,354,248,145,313,258,411,361,172,301,494,199,283,264,451,182,266,164,213,108,147,167,282,127,212,349,299,172,82,176,438,104,127,403,209,173,267,268,348,263,113,143,124,199,282,175,178,377,340,101,268,263,164,339,228,242,88,171,375,181,134,172,171,163,83,107,172,696,246,121,133,140,232,213,171,170,164,101,140,203,178,78,144,147,376,178,98,142,259,243,125,170,79,136,150,128,182,297,237,217,204,207,153,199,232,133,179,171,61,133,241,68,172,170,211,162,262,208,128,142,746,132,101,127,652,123,183,124,345,114,162,168,82,172,257,80,132,496,184,98,114,149,104,118,139,69,1814,179,164,198,83,166,113,139,114,86,96,343,88,39,123,82,84,67,98,193,87,192,122],[27700,21550,12449,6179,6369,8942,6104,9490,8840,6934,10494,4009,3342,3349,8132,4152,8436,3904,5200,3284,5543,4086,2435,3672,3254,2855,5395,1056,4632,4011,4141,3540,4683,3164,2940,4458,2174,3068,2494,4918,2279,135,2486,1781,4654,1842,4841,1507,2011,6203,1322,2076,3640,1202,3077,2205,641,2425,2929,2623,1880,2009,1372,1681,2016,3559,6154,4602,1642,5757,3762,1903,4262,3487,2360,1650,1226,3009,1392,3068,1904,2443,1588,922,1194,1435,1499,2226,2021,3847,1306,2512,2041,1460,4018,2541,1140,1051,1726,2413,1668,3652,672,3021,1665,1912,1648,983,1488,298,813,1475,1830,617,1199,1241,1599,2889,1288,1840,1085,1026,7814,1150,530,742,798,860,1876,1898,920,1349,1306,1306,1031,1537,1382,1346,746,602,925,439,2785,1188,503,951,1041,1050,2178,1202,1495,1724,1358,1263,656,294,986,677,1268,1956,1246,878,1406,1305,352,1207,1573,1730,654,1438,941,345,1363,1417,283,586,458,941,1609,745,318,1473,571,544,1088,1584,1471,825,741,515,990,2118,910,905,1120,1868,933,927,514,1104,374,1724,933,299,1425,488,339,390,498,925,832,301,1851,387,990,793,1562,893,1136,1592,522,1112,153,359,778,613,816,1193,855,1102,1785,1342,557,687,1391,733,451,632,823,318,572,244,1787,560,518,248,313,208,384,409,616,371,1219,340,333,625,346,1496,1096,221,1168,337,1330,368,532,725,319,411,805,322,230,781,836,845,259,764,413,1376,1018,404,892,1019,688,500,359,661,660,573,478,616,693,634,664,431,261,210,795,731,241,151,425,1010,133,573,721,769,463,468,598,236,522,92,431,409,456,512,505,482,982,235,285,1043,733,653,168,511,528,185,491,598,534,210,566,240,251,182,382,281,573,768,276,261,655,635,654,588,379,173,192,334,214,478,221,463,163,912,270,297,123,555,457,226,279,269,296,653,191,391,554,368,494,467,311,389,661,668,215,464,725,309,486,497,93,254,346,731,196,554,651,124,278,1023,378,415,347,662,193,632,336,1019,244,241,560,221,285,122,485,340,583,182,291,159,519,504,197,333,145,1437,576,277,527,281,420,263,237,421,195,259,643,214,160,254,180,155,104,290,277,188,182,464],[688936,436936,253526,173821,144524,680966,177593,193978,244725,214258,109148,124959,77009,83110,73150,35825,50186,66723,43203,107338,107386,133098,95494,132495,50964,84305,71753,42595,55306,82680,73681,37118,57208,76142,51926,62344,51032,89895,44374,67032,28521,30202,52903,51243,61004,29708,75595,34754,52786,87355,54469,58610,71234,41048,43780,7099,46789,20335,52577,68586,30548,34312,30235,62004,57051,32419,68808,55604,30473,93025,61760,14830,64393,57045,34627,54002,41980,58216,60961,36665,22302,40581,18924,56950,36318,16894,22349,26228,57999,45237,22023,39496,34814,31553,54238,30299,30574,41179,41280,29926,23249,37466,20323,38194,24247,26434,41625,27582,27717,23453,14846,17379,33136,21826,26006,13086,12147,26006,37290,34071,23686,25234,64103,13034,23412,27587,18556,26712,41592,30409,9491,25736,25461,7445,18313,17466,20344,20042,16432,17870,15238,17119,42404,28212,21756,11292,12827,12843,22422,18442,4982,20153,20504,16721,19489,12630,10975,8935,19842,28190,15077,13850,28606,12254,17518,24101,23532,19367,16091,17337,12509,12855,19801,9936,10953,25247,20372,9864,21554,7194,19369,13181,17625,10605,14563,14380,25194,18842,9087,7807,18831,28841,19674,9234,10666,22091,6452,10637,7295,13816,8308,21677,6635,10706,11563,9460,9746,13707,14825,7315,17198,9433,17378,14124,25167,15306,14509,9437,4368,18586,8103,18732,9001,5481,16414,7785,7435,16190,16916,17388,13551,10246,9701,4526,7518,5247,14860,8101,23363,8692,10865,8996,17918,16486,15139,6279,6140,9057,7441,8921,4088,4854,12483,9469,6735,8939,15419,15477,18218,5281,11454,8587,11929,11865,11110,9512,12194,3593,11508,8904,3128,12526,11776,6399,9814,7043,4701,8405,10599,6027,3187,18902,12229,7882,7302,13845,12181,9191,7573,5297,11085,2119,7099,9426,3420,8427,11712,12377,4939,5114,9842,12701,7505,8630,6364,7154,10131,7336,4749,2547,7170,5365,6568,3612,7525,4447,12459,5153,6236,3409,2769,10605,6925,5178,10650,4860,6170,5724,7643,3862,9071,5221,9810,8850,8376,6726,12202,7901,4739,6101,9525,3174,5373,6141,3196,5949,4014,1799,1380,6616,7070,8634,5662,7977,5152,5625,4136,3140,3430,8640,10727,563,8203,3582,3155,2777,6835,7226,11892,3325,1064,6785,5737,14643,4101,3826,6072,6830,6103,6275,4901,4184,3760,3655,4777,8421,2919,3879,6122,3759,6249,5456,3851,4849,5979,8537,5846,3741,3064,5056,5233,3838,4734,8042,1657,1699,898,4152,4603,2068,9665,3952,6021,2982,5414,7546,2940,4310,3435,4560,4020,4318,9181,4682,3651,4433,625,3285,3401,7138,2689,1397,4449,2377,5279,4414,5081,6537,7130,4693],[70,73.40000000000001,74.90000000000001,81.90000000000001,81.2,63.7,81.5,70,65,77.09999999999999,64.3,88.2,82,75.40000000000001,74,84.3,79,82.2,84.2,81.40000000000001,76.8,72.7,74.09999999999999,79.90000000000001,84.59999999999999,82.2,88.2,82.3,76.40000000000001,81,76.3,81,75.59999999999999,78.8,77.7,78.09999999999999,81.2,75.59999999999999,81,75.09999999999999,81.59999999999999,91.40000000000001,77.5,86.5,76.8,88.59999999999999,70.09999999999999,90.59999999999999,77.3,60.7,83.2,85.3,78,76.90000000000001,80.09999999999999,77.40000000000001,78.40000000000001,83.8,78.8,76.90000000000001,79.40000000000001,80.2,79.40000000000001,66.2,80.5,74.09999999999999,75.40000000000001,73.8,84.09999999999999,77.8,79.5,88,73.09999999999999,79.09999999999999,67,63.7,83.2,82.90000000000001,83.40000000000001,77.8,82.8,64.09999999999999,81.40000000000001,83.90000000000001,67.59999999999999,82.90000000000001,84.7,78.3,81.59999999999999,75.90000000000001,65,81.7,75.5,80.3,68.09999999999999,75.2,85,68.59999999999999,82.09999999999999,73.5,80.7,79.2,85.7,76.2,73.59999999999999,68.8,76,85.8,80.59999999999999,89.8,83.8,74.90000000000001,76.8,81.09999999999999,85.40000000000001,70.5,87,84.5,68,82.40000000000001,82.3,88.3,62.8,81.90000000000001,88,91.5,84.40000000000001,46.6,80.5,70.09999999999999,84.90000000000001,75.40000000000001,68.40000000000001,77.7,80,76,88.90000000000001,84.40000000000001,80.40000000000001,72.90000000000001,92.90000000000001,86.7,79,76.09999999999999,82.7,72.8,70,82.2,74.59999999999999,76.90000000000001,72,77.09999999999999,71.59999999999999,77.7,60.2,88.2,77.2,88,81.2,75.5,80.90000000000001,76,68.90000000000001,74.59999999999999,84.59999999999999,79.40000000000001,72.5,87.2,83,83.90000000000001,66.90000000000001,85.7,81.3,77.5,90.7,80.3,86.8,75.3,77.59999999999999,83.3,78.8,74.59999999999999,88.3,87.90000000000001,72.59999999999999,76.2,72.7,50,79.8,80.90000000000001,82.5,75.2,76.3,75.09999999999999,75.8,73.40000000000001,73.09999999999999,76.09999999999999,86.2,85,86.3,74.40000000000001,80.2,83.90000000000001,77.59999999999999,91.90000000000001,77.5,81.90000000000001,78.7,75.2,63,80.90000000000001,80.2,91.3,72.90000000000001,83.40000000000001,74.2,75.8,73.3,75.8,83.3,73.7,87.8,81.09999999999999,88.09999999999999,83.3,78.90000000000001,74.8,75.59999999999999,75.3,78.90000000000001,72.40000000000001,87.2,73.2,80.3,81,69.59999999999999,82.59999999999999,84.90000000000001,75.5,79.09999999999999,86.59999999999999,70.90000000000001,71.59999999999999,66.09999999999999,89.90000000000001,79.8,91.09999999999999,88.40000000000001,88.59999999999999,74.90000000000001,84.5,77.90000000000001,75.5,81.59999999999999,77.59999999999999,77.2,78.90000000000001,82.7,83,71.5,63.1,81.8,60.9,76.40000000000001,74.5,83.90000000000001,80.90000000000001,87.5,85.09999999999999,71.59999999999999,87.5,79.3,70.3,77.3,74.7,76.59999999999999,75.2,73.3,79.5,71.2,69.90000000000001,74.7,86.5,76.8,84.40000000000001,74.2,82.5,72.8,77.7,84.7,68.40000000000001,70.59999999999999,79,78.59999999999999,77.09999999999999,75.7,69.59999999999999,80.40000000000001,72.8,71.7,68.2,83,77.7,80.7,77.40000000000001,73.40000000000001,78.40000000000001,79.09999999999999,83,80.09999999999999,90,74.8,67.8,64,76.90000000000001,74.3,83.8,66.8,82.59999999999999,79.3,71.59999999999999,74.40000000000001,74.40000000000001,79.09999999999999,81.5,80.59999999999999,81.40000000000001,78.2,77.90000000000001,63.4,82.40000000000001,76.8,70.40000000000001,79.7,74.09999999999999,47.8,74.90000000000001,86.7,69,67.5,85.09999999999999,73.5,85.2,75,84.7,82.40000000000001,84.7,76.40000000000001,75.09999999999999,83.2,74.7,64.2,73.5,85.90000000000001,83.09999999999999,83.59999999999999,78.59999999999999,78.5,73.90000000000001,75.09999999999999,82.40000000000001,79.8,74.7,69.40000000000001,75.09999999999999,70.7,77.7,78.09999999999999,83.2,74.5,75.40000000000001,80.5,66.90000000000001,78.3,74.5,73.90000000000001,66.7,76.2,65.5,67.40000000000001,78.90000000000001,85.59999999999999,75.90000000000001,74.40000000000001,64.3,70,83.7,73.2,83.8,83.90000000000001,84.8,73.09999999999999,74,81.09999999999999,86.90000000000001,73.09999999999999,75.7,76.40000000000001,80.7,66,82.8,76.09999999999999,53.2,82.09999999999999,88.7,71.8,67.90000000000001,71,85.90000000000001,73.7,78.90000000000001,73.90000000000001,73.09999999999999,64.90000000000001,76.8,62,88,76,81.2,71.8,57,75.8,71.2,79.8,77.40000000000001,78.8,70.59999999999999,87.09999999999999,69.8,91,71.09999999999999,65.59999999999999,73.59999999999999,81,70.5,79.7,77.90000000000001,77,69.40000000000001],[22.3,22.8,25.4,25.3,27.8,16.6,22.1,13.7,18.8,26.3,15.2,32.8,32.6,14.9,20.1,35.4,22.6,23,30,28.8,18.8,19.7,14.6,24,30.2,23,31.6,29.2,20,26.6,19.3,35.3,23.7,22.1,25.8,18.5,24.6,20.2,34.2,20.8,31.7,49,24.2,31.6,21.4,36,24,49.9,13.8,15.5,25.5,23.8,35,13.5,26.3,22.2,25,32.1,21.2,18.4,26.5,25.9,23,16.9,23.3,19.3,27.7,19.9,31.3,31.6,20,34.4,33.3,22.6,18.3,15.2,17.5,23.7,34.7,20,28.4,19.7,24.8,32.7,13.3,24.8,32,19.7,28.3,24.4,15.9,23.7,21,20.7,22.4,25,28.8,13.2,26.7,12.8,24.4,29,19.3,17,17.6,18.7,18.8,33,25.2,30.7,22.2,15.3,12.8,24.6,35.3,16.7,36.7,24.9,12.9,22.2,20.4,25.8,15.3,23.6,25.5,35.2,24.5,11.5,27.5,15.5,34.7,14.8,13,15.4,26.6,14.3,34.2,20.6,18,21.5,40.5,29.6,23.5,24.8,18.7,13.9,15.1,26.4,23.9,16.4,13.1,29.5,21,21.4,11.8,29.8,19.5,27.1,19,22.4,28.3,18.7,17,19.6,26.3,28,19.7,41.9,22.2,29.2,9.1,23.6,21.9,16.2,27.6,16.6,32.3,12.3,24.1,33,13,14,39.1,26.2,14.7,18.2,16.8,12,24.8,21.8,20.7,26.4,16.7,16.7,14.4,18.2,16.7,19.2,25.9,27.6,38.3,15.5,30.1,16.8,18.6,44,18.1,29.7,17.5,11.4,14.3,30.2,30.6,42.1,16.4,27.1,23.4,13.6,14.8,19.3,22.9,18.6,27.6,17.5,27.6,21.2,20.7,13,15.5,24.2,20.7,17.6,24.9,13.6,17.3,22.9,11.5,17.7,37.1,15.1,17.2,19.8,17.3,16.6,13.7,23.5,18.7,46.9,28.1,32.3,11.9,21,19.5,19.4,21.5,19.5,14.7,33.4,34.6,25.2,16.6,12,22.4,10.8,16.5,19.1,25.9,25,34.1,22.7,9,52.3,18.4,14.7,21,16.3,21.6,16,22.5,19,10.8,10.3,16.7,24.7,20.5,22.3,11.1,18,14.2,19.5,20,8.1,12.7,22.3,15.6,16.9,19.8,20,22,14.5,13.1,17,13.4,12.9,23,15,12.2,13.7,17.7,31.9,17.6,26.2,10.7,9.300000000000001,12.9,23.1,16,21,15.6,28.2,17.6,18.9,17,14.2,30.3,16.7,18.2,24.6,13.3,20.9,10.8,26,13.8,21.9,19.1,10.5,11.1,18.4,34,14.6,16.9,24.9,11.7,30.7,10.5,29,18.5,29.2,13,12.7,22,15.7,10,11.6,20.8,21.3,32.3,13.6,19.6,14,16.5,18,35.8,12.9,12.4,13.6,17.2,18.5,21.2,25.4,16.5,20.7,20,11.4,17.5,12.3,18.7,14.2,14.8,8.199999999999999,14.2,18.1,19.6,13.5,14.4,14.8,11.8,21.5,20,21.9,23.3,36.5,15.1,11,18.4,48.5,15,13.4,13.6,22.3,11.7,29.1,11.4,9.699999999999999,32.9,36.2,8.5,14.6,21.9,34.6,11.2,17.7,11.7,10.5,12.7,26.4,9.1,29.5,18.1,17.9,12.6,11,17.7,12.7,21.7,13.8,15.5,14.4,26.5,15,25.4,16.8,9,13.9,16.2,9.699999999999999,20.3,16.5,17.8,15.5],[11.6,11.1,12.5,8.1,5.2,19.5,8.800000000000001,16.9,14.2,10.4,16.1,5,5,10.3,11,4.2,8.699999999999999,3.3,2.5,8.1,7.1,16.2,8.4,8.199999999999999,4.4,9.800000000000001,6.4,4,9.4,9.1,12.6,4.7,10.3,6.2,6,6.2,5.4,9.5,4.5,14.7,2.7,2.2,6,5.5,9.300000000000001,1.7,11.3,2.7,7.5,17.8,3.7,7.7,9.699999999999999,4,7.7,6.3,3.8,2.2,7.8,9.800000000000001,3.4,7.5,5,16.8,12,10.9,14.4,12.7,4.3,15.4,9.800000000000001,3.1,13.3,11.3,8.9,22.4,8.699999999999999,8.9,10.2,9.800000000000001,3.4,12.4,5,7.2,13.7,2.9,3.7,9.5,7.2,10,7.4,10,8,6.9,27.3,5.3,8.1,12,10.9,11.7,7.1,13.1,4.9,12,10.9,7.6,11.4,3.8,5,4.1,5.3,4.3,14,3,5.5,5.3,1.8,8.1,9.4,8.300000000000001,6.3,8.1,20.6,3.1,4.3,4.4,5.2,36.3,15.1,17.5,3,7.9,11.4,8.6,7.4,8.9,4.8,9.800000000000001,4.5,8.5,2.5,2.9,10.5,7.3,6,4.3,5.2,4,10.2,6.1,8.300000000000001,5.3,7.8,5,18,4.8,6.4,2.2,5.6,13.8,6,7.6,17.2,4.9,5.3,10.1,10.2,6.4,9.4,11,7.9,4.7,4.6,9.5,3.3,12.1,4.5,9.1,7.8,4.1,8.800000000000001,12.8,3.9,10.6,13.9,13.3,15.1,33.7,3.6,4.7,6.3,16.7,7.7,8.800000000000001,8.5,19.1,4.9,7.1,3.2,5.7,1.4,15.5,8.4,7,7.2,3,4.7,6.2,9.4,9.4,8.800000000000001,6.9,10.2,5.6,6.4,8.9,13.2,8.6,7.8,12.5,6.8,13.6,2.3,3.6,6,3.5,6.5,14.7,6.8,14.1,9.199999999999999,12.3,6.2,9.699999999999999,9.699999999999999,2.8,10.8,6.7,9.4,7.7,12.2,7.5,14.8,13.9,15.6,5.5,3.8,2.2,5.8,6.6,10.8,2.5,11.3,9.4,4.1,12.2,7.3,8.699999999999999,14.4,4.4,14.9,15.4,7.2,8.199999999999999,7.9,8.199999999999999,7,2.4,8,5.3,6,4.3,12.2,15.5,6.3,15.4,5.6,9.1,16.2,4.7,11.2,13.9,11.6,7.1,3.7,7.4,12.4,7.8,5.3,6.6,4.2,7.7,7.9,6.4,7.1,7,12.6,13.5,3.5,7.4,8.5,15.9,9.800000000000001,9.4,5.7,10.2,10.4,11,9.5,5.7,9.699999999999999,3.6,9.199999999999999,17.6,8.6,11.1,11.6,7.8,10.4,2.6,7.6,19.6,8.199999999999999,9.9,9.800000000000001,4.6,5.3,7.6,7.8,6.3,10.2,7.1,11,20.7,8.800000000000001,6.9,33.1,10.6,5,18.6,7.6,2.5,10.3,6.8,11,5.9,4.6,2.7,8.300000000000001,7.6,7.4,11.2,7.3,8.4,5.8,5.4,6.2,7.1,2.5,16.7,12.5,4.1,14.9,8.1,5.7,10.1,11,10.9,9.9,3.6,10.3,11.2,12.8,16.6,7.3,8.4,7.6,4.8,9.800000000000001,18.7,11.7,7.3,3,5.5,14,15.9,5.2,9,9.800000000000001,5,8.9,9.300000000000001,12.8,10.2,13.3,4.7,8.699999999999999,5.2,9.5,4.6,6.8,3.7,10.4,20.8,9.5,2.6,13,6,15.5,1.8,6.9,9.800000000000001,7.8,8.699999999999999,15.4,11.5,6.5,4.5,10.7,5.4,8.699999999999999,20.7,13.4,11.9,5.1,4.5,6.8,7,7.3,16.9,3.5,6,15,8.4,3.7,7.9,5,10.8,5.7,9.4],[8,7.2,5.7,6.1,4.8,9.5,4.9,10,8.699999999999999,6.1,8,4.6,5.5,8,5.5,7.3,5.3,7,5.1,5.3,7.4,6.7,10.7,6.6,7.3,6.3,4.3,5.1,6.8,4.2,4.9,5.4,4.5,8.4,6.9,6.2,2.3,6,5.9,5.4,5.2,3.2,7.3,5.6,5,4.8,7.9,3.3,5.8,9.4,5,4.5,5.6,9.4,4.4,10.2,5.7,5,6.6,6.6,5.7,9,7,12.6,3.9,6.3,8.699999999999999,5.3,4.2,5.3,6.5,7.5,7.7,6,9,10.8,6.4,5.1,4.8,5.7,5.8,9,5.3,4.4,11.8,6.7,4.6,6,4.8,4.6,12.3,6.1,6.9,7.5,6.1,6.9,4.3,12,5.2,7.1,5.6,5.4,5.6,8.800000000000001,9.6,8.1,5.6,4.1,6.2,4.1,10.4,7.4,12.6,5,3.5,5.3,5.1,2.9,10.1,4.5,7.1,6.1,9,5.6,5.4,3.9,5.7,17.6,5.4,7.2,4.6,6.9,14.3,6.9,6,6.9,3.1,6.2,7.4,10.9,3.3,4,5.8,5.4,7,6.2,6.7,7.5,4.6,6.4,8.800000000000001,5.5,4.9,7.5,17.1,4.4,6.7,4.1,5.9,4.9,4.5,6.6,7.7,6.6,6.1,4.6,5.9,6,6.5,6.9,8.300000000000001,4.2,5.1,7.1,4.7,6.4,5.6,9.5,4.4,5.3,5,6.7,5.9,4.3,8.4,5.8,6.4,12.5,5.1,6.8,5,6.3,7.9,6.7,7.9,7.1,6.8,5.7,8,5.7,4.1,6.7,5.2,6.6,5.5,4,7.1,8,5.7,7.9,5.5,3.8,3.8,3.5,8.300000000000001,5.9,5.6,8.300000000000001,7.9,7,5.8,4.3,4.3,5.7,2.2,6.4,5.9,8.800000000000001,5.8,5.9,4.8,7.5,4.1,7,6.5,4.6,8.6,4.6,3.9,5.6,6.7,5.2,4.9,6.4,11.6,4.5,6.5,4.1,11.1,4.1,9.699999999999999,7.1,7.2,5.5,6.7,9.4,5.8,3.6,4.2,5.9,4.6,14.6,4.8,6.2,6.5,4.9,4.8,7,4.5,6.8,8.699999999999999,3.6,6.5,7.8,4.1,6.7,5.9,5.7,5,6.9,9.199999999999999,7.4,9.1,5.9,8.6,4.7,12,5.7,6.4,6.3,5.7,9.699999999999999,8.9,7.5,6.8,6.1,6.6,5.4,6,6,13.8,4.1,5.6,9.9,5.6,7.5,6.5,10.3,8,7.7,7.6,4.6,11.8,9.4,6.6,6.2,7.7,6.7,4.4,5.8,6,6.4,5.4,7.7,7.2,4.9,4.8,3.8,9.699999999999999,10.1,10.7,5.2,8.5,7.4,6.8,11.1,9.800000000000001,4.5,4.4,7.1,5.5,6.8,7.5,3.2,9,4.6,4.5,5.9,6.3,6.4,6.3,8,5.9,9.4,6.1,2.5,6.1,7.4,5.7,7,6.8,5.8,3.6,10,6.7,7.2,4.9,4,5.9,7.1,6.1,5.9,8.800000000000001,6.6,5.4,8,5.4,6.4,8.9,7.9,7.3,6.8,8.1,5.9,7.1,5.9,5.9,5.3,3.7,6.6,6.8,3.2,9.800000000000001,9.199999999999999,6.6,4.6,7.6,7.2,11,5.9,5.4,6.7,7.3,21.3,3.7,2.8,6.7,4.5,5.5,4.1,6.7,5.4,5.8,9.6,17.8,5.4,4.8,3.3,5,5.9,9.699999999999999,8.9,8.199999999999999,7.3,6.5,5.6,6.3,6.8,2.5,9.4,2.6,9.199999999999999,12.8,5.9,4.9,8.199999999999999,9.800000000000001,8,3.2,7.1],[20786,21729,19517,19588,24400,16803,18042,17461,17823,21001,16721,23779,25193,16399,21086,25312,20681,24262,31679,22148,22355,15508,17185,18825,26884,18934,23705,24219,18305,19040,18431,33330,20580,26798,24875,21610,21307,16876,32342,18430,32230,28999,22197,25523,19148,26772,24523,30081,18625,17263,19568,15399,28532,20924,21641,19895,23470,28462,17879,17662,24896,22834,21420,16365,15191,19140,23150,18624,28819,22819,18611,26909,23603,17741,17866,11545,16194,19215,18340,18410,27391,18463,23658,21005,15881,22548,27378,18583,20942,19505,18521,19295,19930,18674,16578,26248,20303,15453,17518,16327,19401,22156,18545,17815,19073,21973,17101,21933,22284,20997,21500,20974,16829,22797,20658,18878,31520,19629,14835,19276,17668,16807,18113,23008,17697,22507,22055,8899,17881,14389,24732,15648,15238,17069,21902,16898,20087,16365,18787,19465,26156,19861,18225,20349,17268,19502,19655,22581,17382,18877,16405,26026,17874,21684,14710,19932,19788,23004,19123,16015,21003,16750,15124,19785,17885,17137,18242,22782,15701,17458,13944,19942,24948,16331,21123,12923,17801,16006,20645,26757,16116,16256,22303,11467,16190,15392,16412,9728,22173,20259,21327,16215,18376,16477,17980,16337,18336,17211,21770,21362,33180,17418,18990,16790,18348,37541,18523,22025,16022,16144,15776,18301,19320,21421,24035,18288,15443,16647,16963,17744,17221,17776,20543,19692,17816,18753,18058,16904,17997,17469,16630,17192,18786,16625,15419,19254,13802,18490,16422,17951,13536,17009,15941,14925,15374,13394,18360,27546,23267,17140,15162,21855,18342,17084,20941,15051,16171,19238,16058,18857,15505,13961,19601,16319,18426,16934,14443,25161,16957,20168,15896,30242,15327,14968,18126,13691,18824,18093,16868,17908,14473,14134,16232,17312,20086,19558,14767,15301,16770,17774,18395,15853,17496,25589,17251,16924,17511,15113,19954,16231,14137,17548,10190,15750,20679,17818,16676,16277,15521,17853,15582,20682,17480,14051,14205,17129,14693,15803,15747,24132,16031,13869,16935,15197,19727,17182,17645,14934,16742,20068,16819,18161,15944,11379,14743,17278,8973,15874,19940,14615,16713,24405,16018,15847,14779,18961,17566,21944,16412,17338,16002,14814,15079,16191,19250,18526,15476,18008,22002,14197,17119,18892,12641,14834,16281,15177,17898,16728,17119,20600,15697,16021,16138,14766,14757,15778,15501,17396,18021,11396,13776,17131,21153,16305,13475,14961,16500,17272,14736,17522,17332,17175,12704,16499,13228,31699,14946,16362,15205,22668,15691,19449,16542,14523,14266,25681,12597,17306,15852,30255,16451,13681,16655,16119,11490,19345,14721,20515,15036,16029,16154,10849,16775,13350,17182,18061,16342,16514,16275,11803,16137,18070,13907,16464,19317,13919,27125,13169,18504,16458],[184230,110928,55003,48931,58818,38658,38287,36872,34525,38911,26512,35843,37728,23260,29776,35398,27639,32071,40782,28331,28066,18383,20114,22027,29131,19714,24474,24062,17729,18306,17680,29159,17827,23141,21188,18404,17818,14075,26768,15229,26602,23738,17851,20514,15264,20927,19084,22772,13810,12706,14270,11179,20656,15011,15451,14120,16244,19300,12113,11886,16725,15301,14330,10923,10131,12727,15369,12134,18721,14808,11785,16578,14325,10638,10653,6830,9493,11219,10571,10564,15151,10212,12956,11465,8631,12202,14138,9570,10710,9963,9378,9712,10021,9349,8238,12962,9862,7427,8419,7765,9099,10360,8635,8237,8703,9955,7666,9820,9848,9206,9358,9086,7244,9740,8746,7982,13281,8174,6014,7781,7049,6673,7185,9090,6956,8812,8562,3413,6797,5448,9309,5801,5646,6321,8095,6211,7374,5914,6713,6923,9287,7009,6373,7070,5878,6622,6614,7589,5836,6326,5383,8480,5723,6884,4588,6210,6088,7010,5753,4725,6145,4882,4403,5760,5142,4896,5209,6446,4442,4922,3920,5561,6930,4500,5814,3548,4869,4340,5489,7103,4271,4305,5889,3023,4256,4045,4287,2530,5753,5165,5431,4126,4648,4133,4481,4056,4531,4252,5352,5194,7972,4170,4537,3997,4363,8638,4262,5060,3661,3678,3578,4125,4354,4827,5392,4086,3438,3675,3716,3858,3740,3856,4431,4244,3806,3993,3831,3583,3810,3653,3458,3569,3866,3401,3056,3759,2689,3598,3161,3441,2587,3227,3024,2823,2903,2517,3447,5160,4342,3190,2822,4005,3353,3113,3814,2741,2944,3498,2916,3418,2780,2491,3497,2857,3225,2960,2517,4380,2934,3485,2724,5169,2606,2517,3038,2264,3112,2986,2779,2947,2360,2290,2619,2791,3237,3148,2348,2423,2619,2745,2822,2419,2661,3892,2622,2572,2650,2275,2997,2438,2123,2632,1527,2359,3087,2650,2461,2393,2275,2617,2281,3017,2545,2042,2063,2475,2117,2272,2261,3456,2286,1972,2405,2156,2783,2414,2476,2084,2336,2797,2322,2483,2168,1542,1973,2308,1196,2093,2627,1923,2198,3196,2093,2070,1929,2449,2265,2824,2106,2222,2045,1881,1910,2042,2425,2294,1916,2227,2714,1747,2095,2312,1540,1806,1971,1836,2165,2013,2059,2472,1878,1917,1922,1756,1753,1873,1838,2060,2112,1326,1598,1986,2446,1882,1553,1711,1877,1959,1671,1985,1951,1930,1423,1843,1475,3524,1659,1816,1687,2511,1736,2140,1816,1587,1555,2798,1364,1873,1711,3261,1772,1474,1783,1723,1228,2062,1568,2184,1595,1699,1700,1141,1761,1397,1791,1876,1691,1706,1674,1211,1655,1853,1411,1670,1954,1407,2737,1323,1857,1647],["W","NC","S","W","W","NE","W","NC","S","S","NE","W","W","W","NC","NE","NE","NE","NE","W","S","S","W","S","NC","W","NC","NC","NE","NC","NC","NE","NC","S","NE","S","W","S","NE","S","NE","S","NE","W","NC","NC","NE","S","W","S","S","W","W","NC","NE","NE","S","NE","S","S","NE","NE","W","W","W","S","NE","S","W","S","NC","NE","S","S","NE","S","W","W","S","NC","NE","NE","NE","S","W","NE","NC","NC","S","S","NE","S","NE","NC","S","NE","NC","W","W","NC","NE","W","W","NC","NE","NE","S","S","NE","W","NE","NE","NC","S","S","NE","NE","NC","S","NC","S","W","NC","NE","S","W","W","S","S","S","NE","S","W","NE","W","NC","NC","W","NC","W","NC","S","S","S","W","NE","NE","NE","S","S","NE","NE","S","NC","W","W","NE","NC","NC","S","NE","NC","S","NE","S","S","S","NC","W","NC","S","W","S","NE","NC","S","S","NC","S","NE","W","NC","S","W","NC","S","S","S","NE","NE","W","S","NC","NE","NC","S","NE","NC","NE","NE","NE","S","S","W","NE","W","NE","W","W","NC","S","S","S","W","NE","NC","S","NE","NE","S","W","S","S","NC","NC","NC","NE","NC","S","S","NC","S","W","NE","NC","NE","S","NC","S","S","S","W","S","S","W","W","NC","S","NE","W","NE","NC","NC","S","S","W","S","S","S","NE","S","W","NC","S","NC","S","S","NE","NC","W","NC","S","S","S","S","S","NE","NC","S","NE","NE","NC","NC","W","NE","NC","NC","W","NC","NE","NC","NE","S","S","NE","S","S","S","S","NC","S","S","S","NC","NE","NC","NC","W","NE","NE","W","NC","NC","NE","S","S","S","S","S","NE","NC","S","S","NE","W","NC","NC","S","NC","NE","NE","NC","NC","W","S","NC","S","W","NE","S","S","NE","NC","NC","NE","NC","NC","NE","NC","NC","W","S","S","NC","W","NC","NE","NC","S","W","S","NC","S","NE","NE","NE","S","W","S","NE","NC","S","W","S","NC","NE","S","S","NC","W","S","NE","NC","NC","S","S","NE","W","S","NC","W","NC","NE","NC","S","S","NE","S","NE","W","S","NE","NC","W","NC","NC","NC","S","S","NE","S","W","NC","NC","W","S","S","NC","NC","S","NE","S","S","S","NE","NC","NC","S","NC","S","NC","NE","W","NC","S","S","S","S","W","S"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>county<\/th>\n      <th>state<\/th>\n      <th>land_area<\/th>\n      <th>population<\/th>\n      <th>pop_18_to_34<\/th>\n      <th>pop_65<\/th>\n      <th>number_physicians<\/th>\n      <th>number_hospital_beds<\/th>\n      <th>total_serious_crimes<\/th>\n      <th>high_school_grads<\/th>\n      <th>bachelor_degrees<\/th>\n      <th>poverty_rate<\/th>\n      <th>unemployment_rate<\/th>\n      <th>per_capita_income<\/th>\n      <th>total_personal_income<\/th>\n      <th>region<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":300,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
xyplot(number_physicians ~ number_hospital_beds, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-87-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
mod_physician_beds = lm(number_physicians ~ number_hospital_beds, data=cdi)
out = MASS::boxcox(mod_physician_beds)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-88-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
range(out$x[out$y &gt; max(out$y)-qchisq(0.95,1)/2])
```

```
## [1] 0.1818182 0.3838384
```

---


```r
xyplot(I(number_physicians^(.25)) ~ number_hospital_beds, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-89-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
xyplot(I(number_physicians^(.25)) ~ I(number_hospital_beds^(.25)), data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-90-1.png" width="504" style="display: block; margin: auto;" /&gt;



---
### CDI: Transformations - physicians vs population 

.pull-left[

```r
xyplot(number_physicians ~ population, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-91-1.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
out = MASS::boxcox(lm(number_physicians ~ population, data=cdi))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-92-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
range(out$x[out$y &gt; max(out$y)-qchisq(0.95,1)/2])
```

```
## [1] -0.02020202  0.14141414
```
]

---


```r
xyplot(log(number_physicians) ~ population, data=cdi,  type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-93-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
xyplot(log(number_physicians) ~ log(population), data=cdi,  type=c("p", "r"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-93-2.png" width="504" style="display: block; margin: auto;" /&gt;


---


```r
mod_physician_pop = lm(number_physicians ~ population, data=cdi)
msummary(mod_physician_pop)
```

```
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.106e+02  3.475e+01  -3.184  0.00156 ** 
## population   2.795e-03  4.837e-05  57.793  &lt; 2e-16 ***
## 
## Residual standard error: 610.1 on 438 degrees of freedom
## Multiple R-squared:  0.8841,	Adjusted R-squared:  0.8838 
## F-statistic:  3340 on 1 and 438 DF,  p-value: &lt; 2.2e-16
```

```r
mod_physician_pop_loglog = lm(I(log(number_physicians)) ~ I(log(population)), data=cdi)
msummary(mod_physician_pop_loglog)
```

```
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        -10.06656    0.38025  -26.47   &lt;2e-16 ***
## I(log(population))   1.29996    0.03042   42.74   &lt;2e-16 ***
## 
## Residual standard error: 0.5037 on 438 degrees of freedom
## Multiple R-squared:  0.8066,	Adjusted R-squared:  0.8061 
## F-statistic:  1826 on 1 and 438 DF,  p-value: &lt; 2.2e-16
```

&lt;!-- Every time x increases exp(D) fold, Y increases exp(\beta * D) fold.  --&gt;


---


```r
plot(cdi$population, cdi$number_physicians)
abline(mod_physician_pop, col="red", lwd=3)
lines(exp(mod_physician_pop_loglog$model[,2]), exp(predict(mod_physician_pop_loglog)), col="blue", lwd=3)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-96-1.png" width="504" style="display: block; margin: auto;" /&gt;



---
layout: false


### 3.10: Exploration of Shape of Regression Function

**Lowess Method**:

* *LOcally WEighted Scatterplot Smoothing*
*  It obtains a smoothed curve by fitting successive linear regression functions in local neighborhoods.

--

* Smoothed curves, such as the lowess curve, do not provide an analytical expression for the functional form of the regression relationship. They only suggest the shape of the regression curve
* If the smoothed curve falls within the confidence band for the regression line, then it supports the appropriateness of the regression function.

---

layout: true
class: inverse

---

### SHS: Lowess Smoothing Curve


Income and Clothing Expenditure for a small subset of the Survey of Household Spending are displayed below:
 

```r
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-98-1.png" width="504" style="display: block; margin: auto;" /&gt;


---


```r
clothing_model = lm(clothing_expenditure~income, data=spending_subset)
x_values= c(5000:100000)
clothing_band = ALSM::ci.reg(clothing_model, newdata=data.frame(infection_risk=x_values), type="w", alpha=.05)
scatter.smooth(spending_subset$income, spending_subset$clothing_expenditure)
lines(clothing_band$income, clothing_band$Lower.Band, lty=2, col="blue")
lines(clothing_band$income, clothing_band$Upper.Band, lty=2, col="blue")
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-99-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
x_values= c(5000:100000)
clothing_model_25 = lm(I(clothing_expenditure^(.25))~income, data=spending_subset)
clothing_band_25 = ALSM::ci.reg(clothing_model_25, newdata=data.frame(infection_risk=x_values), type="w", alpha=.05)
scatter.smooth(spending_subset$income, I(spending_subset$clothing_expenditure^(.25)))
lines(clothing_band_25$income, clothing_band_25$Lower.Band, lty=2, col="blue")
lines(clothing_band_25$income, clothing_band_25$Upper.Band, lty=2, col="blue")
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-100-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

### CDI: Transformations - physicians vs population 

.pull-left[

```r
x_values= seq(0,8000000, 1000)
mod_physician_pop = lm(number_physicians ~ population, data=cdi)
pop_band = ALSM::ci.reg(mod_physician_pop, newdata=data.frame(infection_risk=x_values), type="w", alpha=.05)
scatter.smooth(cdi$population, cdi$number_physicians)
lines(pop_band$population, pop_band$Lower.Band, lty=2, col="blue")
lines(pop_band$population, pop_band$Upper.Band, lty=2, col="blue")
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-101-1.png" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
x_values= seq(10, 16, out.length=1000); cdi$logpopulation = log(cdi$population)
mod_physician_pop_log = lm(log(number_physicians) ~ logpopulation, data=cdi)
pop_band = ALSM::ci.reg(mod_physician_pop_log, newdata=data.frame(logpopulation=x_values), type="w", alpha=.05)
scatter.smooth(log(cdi$population), log(cdi$number_physicians), lwd=2)
lines(pop_band$logpopulation, pop_band$Lower.Band, lty=2, col="blue", lwd=2)
lines(pop_band$logpopulation, pop_band$Upper.Band, lty=2, col="blue", lwd=2)
```

&lt;img src="chapter3_files/figure-html/unnamed-chunk-102-1.png" width="504" style="display: block; margin: auto;" /&gt;
]


---
layout: false


### Recap: Sections 3.8-3.10

After Sections 3.8-3.10, you should be able to 

-	Understand the utility of transformations and when they could be applied.
- Assess the shape of the regression function using smoothed curves. 


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
