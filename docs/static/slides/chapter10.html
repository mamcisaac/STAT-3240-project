<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Chapter 10: Building the Regression Model II: Diagnostics</title>
    <meta charset="utf-8" />
    <meta name="author" content="Michael McIsaac" />
    <script src="chapter10_files/header-attrs/header-attrs.js"></script>
    <script src="chapter10_files/htmlwidgets/htmlwidgets.js"></script>
    <link href="chapter10_files/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="chapter10_files/datatables-binding/datatables.js"></script>
    <script src="chapter10_files/jquery/jquery-3.6.0.min.js"></script>
    <link href="chapter10_files/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="chapter10_files/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="chapter10_files/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="chapter10_files/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="chapter10_files/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Chapter 10: Building the Regression Model II: Diagnostics
]
.subtitle[
## STAT 3240
]
.author[
### Michael McIsaac
]
.institute[
### UPEI
]

---










### Learning Objectives for Sections 10.1-10.2

After Sections 10.1-10.2, you should be able to 

- Create and analyze added-variable plots to examine model adequacy  
- Define studentized deleted residuals and use them to examine model adequacy  


---

### 10.1: Model Adequacy for a Predictor Variable `\(-\)` Added-Variable Plots

*Added-variable plots*, also called *partial regression plots* and *adjusted variable plots*, are refined residual plots that provide graphic information about the marginal importance of a predictor variable `\(X_k\)`, given the other predictor variables already in the model.


---

Recall the following from Chapter 7:

Consider a multiple regression model with two `\(X\)` variables. Suppose we regress `\(Y\)` on `\(X_2\)` and obtain the residuals:
`$$e(Y|X_2) = Y_i - \hat{Y}_i(X_2)$$`
where `\(\hat{Y}_i(X_2)\)` denotes the fitted values of `\(Y\)` when `\(X_2\)` is in the model.  

Suppose we further regress `\(X_1\)` on `\(X_2\)` and obtain the residuals:
`$$e(X_1|X_2) = X_{i1} - \hat{X}_{i1}(X_2)$$`
where `\(\hat{X}_{i1}(X_2)\)` denotes the fitted values of `\(X_1\)` 	in the regression of `\(X_1\)` on `\(X_2\)`.  


* The coefficient of simple determination `\(R^2\)` between these two sets of residuals equals the coefficient of partial determination `\(R_{Y 1 | 2}\)`

* The plot of the residuals `\(e(Y|X_2)\)` against `\(e(X_1|X_2)\)` provides a graphical representation of the strength of the relationship between `\(Y\)` and `\(X_1\)`, adjusted for `\(X_2\)`. Such plots of residuals are called added variable plots or partial regression plots.


---


These plots are analogous to the scatterplots for simple linear regression; the residuals displayed in added-variable plots are exactly the residuals from the multiple regression.

These plots are useful for identifying

* outliers
* non-constant variance
* influential points
* non-linearity

In addition, these plots can at times be useful for identifying the nature of the marginal relation for a predictor variable in the regression model, though we need to recognize that the `\(X\)`-axis is not displaying the `\(X\)` variable (so we may be able to identify a non-linear relationship, but probably not what the functional relationship actually is).



&lt;!-- A lot of the value of an added variable plot comes at the regression diagnostic stage, especially since the residuals in the added variable plot are precisely the residuals from the original multiple regression. This means outliers and heteroskedasticity can be identified in a similar way to when looking at the plot of a simple rather than multiple regression model. Influential points can also be seen - this is useful in multiple regression since some influential points are not obvious in the original data before you take the other variables into account.   --&gt;


---


```r
fit &lt;- lm(insurance ~ ., life_insurance)

life_insurance %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0291eb92b1947edb0d2d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0291eb92b1947edb0d2d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18"],[45.01,57.204,26.852,66.29000000000001,40.964,72.996,79.38,52.766,55.916,38.122,35.84,75.79600000000001,37.408,54.376,46.186,46.13,30.366,39.06],[6,4,5,7,5,10,1,8,6,4,6,9,5,2,7,4,3,5],[91,162,11,240,73,311,316,154,164,54,53,326,55,130,112,91,14,63]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>income<\/th>\n      <th>risk_aversion<\/th>\n      <th>insurance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
A &lt;- resid(lm(insurance ~ risk_aversion, life_insurance))
B &lt;- resid(lm(income ~ risk_aversion, life_insurance))
par(mfrow = c(1, 2), pch = 19)

plot(resid(fit) ~ income, life_insurance, xlab = "income", ylab = "Residual")
title("(a) Residual Plot against income")
abline(0, 0, lty = 2)

plot(A ~ B, xlab = "e(X1|X2)", ylab = "e(Y|X2)")
title("(b) Added-Variable Plot for income")
abline(lm(A ~ B))
abline(0, 0, lty = 2)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-2-1.png" width="504" style="display: block; margin: auto;" /&gt;
&lt;!-- replicating 10.3 from book as per https://rpubs.com/bryangoodrich/5224 (highlighting that we are finding residuals and then regressing them). --&gt;
&lt;!-- Comment that apparent non-linearity is not a big problem marginally (that, after accounting for X1, adding a curvilinear component to x2 won't improve things much), and highlight the potentially-influential point at the top right --&gt;

---

```r
avPlots(fit)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-3-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
msummary(fit)
```

```
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   -205.719     11.393  -18.06  1.4e-11
## income           6.288      0.204   30.80  5.6e-15
## risk_aversion    4.738      1.378    3.44   0.0037
## 
## Residual standard error: 12.7 on 15 degrees of freedom
## Multiple R-squared:  0.986,	Adjusted R-squared:  0.985 
## F-statistic:  542 on 2 and 15 DF,  p-value: 1.03e-14
```

--


```r
msummary(lm(insurance ~ risk_aversion + income+I(income^2), life_insurance))
```

```
##                Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   -73.46051    6.67743  -11.00  2.8e-08
## risk_aversion   5.40039    0.25399   21.26  4.7e-12
## income          0.79596    0.26607    2.99   0.0097
## I(income^2)     0.05087    0.00244   20.85  6.1e-12
## 
## Residual standard error: 2.32 on 14 degrees of freedom
## Multiple R-squared:     1,	Adjusted R-squared:  0.999 
## F-statistic: 1.1e+04 on 3 and 14 DF,  p-value: &lt;2e-16
```

---
layout: true
class: inverse
---


```r
clothing_model = lm(clothing_expenditure~income+sex+food_expenditure+recreation_expenditure+ miscellaneous_expenditure+I(marital_status=="married"), data=spending_subset)
msummary(clothing_model)
```

```
##                                     Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                         1.82e+02   2.34e+02    0.78  0.43728
## income                              1.65e-02   4.05e-03    4.07  5.5e-05
## sexmale                            -5.17e+02   1.41e+02   -3.66  0.00028
## food_expenditure                    1.34e-01   2.57e-02    5.21  2.8e-07
## recreation_expenditure              2.19e-01   3.38e-02    6.47  2.3e-10
## miscellaneous_expenditure           1.26e-01   1.39e-01    0.91  0.36350
## I(marital_status == "married")TRUE  3.40e+02   1.59e+02    2.13  0.03340
## 
## Residual standard error: 1480 on 493 degrees of freedom
## Multiple R-squared:  0.244,	Adjusted R-squared:  0.235 
## F-statistic: 26.5 on 6 and 493 DF,  p-value: &lt;2e-16
```

---
&lt;img src="chapter10_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---
&lt;img src="chapter10_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---
layout: false

### 10.2: Identifyiug Outlying `\(Y\)` Observations - Studentized Deleted Residuals


&lt;img src="img/Figure10p5.png" width="90%" style="display: block; margin: auto;" /&gt;

---

* Case 1 may not be too influential because a number of other cases have similar `\(X\)` values that will keep the fitted regression function from being displaced too far by the outlying case. 

* Case 2 may not be too influential because its `\(Y\)` value is consistent with the regression relation displayed by the nonextreme cases. 

* Cases 3 and 4, on the other hand, are likely to be very influential in affecting the fit of the regression function. They are outlying with regard to their `\(X\)` values, and their `\(Y\)` values are not consistent with the regression relation for the other cases.

--

Some univariate outliers may not be extreme in a multiple regression model, and, conversely, some multivariable outliers may not be detectable in single-variable or two-variable analyses

---

### Residuals and Semistudentized Residuals


The detection of outlying or extreme `\(Y\)` observations based on an examination of the residual has been considered in earlier chapters. We utilized there either the residual 
`$$e_i = Y_i - \hat Y_i$$`
or the semistudentized residuals 
`$$e_i^\ast = \frac{e_i}{\sqrt{MSE}}$$`

--

Large residuals give evidence of outlying `\(Y\)` observations. 

Semistudentized residuals made it easier to determine which residuals were "large".
However, the (semistudentized) residuals actually have different variances, so the cutoffs for being "large" should differ.

---
Recall that `\(\hat{\mathbb{Y}} = \mathbb{H} \mathbb{Y}\)` where
`$${\mathbb{H}} = {\mathbb{X}} \  (\mathbb{X}' \mathbb{X})^{-1} \mathbb{X}',$$`

so 
`$$\mathbb{e} = \mathbb{(I - H) Y},$$`
and
`$$\sigma^2\{\mathbb{e}\} = \sigma^2 \mathbb{(I - H)}.$$`

---

Therefore, the variance of residual `\(e_i\)` is determined by `\(h_{ii}\)`, the `\(i\)`th element on the diagonal of `\(\mathbb{H}\)`:
`$$\sigma^2\{e_i\} = \sigma^2 (1 - h_{ii}).$$`

&lt;!-- Similarly, the covariance of residuals is based on `\(h_{ij}\)`, the element in the `\(i\)`th row and `\(j\)`th column of `\(\mathbb{H}\)`: --&gt;
&lt;!-- `$$\sigma\{e_i, e_j\} = \sigma^2 (0 - h_{ij}) = - h_{ij} \sigma^2, \qquad i \neq j.$$` --&gt;

&lt;!-- --- --&gt;

Therefore, if we wish to scale the residuals to have constant variance, we can consider internally **studentized residuals**
`$$r_i = \frac{e_i}{s\{e_i\}} = \frac{e_i}{\sqrt{MSE (1 - h_{ii})}}$$`

Large studentized residuals give evidence of outlying `\(Y\)` observations.

---

However, if a point influences the regression function strongly enough, the resulting residual will be small. So we may be better off focusing on **deleted residuals**
`$$d_i = Y_i - \hat{Y}_{i(i)}$$`
where `\(Y_{i(i)}\)` is (as before) the estimated expected value at `\(X_i\)` found using a model built using all sample data *except* for the point `\((x_i, y_i)\)`. 

--

It turns out that we don't actually need to fit `\(n\)` different regression models to get the `\(n\)` deleted residuals because
`$$d_i = \frac{e_i}{1-h_{ii}}$$`

Notice that `\(h_{ii}\)` tells us how different the residual `\(e_i\)` and deleted residual `\(d_i\)` will be: they would be the same if `\(h_{ii}=0\)`; `\(d_i\)` will be much more extreme if `\(h_{ii}\)` is close to 1 (note that `\(0 \leq h_{ii} \leq 1)\)`.



---

Notice that a deleted residual is the prediction error for an observation that was not used to build the model, so we know the variance is 
`$$s^2\{d_i\} = MSE_{(i)} (1 + {X}_i'(\mathbb{X}_{(i)}'\mathbb{X}_{(i)})^{-1}X_i),$$`
where 

* `\({X}_i\)` is the design matrix row corresponding to individual `\(i\)`, 
* `\(\mathbb{X}_{(i)}\)` is the design matrix with row `\(i\)` deleted, and 
* `\(MSE_{(i)}\)` is the mean square error when the `\(i\)`th case is omitted in fitting the regression function

--

Therefore

`$$\frac{d_i}{s\{ d_i \}} \sim t_{n-p-1}$$`
`\((n-1\)` cases are used to estimate the `\(p\)` parameters here, hence the degrees of freedom).

--

Note that, again, it turns out that we can compute this standard error more easily:
`$$s^2\{d_i\} = \frac{MSE_{(i)}}{1- h_{ii}}.$$`

---

### Studentized Deleted Residuals

The **Studentized Deleted Residual** is (or *externally studentized residual*)
`$$t_i = \frac{d_i}{s\{ d_i \}} = \frac{e_i/(1-h_{ii})}{\sqrt{MSE_{(i)} /(1-h_{ii})}} = \frac{e_i}{\sqrt{MSE_{(i)}(1-h_{ii})}}$$`
and follows a `\(t\)` distribution with `\(n-p-1\)` degrees of freedom if the model assumptions hold. 

So, if any of the `\(t_i, i=1, \ldots, n\)` exceeds `\(t(1 - \alpha/(2 n); n -p-1)\)` in absolute value, then it is an outlier and may be unduly influencing the regression fit. This is a conservative test; often people consider any point with `\(|t_i| &gt; 3\)` to be an outlier.

---

The **Studentized Deleted Residual** is (or *externally studentized residual*)
`$$t_i = \frac{d_i}{s\{ d_i \}} = \frac{e_i/(1-h_{ii})}{\sqrt{MSE_{(i)} /(1-h_{ii})}} = \frac{e_i}{\sqrt{MSE_{(i)}(1-h_{ii})}}$$`

The internally **studentized residual** is
`$$r_i = \frac{e_i}{s\{e_i\}} = \frac{e_i}{\sqrt{MSE (1 - h_{ii})}}$$`
--
Again, we don't actually need to refit the model `\(n\)` times to find these studentized deleted residuals because
`$$MSE_{(i)} = \frac{(n-p) MSE - e_i^2/(1-h_{ii})}{(n-p-1)}$$`
so 
`$$t_i = e_i \left[\frac{n-p-1}{SSE(1-h_{ii}) - e_i^2} \right]^{1/2}$$`
---


```r
insurance_model = lm(insurance ~ risk_aversion + income, life_insurance)
olsrr::ols_plot_resid_stud(insurance_model)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-10-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
qt(1-.05/(2*dim(life_insurance)[1]), df=insurance_model$df.residual-1)
```

```
## [1] 3.621
```

---


```r
insurance_model = lm(insurance ~ risk_aversion + income+I(income^2), life_insurance)
olsrr::ols_plot_resid_stud(insurance_model)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-11-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
qt(1-.05/(2*dim(life_insurance)[1]), df=insurance_model$df.residual-1)
```

```
## [1] 3.679
```

---


```r
avPlots(insurance_model)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-12-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

```r
life_insurance %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6c5e69a7e35140ce5080" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6c5e69a7e35140ce5080">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18"],[45.01,57.204,26.852,66.29000000000001,40.964,72.996,79.38,52.766,55.916,38.122,35.84,75.79600000000001,37.408,54.376,46.186,46.13,30.366,39.06],[6,4,5,7,5,10,1,8,6,4,6,9,5,2,7,4,3,5],[91,162,11,240,73,311,316,154,164,54,53,326,55,130,112,91,14,63]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>income<\/th>\n      <th>risk_aversion<\/th>\n      <th>insurance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---



.center[
![insurance.gif](/Users/michaelmcisaac/Dropbox/GitHub/STAT-3240/src/img/insurance.gif)
]

---


```r
insurance_model = lm(insurance ~ risk_aversion* income*I(income^2)*I(risk_aversion^2), life_insurance)
rstandard(insurance_model)
```

```
##        1        2        3        4        5        6        7        8 
## -1.39872 -1.40303 -1.36129  1.39845 -0.89981  1.39856  1.39883 -1.39771 
##        9       10       11       12       13       14       15       16 
##  1.37670 -1.39829 -1.39822 -1.39851  1.23757 -1.38652  1.39832  1.39778 
##       17       18 
##  1.39843  0.04562
```

```r
olsrr::ols_plot_resid_stud(insurance_model)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-15-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
qt(1-.05/(2*dim(life_insurance)[1]), df=insurance_model$df.residual-1)
```

```
## [1] 229.2
```

---
layout: true
class: inverse
---



```r
clothing_model = lm(clothing_expenditure~income+marital_status + age_group + sex + food_expenditure + transportation_expenditure + personal_care_expenditure + recreation_expenditure + tobacco_alcohol_expenditure + miscellaneous_expenditure + total_consumption_expenditure + total_expenditure + weeks_worked + type_of_dwelling, data=spending_subset)

anova(clothing_model) 
```

```
## Analysis of Variance Table
## 
## Response: clothing_expenditure
##                                 Df   Sum Sq  Mean Sq F value  Pr(&gt;F)
## income                           1 2.95e+08 2.95e+08  168.64 &lt; 2e-16
## marital_status                   2 3.86e+08 1.93e+08  110.35 &lt; 2e-16
## age_group                       12 1.04e+08 8.66e+06    4.95 3.5e-08
## sex                              1 1.31e+08 1.31e+08   75.12 &lt; 2e-16
## food_expenditure                 1 5.38e+08 5.38e+08  307.16 &lt; 2e-16
## transportation_expenditure       1 1.40e+07 1.40e+07    7.99  0.0047
## personal_care_expenditure        1 1.40e+09 1.40e+09  798.36 &lt; 2e-16
## recreation_expenditure           1 1.94e+08 1.94e+08  110.81 &lt; 2e-16
## tobacco_alcohol_expenditure      1 2.25e+06 2.25e+06    1.29  0.2570
## miscellaneous_expenditure        1 3.48e+06 3.48e+06    1.99  0.1586
## total_consumption_expenditure    1 2.72e+08 2.72e+08  155.57 &lt; 2e-16
## total_expenditure                1 1.57e+06 1.57e+06    0.90  0.3441
## weeks_worked                     1 4.30e+05 4.30e+05    0.25  0.6204
## type_of_dwelling                 5 4.70e+07 9.41e+06    5.38 6.3e-05
## Residuals                     3316 5.80e+09 1.75e+06
```

---


```r
car::avPlots(clothing_model, layout=c(3,5), ask = F)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" /&gt;&lt;img src="chapter10_files/figure-html/unnamed-chunk-18-2.png" width="100%" style="display: block; margin: auto;" /&gt;

---


```r
olsrr::ols_plot_resid_stud(clothing_model)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-19-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
qt(1-.05/(2*dim(spending_subset)[1]), df=clothing_model$df.residual-1)
```

```
## [1] 4.336
```

---


layout:false

### Recap Sections 10.1-10.2

After Sections 10.1-10.2, you should be able to 

- Create and analyze added-variable plots to examine model adequacy  
- Define studentized deleted residuals and use them to examine model adequacy  


---

### Learning Objectives for Sections 10.3-10.4

After Sections 10.3-10.4, you should be able to 

- Define leverage and use it to examine model adequacy  
-	Define influential observations and use DFFITS, Cookâ€™s, and DFBETAS to examine model adequacy  


---
### 10.3: Identifying Outlying `\(X\)` Observations `\(-\)` Hat Matrix Leverage Values

Recall that the variance of residual `\(e_i\)` is determined by `\(h_{ii}\)`, the `\(i\)`th element on the diagonal of `\(\mathbb{H}= {\mathbb{X}} \  (\mathbb{X}' \mathbb{X})^{-1} \mathbb{X}'\)`:
`$$\sigma^2\{e_i\} = \sigma^2 (1 - h_{ii}).$$`
`$$0 \leq h_{ii} \leq 1 \qquad \qquad \sum_{i=1}^n h_{ii} =p$$`

* The **Studentized Deleted Residual** is (or *externally studentized residual*)
`$$t_i = \frac{d_i}{s\{ d_i \}} = \frac{e_i/(1-h_{ii})}{\sqrt{MSE_{(i)} /(1-h_{ii})}} = \frac{e_i}{\sqrt{MSE_{(i)}(1-h_{ii})}}$$`

* The internally **studentized residual** is
`$$r_i = \frac{e_i}{s\{e_i\}} = \frac{e_i}{\sqrt{MSE (1 - h_{ii})}}$$`

---


1. `\(h_{ii}\)` is a function of only the `\(X\)` values

2. The fitted value `\(Y_i\)` is a linear combination of the observed `\(Y\)` values, and `\(h_{ii}\)` is the weight of observation `\(Y_i\)` in determining this fitted value. 
  + the larger `\(h_{ii}\)` the more important is `\(Y_i\)` in determining `\(\hat Y_i\)`

3. The larger `\(h_{ii}\)`, the smaller is the variance of the residual `\(e_i\)`
  + Hence, the larger `\(h_{ii}\)`, the closer the fitted value `\(\hat Y_i\)` will tend to be to the observed value `\(Y_i\)`
  + In the extreme case where `\(h_{ii} = 1\)`, `\(\sigma^2\{e_i\}= 0\)`, so the fitted value `\(\hat Y_i\)` is then forced to equal the observed value `\(Y_i.\)`

---

&lt;img src="img/Figure10p6.png" width="90%" style="display: block; margin: auto;" /&gt;

---

A leverage value `\(h_{ii}\)` is usually considered to be large if it is more than twice as large as the mean leverage value; i.e., if
`$$h_{ii} &gt; 2 \bar{h} = 2 \frac{\sum_{i=1}^n h_{ii}}{n} = 2 \frac{p}{n}$$`

Other suggested guidelines are 
`$$h_{ii} &gt; 0.5$$`
or
`$$h_{ii} &gt; 0.2$$`

---

### Use of Hat Matrix to Identify Hidden Extrapolation

To spot hidden extrapolations in settings with many predictor variables, we can utilize the direct leverage calculation for the new set of predictor values, `\(\mathbb{X}_{new}\)` for which inferences are to be made:

`$$h_{new, new} = \mathbb{X}'_{new} (\mathbb{X}'\mathbb{X})^{-1} \mathbb{X}_{new}$$`

If `\(h_{new, new}\)` is within the range of leverage values `\(h_{ii}\)` for the cases in the data set, no extrapolation is involved. 

On the other hand, if `\(h_{new, new}\)` is much larger than the leverage values for the cases in the data set, an extrapolation is indicated.

---

layout: true
class: inverse

---



```r
clothing_model = lm(clothing_expenditure~income+marital_status +sex + personal_care_expenditure, data=spending_subset[1:30,])

clothing_data = data.frame(resid=resid(clothing_model), rstandard = rstandard(clothing_model), rstudent= rstudent(clothing_model), hatvalues=hatvalues(clothing_model)) %&gt;% round(3) 

cbind(clothing_data, high_leverage = hatvalues(clothing_model)&gt;2*mean(hatvalues(clothing_model))) %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-681a2d19cc0bd15f76fb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-681a2d19cc0bd15f76fb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],[1330.969,-134.335,144.344,888.622,-646.4829999999999,1037.763,434.59,-1217.96,-611.627,-2054.787,-824.9,-1050.705,482.594,-1538.257,-1064.56,27.732,4766.948,418.103,33.461,965.623,-866.921,580.442,3897.645,975.527,-871.294,492.635,-857.653,-1332.137,-2172.164,-1233.215],[0.888,-0.09,0.093,0.579,-0.432,0.704,0.291,-0.841,-0.411,-1.448,-0.539,-0.714,0.322,-1.01,-0.6860000000000001,0.018,3.327,0.283,0.024,0.647,-0.5639999999999999,0.379,2.57,0.641,-0.636,0.329,-0.609,-0.925,-1.43,-0.8],[0.884,-0.08799999999999999,0.091,0.571,-0.425,0.696,0.286,-0.836,-0.403,-1.484,-0.531,-0.707,0.315,-1.01,-0.678,0.018,4.437,0.278,0.023,0.639,-0.556,0.372,2.955,0.633,-0.628,0.323,-0.601,-0.923,-1.464,-0.794],[0.191,0.19,0.135,0.153,0.195,0.218,0.199,0.246,0.202,0.276,0.157,0.221,0.189,0.165,0.134,0.166,0.261,0.216,0.273,0.199,0.149,0.157,0.172,0.165,0.324,0.192,0.287,0.254,0.17,0.144],[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>resid<\/th>\n      <th>rstandard<\/th>\n      <th>rstudent<\/th>\n      <th>hatvalues<\/th>\n      <th>high_leverage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
plot(fitted(clothing_model), rstudent(clothing_model))
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-23-1.png" width="504" style="display: block; margin: auto;" /&gt;

---



```r
plot(fitted(clothing_model), rstandard(clothing_model))
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-24-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
plot(clothing_model, which=5)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-25-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

```r
clothing_model = lm(clothing_expenditure~income+marital_status +sex + personal_care_expenditure, data=spending_subset)

clothing_data = data.frame( resid=resid(clothing_model), rstandard = rstandard(clothing_model), rstudent= rstudent(clothing_model), hatvalues=hatvalues(clothing_model)) %&gt;% round(3) 

cbind(clothing_data, high_leverage = hatvalues(clothing_model)&gt;2*mean(hatvalues(clothing_model))) %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ac066e91d04ccd196835" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac066e91d04ccd196835">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500"],[1369.141,-458.939,-202.458,569.298,-737.072,630.78,793.33,-1174.675,-997.059,-1258.562,-826.259,-1506.295,880.25,-1097.603,-1293.549,-96.069,5644.714,137.291,-222.916,1232.651,-317.969,391.175,3772.911,659.5359999999999,-820.893,132.999,-663.657,-436.681,-2233.883,-1376.297,-1591.952,736.924,1829.48,-115.996,-110.023,-2731.404,-555.41,30.834,-2598.052,716.418,35.754,-370.858,-1067.949,2164.537,4374.597,-401.337,-1627.612,491.316,641.004,-127.346,2450.126,-1136.929,1081.716,-1007.077,-147.761,845.237,129.107,-1221.425,-2151.518,-1638.496,-1174.917,859.172,-510.027,-218.965,1197.056,510.726,-1002.21,-1066.862,-333.999,-84.066,-1074.632,1275.014,-311.761,-94.67100000000001,172.437,-650.7859999999999,-2116.925,-1359.182,-1329.373,-495.143,-120.82,-1371.182,-982.663,-645.963,2266.886,-384.737,-1199.566,400.439,-1349.993,-1708.072,2012.5,1601.265,-1254.387,-175.294,1606.671,-1377.93,-37.952,-1072.688,429.549,1356.378,-1123.874,-290.501,117.305,-351.756,-1466.819,3583.67,1509.202,-219.012,-86.999,-464.253,1302.952,-505.746,-1783.878,-376.837,1351.892,1170.684,-548.23,-185.808,-938.331,-2245.7,579.323,-794.026,2445.112,2703.957,1040.115,359.92,-1416.651,980.809,-368.961,1481.653,1403.279,-528.77,-125.99,-576.2910000000001,3793.085,1540.504,684.773,138.205,5170.409,671.37,5025.522,2260.576,-275.308,-71.56399999999999,573.71,-1254.076,-154.221,513.014,454.676,230.944,1165.281,792.35,1226.778,1227.043,-497.167,-785.473,1272.92,66.82599999999999,543.756,-426.367,-182.323,-863.207,3024.93,-545.051,1924.785,35.581,3042.69,865.395,425.402,-1519.836,103.464,-1531.777,-3435.126,-734.694,1592.274,2592.732,-1491.394,508.655,101.019,-442.242,-256.934,-1962.543,139.46,364.228,-14.426,115.252,-1014.492,-950.3049999999999,360.468,-539.384,701.9589999999999,4743.333,-810.926,-1369.789,-250.464,1570.267,-245.012,1297.988,664.09,-1185.334,-1060.32,1013.406,2003.87,-120.65,-1679.861,-1983.402,-1366.474,-853.08,647.598,-887.345,72.206,-344.575,-476.925,-903.557,-568.4160000000001,-875.736,345.941,2203.269,23.975,-985.8440000000001,1803.647,1871.998,1029.468,-987.7569999999999,1312.289,4028.185,-388.225,2014.34,-783.497,371.108,1633.249,-541.056,-1230.97,-1127.582,533.804,-2073.208,-951.828,-385.486,-25.477,-3167.111,185.678,-801.992,-161.103,768.802,-506.721,-75.935,167.012,930.006,-2217.053,-1092.683,1899.437,3110.96,-705.093,2550.515,-188.5,-136.938,362.02,1952.195,2830.188,580.592,83.31100000000001,12.57,666.293,-746.528,-1286.382,-275.063,142.364,-469.577,-490.366,130.203,2477.407,-760.188,-446.42,1035.607,-1097.861,3306.971,931.249,6543.334,-1926.225,-556.78,-1749.844,-770.982,-1132.751,-653.849,493.202,651.404,-259.795,-2148.583,386.2,-604.888,-1570.644,-780.223,-903.934,-1550.294,-341.946,695.388,-563.593,-1295.972,366.261,495.424,-468.634,1541.264,-1041.752,-555.1319999999999,-15.501,-4.926,577.577,-1186.324,-249.553,16.419,1583.697,484.373,-857.335,1387.249,-1247.916,-1045.443,-903.941,-465.338,-811.975,2196.652,-2226.471,-3.848,-957.798,-626.395,-1146.856,-1241.385,-252.478,-379.906,2871.558,-1825.492,-554.6369999999999,656.514,3018.39,-1437.94,5.52,180.184,-352.051,-640.328,-891.712,-612.016,-1491.89,-54.518,1066.366,-1568.825,-226.023,-560.222,533.061,2308.948,543.186,874.634,-593.95,394.688,-918.828,-342.461,-1982.248,-89.38200000000001,2692.504,-664.694,713.982,2278.386,1650.614,-828.039,961.753,-2335.929,-1152.778,-1408.439,-772.649,-687.995,2804.613,-245.525,-1267.087,-893.3440000000001,4609.093,-1260.567,-253.747,-927.2910000000001,-1932.842,-692.9349999999999,-443.058,-1017.072,-1333.533,-1363.178,3114.11,325.832,1223.621,2483.834,1051.95,-873.789,-1975.885,-783.158,-1714.962,592.2910000000001,1608.365,-169.578,-489.201,-912.808,-917.2140000000001,27.446,-880.715,-388.392,-1143.531,-21.111,1475.596,21.569,1157.014,-93.102,6.112,-644.567,193.181,79.10299999999999,-1930.274,5341.049,24.483,4843.529,1346.71,-342.471,-667.004,1111.173,1642.419,-615.626,-1182.933,1738.893,2262.363,-452.489,-331.309,841.501,-39.206,-1027.71,-846.778,-1563.367,-289.463,5465.533,4633.422,-517.4589999999999,718.183,203.51,-1287.077,-1288.165,292.351,2130.955,1363.605,-28.984,-1210.081,-3306.881,-1127.854,52.576,-310.523,-1077.498,-808.42,-356.262,-912.756,54.168,48.872,-682.623,-1239.862,-193.267,-2790.411,913.102,-2960.244,-691.79,389.409,-902.64,84.35899999999999,-2433.541,-1138.274,-600.5,135.601,-1240.23,-542.741,143.078,431.833,-427.915,59.43,-758.572,-966.826,-301.305,-758.351,-150.142,-1150.419,-934.162,2086.789,-95.499,25.835,-710.167,205.239,3334.229,-1049.734,-1379.454,578.659,-1364.49,-1637.391,-808.662,1164.142,-831.55,1309.563,-3118.753,-621.592,-2217.166,-1697.343,-627.514],[0.947,-0.317,-0.139,0.393,-0.507,0.434,0.547,-0.8090000000000001,-0.6879999999999999,-0.871,-0.569,-1.043,0.608,-0.757,-0.892,-0.066,3.913,0.094,-0.154,0.852,-0.219,0.27,2.596,0.453,-0.5659999999999999,0.091,-0.46,-0.303,-1.536,-0.946,-1.098,0.509,1.263,-0.08,-0.076,-1.893,-0.385,0.021,-1.788,0.495,0.025,-0.255,-0.735,1.49,3.01,-0.277,-1.123,0.337,0.441,-0.08799999999999999,1.684,-0.781,0.746,-0.694,-0.102,0.581,0.089,-0.838,-1.479,-1.125,-0.8070000000000001,0.59,-0.351,-0.151,0.823,0.353,-0.6879999999999999,-0.735,-0.23,-0.058,-0.742,0.876,-0.215,-0.066,0.119,-0.449,-1.456,-0.9330000000000001,-0.922,-0.34,-0.083,-0.9429999999999999,-0.675,-0.444,1.564,-0.265,-0.825,0.28,-0.93,-1.173,1.388,1.104,-0.864,-0.12,1.112,-0.946,-0.026,-0.74,0.296,0.9320000000000001,-0.772,-0.2,0.081,-0.243,-1.007,2.469,1.036,-0.151,-0.06,-0.32,0.9,-0.348,-1.231,-0.259,0.9320000000000001,0.8070000000000001,-0.379,-0.128,-0.648,-1.544,0.4,-0.548,1.684,1.856,0.718,0.247,-0.977,0.674,-0.253,1.021,0.968,-0.365,-0.08699999999999999,-0.397,2.608,1.058,0.471,0.095,3.578,0.461,3.455,1.554,-0.19,-0.049,0.394,-0.864,-0.107,0.353,0.312,0.159,0.801,0.546,0.845,0.847,-0.342,-0.542,0.874,0.046,0.374,-0.295,-0.126,-0.593,2.079,-0.374,1.322,0.024,2.09,0.597,0.292,-1.044,0.07099999999999999,-1.055,-2.389,-0.505,1.096,1.785,-1.024,0.35,0.07000000000000001,-0.305,-0.177,-1.349,0.096,0.252,-0.01,0.079,-0.697,-0.654,0.248,-0.371,0.483,3.26,-0.5570000000000001,-0.947,-0.172,1.081,-0.169,0.897,0.458,-0.8149999999999999,-0.734,0.696,1.376,-0.083,-1.164,-1.369,-0.95,-0.586,0.445,-0.612,0.05,-0.237,-0.328,-0.621,-0.391,-0.601,0.238,1.524,0.017,-0.679,1.239,1.286,0.707,-0.679,0.902,2.782,-0.268,1.387,-0.538,0.255,1.122,-0.372,-0.85,-0.777,0.367,-1.429,-0.653,-0.265,-0.017,-2.189,0.128,-0.552,-0.111,0.529,-0.35,-0.052,0.115,0.641,-1.552,-0.755,1.313,2.145,-0.485,1.766,-0.13,-0.094,0.25,1.342,1.944,0.4,0.058,0.008999999999999999,0.46,-0.517,-0.883,-0.19,0.098,-0.325,-0.339,0.09,1.703,-0.527,-0.308,0.712,-0.758,2.276,0.64,4.495,-1.325,-0.384,-1.207,-0.53,-0.78,-0.45,0.342,0.452,-0.18,-1.491,0.265,-0.417,-1.086,-0.536,-0.624,-1.068,-0.235,0.478,-0.387,-0.892,0.252,0.341,-0.324,1.06,-0.717,-0.382,-0.011,-0.003,0.397,-0.8149999999999999,-0.172,0.011,1.087,0.334,-0.589,0.955,-0.872,-0.722,-0.622,-0.321,-0.5620000000000001,1.518,-1.532,-0.003,-0.658,-0.432,-0.79,-0.852,-0.174,-0.262,2.002,-1.253,-0.382,0.453,2.075,-0.988,0.004,0.124,-0.242,-0.441,-0.615,-0.421,-1.03,-0.037,0.732,-1.077,-0.156,-0.385,0.367,1.587,0.373,0.601,-0.409,0.273,-0.634,-0.236,-1.363,-0.061,1.855,-0.459,0.497,1.576,1.14,-0.5679999999999999,0.662,-1.625,-0.796,-0.968,-0.533,-0.473,1.943,-0.169,-0.878,-0.616,3.177,-0.866,-0.175,-0.639,-1.329,-0.477,-0.306,-0.7,-0.921,-0.9360000000000001,2.139,0.225,0.842,1.713,0.726,-0.603,-1.36,-0.54,-1.179,0.407,1.111,-0.117,-0.337,-0.632,-0.631,0.019,-0.608,-0.269,-0.79,-0.015,1.024,0.015,0.8100000000000001,-0.064,0.004,-0.446,0.133,0.054,-1.335,3.671,0.017,3.341,0.93,-0.235,-0.463,0.765,1.129,-0.423,-0.8120000000000001,1.196,1.559,-0.311,-0.231,0.578,-0.027,-0.709,-0.585,-1.077,-0.2,3.79,3.188,-0.356,0.496,0.141,-0.891,-0.888,0.201,1.472,0.9419999999999999,-0.02,-0.835,-2.289,-0.78,0.036,-0.213,-0.745,-0.5580000000000001,-0.245,-0.627,0.037,0.034,-0.472,-0.852,-0.133,-1.925,0.627,-2.039,-0.48,0.269,-0.622,0.058,-1.673,-0.785,-0.413,0.094,-0.855,-0.373,0.099,0.297,-0.295,0.041,-0.524,-0.665,-0.207,-0.522,-0.103,-0.791,-0.644,1.436,-0.066,0.018,-0.491,0.142,2.301,-0.721,-0.957,0.4,-0.9379999999999999,-1.13,-0.5570000000000001,0.8,-0.571,0.901,-2.158,-0.427,-1.533,-1.165,-0.434],[0.947,-0.317,-0.139,0.392,-0.507,0.434,0.547,-0.8080000000000001,-0.6879999999999999,-0.871,-0.5679999999999999,-1.043,0.608,-0.757,-0.892,-0.066,3.971,0.094,-0.154,0.852,-0.219,0.27,2.611,0.453,-0.5659999999999999,0.091,-0.459,-0.303,-1.538,-0.946,-1.098,0.509,1.264,-0.08,-0.076,-1.898,-0.384,0.021,-1.792,0.495,0.025,-0.255,-0.734,1.492,3.035,-0.277,-1.123,0.337,0.44,-0.08799999999999999,1.688,-0.781,0.746,-0.694,-0.102,0.58,0.089,-0.838,-1.48,-1.126,-0.8070000000000001,0.589,-0.351,-0.151,0.822,0.353,-0.6879999999999999,-0.735,-0.229,-0.058,-0.742,0.875,-0.215,-0.066,0.119,-0.448,-1.458,-0.9330000000000001,-0.922,-0.34,-0.083,-0.9429999999999999,-0.675,-0.443,1.566,-0.265,-0.824,0.279,-0.929,-1.174,1.389,1.105,-0.864,-0.12,1.112,-0.946,-0.026,-0.74,0.295,0.9320000000000001,-0.771,-0.2,0.081,-0.243,-1.008,2.481,1.036,-0.151,-0.06,-0.32,0.9,-0.347,-1.231,-0.259,0.9320000000000001,0.8070000000000001,-0.378,-0.128,-0.647,-1.546,0.399,-0.548,1.687,1.861,0.718,0.247,-0.977,0.674,-0.253,1.021,0.967,-0.365,-0.08599999999999999,-0.397,2.624,1.058,0.471,0.095,3.621,0.461,3.493,1.557,-0.189,-0.049,0.394,-0.864,-0.107,0.353,0.312,0.159,0.801,0.546,0.845,0.847,-0.341,-0.542,0.874,0.046,0.373,-0.295,-0.126,-0.592,2.086,-0.374,1.323,0.024,2.097,0.597,0.292,-1.044,0.07099999999999999,-1.055,-2.4,-0.505,1.097,1.789,-1.024,0.35,0.07000000000000001,-0.305,-0.177,-1.351,0.096,0.251,-0.01,0.079,-0.697,-0.653,0.247,-0.371,0.482,3.293,-0.5570000000000001,-0.947,-0.172,1.081,-0.168,0.897,0.458,-0.8149999999999999,-0.734,0.695,1.377,-0.083,-1.165,-1.37,-0.949,-0.586,0.444,-0.612,0.05,-0.236,-0.327,-0.621,-0.391,-0.601,0.238,1.526,0.017,-0.678,1.24,1.287,0.706,-0.679,0.902,2.801,-0.267,1.389,-0.538,0.255,1.122,-0.372,-0.85,-0.777,0.366,-1.43,-0.653,-0.265,-0.017,-2.198,0.127,-0.552,-0.111,0.529,-0.349,-0.052,0.115,0.641,-1.554,-0.755,1.314,2.153,-0.485,1.769,-0.13,-0.094,0.25,1.343,1.949,0.399,0.058,0.008999999999999999,0.46,-0.516,-0.883,-0.189,0.098,-0.324,-0.338,0.09,1.706,-0.527,-0.308,0.711,-0.757,2.286,0.639,4.585,-1.326,-0.384,-1.208,-0.53,-0.78,-0.449,0.342,0.452,-0.18,-1.493,0.265,-0.417,-1.086,-0.536,-0.624,-1.068,-0.235,0.477,-0.387,-0.892,0.252,0.34,-0.324,1.06,-0.717,-0.381,-0.011,-0.003,0.396,-0.8139999999999999,-0.171,0.011,1.088,0.334,-0.588,0.955,-0.872,-0.722,-0.622,-0.321,-0.5620000000000001,1.52,-1.534,-0.003,-0.658,-0.432,-0.79,-0.852,-0.173,-0.262,2.008,-1.254,-0.381,0.452,2.082,-0.988,0.004,0.124,-0.242,-0.441,-0.615,-0.42,-1.03,-0.037,0.732,-1.077,-0.156,-0.385,0.366,1.589,0.373,0.601,-0.408,0.272,-0.634,-0.235,-1.364,-0.061,1.859,-0.459,0.496,1.578,1.141,-0.5679999999999999,0.661,-1.627,-0.796,-0.968,-0.533,-0.473,1.948,-0.169,-0.878,-0.616,3.206,-0.866,-0.175,-0.638,-1.33,-0.476,-0.306,-0.7,-0.921,-0.9360000000000001,2.147,0.225,0.841,1.716,0.725,-0.603,-1.361,-0.54,-1.18,0.407,1.112,-0.117,-0.337,-0.631,-0.631,0.019,-0.608,-0.269,-0.79,-0.015,1.024,0.015,0.8100000000000001,-0.064,0.004,-0.446,0.133,0.054,-1.336,3.718,0.017,3.376,0.93,-0.235,-0.462,0.764,1.13,-0.423,-0.8120000000000001,1.196,1.561,-0.311,-0.231,0.577,-0.027,-0.708,-0.585,-1.078,-0.2,3.843,3.218,-0.355,0.495,0.141,-0.891,-0.887,0.201,1.474,0.9419999999999999,-0.02,-0.835,-2.299,-0.78,0.036,-0.213,-0.744,-0.5580000000000001,-0.245,-0.627,0.037,0.034,-0.471,-0.852,-0.133,-1.93,0.626,-2.045,-0.48,0.268,-0.621,0.058,-1.676,-0.785,-0.413,0.094,-0.855,-0.373,0.099,0.297,-0.294,0.041,-0.524,-0.665,-0.207,-0.522,-0.103,-0.791,-0.644,1.438,-0.065,0.018,-0.491,0.141,2.311,-0.721,-0.957,0.399,-0.9379999999999999,-1.131,-0.556,0.8,-0.571,0.901,-2.166,-0.427,-1.535,-1.166,-0.434],[0.019,0.017,0.006,0.014,0.01,0.01,0.015,0.01,0.015,0.021,0.008999999999999999,0.021,0.016,0.013,0.014,0.016,0.023,0.01,0.017,0.018,0.013,0.013,0.008999999999999999,0.007,0.013,0.008,0.022,0.025,0.008,0.007,0.013,0.017,0.015,0.014,0.019,0.023,0.022,0.013,0.008999999999999999,0.019,0.017,0.007,0.008999999999999999,0.01,0.008999999999999999,0.015,0.014,0.005,0.006,0.018,0.007,0.006,0.013,0.013,0.017,0.006,0.015,0.004,0.007,0.005,0.006,0.004,0.008999999999999999,0.008999999999999999,0.006,0.018,0.005,0.013,0.008,0.008999999999999999,0.017,0.005,0.014,0.035,0.016,0.013,0.008999999999999999,0.005,0.025,0.004,0.015,0.007,0.005,0.006,0.014,0.014,0.007,0.038,0.01,0.006,0.014,0.014,0.011,0.005,0.02,0.004,0.02,0.014,0.008999999999999999,0.007,0.005,0.012,0.008,0.017,0.005,0.011,0.004,0.016,0.017,0.012,0.017,0.007,0.014,0.008999999999999999,0.013,0.013,0.016,0.008999999999999999,0.015,0.007,0.014,0.016,0.011,0.005,0.016,0.004,0.014,0.007,0.006,0.012,0.013,0.018,0.006,0.011,0.008,0.006,0.008999999999999999,0.007,0.02,0.007,0.007,0.008,0.011,0.005,0.005,0.012,0.019,0.008999999999999999,0.006,0.008,0.007,0.013,0.011,0.015,0.006,0.015,0.005,0.006,0.007,0.022,0.017,0.005,0.007,0.005,0.005,0.007,0.005,0.014,0.005,0.005,0.012,0.011,0.03,0.007,0.01,0.01,0.005,0.01,0.014,0.013,0.015,0.008,0.004,0.016,0.014,0.005,0.007,0.008,0.007,0.007,0.008,0.007,0.005,0.018,0.01,0.01,0.008,0.018,0.014,0.008,0.022,0.005,0.005,0.006,0.024,0.016,0.028,0.006,0.005,0.015,0.018,0.005,0.006,0.007,0.008999999999999999,0.005,0.007,0.019,0.013,0.01,0.006,0.005,0.005,0.007,0.007,0.016,0.012,0.011,0.005,0.006,0.005,0.007,0.016,0.012,0.006,0.012,0.004,0.006,0.005,0.018,0.007,0.011,0.005,0.01,0.015,0.01,0.014,0.013,0.042,0.017,0.018,0.013,0.008999999999999999,0.021,0.015,0.006,0.016,0.007,0.005,0.011,0.02,0.019,0.018,0.021,0.005,0.012,0.015,0.019,0.017,0.018,0.007,0.023,0.015,0.006,0.015,0.01,0.006,0.006,0.008,0.015,0.015,0.008,0.011,0.008,0.024,0.025,0.02,0.025,0.007,0.013,0.018,0.006,0.017,0.011,0.008,0.006,0.005,0.008999999999999999,0.01,0.008,0.019,0.008,0.01,0.008,0.005,0.005,0.006,0.005,0.008,0.006,0.005,0.013,0.005,0.01,0.039,0.017,0.01,0.013,0.021,0.017,0.008999999999999999,0.017,0.007,0.015,0.011,0.005,0.008,0.014,0.034,0.005,0.008999999999999999,0.013,0.008,0.006,0.016,0.013,0.01,0.011,0.014,0.006,0.015,0.007,0.005,0.005,0.012,0.007,0.008999999999999999,0.006,0.007,0.006,0.008999999999999999,0.016,0.015,0.008999999999999999,0.007,0.008,0.011,0.016,0.03,0.019,0.017,0.004,0.008999999999999999,0.03,0.016,0.006,0.015,0.007,0.022,0.012,0.023,0.013,0.012,0.007,0.017,0.011,0.008,0.008,0.016,0.01,0.016,0.006,0.005,0.017,0.008,0.013,0.014,0.015,0.008999999999999999,0.014,0.007,0.008999999999999999,0.018,0.015,0.013,0.02,0.008999999999999999,0.006,0.015,0.021,0.017,0.016,0.026,0.017,0.042,0.013,0.014,0.021,0.015,0.008999999999999999,0.019,0.007,0.008999999999999999,0.014,0.016,0.006,0.024,0.008999999999999999,0.008,0.006,0.004,0.008,0.012,0.01,0.035,0.004,0.007,0.013,0.017,0.012,0.019,0.024,0.008999999999999999,0.007,0.015,0.018,0.021,0.012,0.008,0.016,0.018,0.017,0.014,0.021,0.019,0.017,0.006,0.017,0.016,0.008,0.006,0.01,0.027,0.017,0.007,0.007,0.014,0.005,0.011,0.026,0.013,0.011,0.008,0.008,0.014,0.008999999999999999,0.017,0.012,0.008,0.017,0.008,0.01,0.015,0.017,0.008999999999999999,0.01,0.01,0.007,0.008,0.014,0.01,0.004,0.008999999999999999,0.02,0.015,0.015,0.005,0.025,0.016,0.008,0.015,0.008999999999999999,0.007,0.005,0.008999999999999999,0.02,0.007,0.019,0.005,0.02],[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,true,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,true,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,true,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>resid<\/th>\n      <th>rstandard<\/th>\n      <th>rstudent<\/th>\n      <th>hatvalues<\/th>\n      <th>high_leverage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
plot(fitted(clothing_model), rstudent(clothing_model))
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-27-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
plot(clothing_model, which=5)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-28-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

```r
spending_subset %&gt;% select(clothing_expenditure, income, marital_status, sex, personal_care_expenditure) %&gt;%  datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-feccaa57f52619ed0bca" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-feccaa57f52619ed0bca">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500"],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800,313,3000,3440,1570,2475,630,1570,3001,955,3790,1910,1860,2205,4180,7790,1900,1000,3280,2355,1740,5520,1240,3450,1130,3140,3040,1500,1408,455,1000,1120,3410,2655,1800,3830,2250,1100,500,1200,3545,200,3620,2172,3940,1644,2090,909,935,1730,1870,1250,1095,982,1555,5140,1660,1670,4810,2300,1050,4670,3500,2700,2370,3650,910,3100,550,2500,3885,970,1380,2395,1300,1550,7075,4030,1270,1100,820,5505,2400,2390,1130,3250,3470,1790,1850,3400,980,3198,3225,5060,5380,4000,2780,360,4050,1510,3052,3800,525,1609,1510,6840,4140,3415,3350,8600,3560,7890,4660,1540,2215,2710,1550,715,3745,2415,3880,3650,2760,4895,4075,2825,575,4095,1895,2509,232,1135,1419,6120,1930,3995,1580,6105,3025,3340,1360,4190,2440,1655,1460,5210,5300,1410,3050,2550,1260,1550,400,2675,1680,3600,2760,1700,1310,3675,1270,3100,7350,1270,1363,1676,5380,2610,5800,2300,485,800,3960,4200,1775,550,1515,3145,900,2770,800,1070,1750,1530,652,880,1070,2670,4060,1490,1650,3620,4130,3501,750,4615,7440,2950,3827,1325,2200,4600,1500,100,1070,2330,800,1599,1400,2200,980,2500,540,2501,2135,892,1200,2120,2970,2945,2188,3350,5980,1615,3300,1673,1637,3710,4570,4890,2450,2880,1900,1805,265,916,2360,2400,1100,2830,1220,5420,1370,2430,3800,250,7020,3659,8930,300,1150,1119,900,1300,1900,5370,4950,720,1680,3301,1620,1400,1530,400,500,1805,2710,1805,1910,4225,2810,660,4600,900,1600,2150,2050,2355,950,2225,1925,4065,2365,1930,5065,4700,150,999,1665,1410,4210,700,1250,620,1215,580,855,1980,3750,8050,780,3132,4830,6400,1590,1630,2700,3190,610,2045,1185,400,2420,3275,660,2090,2815,4098,5230,2210,4105,1610,1750,477,3100,1522,2863,6620,2600,5380,5200,3050,1615,4401,1165,530,1840,2270,1902,4750,2690,2150,1350,6425,1520,1060,1885,870,1470,1525,1020,300,800,5699,3505,3450,6110,3160,575,730,1850,1590,2950,4780,1150,3270,50,2835,1800,413,2550,305,1130,4335,1340,5700,1700,1850,1172,1900,2185,1500,7725,1375,7264,3907,2810,4575,3560,4866,2509,1290,5075,6175,1499,3120,3400,2580,965,485,1765,650,8820,7000,1710,2030,3085,410,374,1875,3510,2655,1095,1750,950,832,1125,1558,2220,1214,2320,2298,2445,2330,3900,1709,3220,1185,3160,250,1550,2800,890,2529,924,755,850,1660,2562,1680,2130,2644,1450,3470,310,419,1720,1182,1500,2350,910,5880,2600,2090,150,3070,5870,1250,3425,2055,900,150,2899,3030,1375,2752,970,932,2076,850,225],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000,33000,57000,50000,38000,75000,76000,74000,21000,45000,66000,38000,23000,26000,15000,69000,24000,60000,38000,36000,60000,30000,30000,40000,68000,52000,52000,21000,42000,60000,54000,53000,40000,70000,25000,59000,65000,31000,13000,35000,35000,45000,50000,50000,30000,42000,75000,69000,37000,95000,45000,37000,30000,40000,28000,45000,29000,28000,37000,60000,34000,41000,50000,58000,52000,69000,40000,90000,31000,33000,60000,35000,17000,27000,19000,43000,24000,46000,20000,45000,10000,84000,34000,55000,20000,32000,40000,26000,30000,70000,44000,46000,41000,70000,50000,82000,42000,23000,35000,33000,16000,54000,20000,32000,62000,27000,33000,24000,46000,77000,31000,32000,34000,19000,50000,31000,75000,25000,55000,29000,55000,25000,29000,43000,65000,53000,26000,43000,27000,50000,23000,14000,32000,38000,53000,30000,30000,45000,28000,50000,55000,60000,59000,55000,24000,42000,21000,54000,50000,48000,8000,52000,26000,45000,42000,21000,51000,37000,26000,59000,22000,37000,28000,30000,66000,25000,62000,49000,74000,34000,42000,77000,51000,42000,32000,78000,15000,19000,35000,40000,21000,33000,37000,30000,34000,20000,36000,25000,32000,17000,14000,28000,31000,36000,26000,60000,24000,78000,17000,42000,36000,46000,51000,46000,67000,33000,75000,40000,33000,41000,87000,25000,15000,38000,16000,24000,21000,52000,34000,68000,48000,33000,77000,16000,26000,22000,32000,85000,32000,42000,15000,77000,71000,35000,9900,39000,72000,60000,67000,64000,20000,28000,83000,80000,59000,34000,50000,35000,30000,26000,51000,62000,23000,11000,44000,39000,33000,21000,43000,39000,36000,64000,55000,36000,38000,29000,45000,34000,34000,43000,35000,22000,26000,20000,57000,31000,35000,35000,45000,40000,30000,50000,40000,55000,35000,60000,39000,19000,51000,30000,39000,70000,32000,28000,48000,25000,38000,23000,68000,50000,39000,65000,65000,36000,40000,50000,51000,40000,16000,57000,27000,49000,26000,36000,45000,46000,40000,34000,36000,25000,55000,18000,46000,25000,42000,53000,49000,60000,51000,21000,63000,12000,45000,56000,49000,20000,51000,82000,36000,72000,75000,83000,10000,36000,38000,20000,22000,46000,26000,51000,35000,55000,48000,33000,71000,32000,80000,50000,21000,24000,41000,34000,40000,61000,26000,66000,6100,53000,35000,30000,72000,55000,19000,80000,38000,38000,38000,44000,10000,21000,23000,72000,57000,31000,50000,60000,55000,67000,43000,31000,45000,40000,65000,50000,20000,95000,48000,36000,38000,46000,29000,24000,27000,63000,55000,27000,69000,65000,21000,21000,35000,28000,18000,57000,39000,16000,26000,31000,52000,51000,46000,56000,47000,90000,47000,32000,49000,30000,41000,74000,75000,38000,21000,38000,34000,46000,19000,33000,29000,23000,40000,22000,24000,83000,34000,22000,15000,16000,33000,43000,42000,38000,43000,22000,20000,42000,34000,32000,34000,51000,31000,24000,37000,22000,37000,21000,20000,27000,87000,37000,19000],["never_married","never_married","married","never_married","married","married","other","married","never_married","other","married","never_married","other","other","never_married","never_married","other","married","never_married","other","other","never_married","married","married","married","married","other","other","married","married","other","never_married","other","never_married","other","never_married","never_married","married","married","never_married","never_married","married","married","married","married","never_married","married","married","married","never_married","married","married","never_married","married","never_married","married","never_married","married","married","married","married","married","married","married","married","other","married","married","married","married","other","married","never_married","never_married","never_married","married","married","married","married","married","other","married","married","married","other","other","married","never_married","married","married","other","other","married","married","never_married","married","married","never_married","married","married","married","married","married","other","married","married","married","other","other","married","married","married","married","married","never_married","other","other","married","married","married","never_married","married","married","married","married","married","never_married","married","married","married","other","other","married","married","married","married","married","married","other","married","married","married","married","married","married","married","never_married","married","married","married","married","never_married","married","married","married","never_married","married","married","married","other","never_married","married","married","married","married","married","married","never_married","married","married","married","married","married","married","married","married","married","married","never_married","married","other","married","married","never_married","married","married","married","married","married","married","married","married","married","never_married","married","married","married","married","never_married","married","other","married","married","married","other","married","married","married","married","never_married","other","married","married","married","married","married","married","other","married","married","married","married","married","married","married","married","married","married","married","married","married","married","other","married","married","married","married","married","married","married","married","married","married","married","never_married","married","other","never_married","other","other","other","married","married","other","never_married","married","married","married","married","married","other","other","other","other","married","married","other","other","other","other","married","other","married","married","other","married","married","married","married","other","other","married","married","married","married","married","never_married","other","married","other","never_married","married","never_married","married","married","married","married","married","married","married","never_married","married","married","married","married","married","married","married","married","married","married","other","married","married","married","never_married","married","other","never_married","never_married","married","never_married","married","never_married","married","married","married","married","married","married","married","married","married","married","other","other","married","married","other","married","never_married","married","married","married","other","married","married","married","married","married","married","other","other","married","married","married","married","other","married","other","never_married","married","married","other","other","married","married","married","other","married","other","married","married","married","other","married","married","married","other","married","other","married","married","married","married","married","married","never_married","married","other","married","married","never_married","never_married","married","never_married","married","married","never_married","never_married","other","never_married","never_married","other","other","never_married","never_married","other","never_married","married","other","married","married","never_married","never_married","married","married","married","married","married","married","married","married","married","never_married","married","married","never_married","never_married","married","never_married","never_married","married","married","other","married","other","married","married","never_married","never_married","never_married","other","married","other","other","married","never_married","never_married","married","married","married","other","married","married","married","married","married","married","never_married","other","married","married","married","never_married","married","never_married","married","married","never_married","married","married","married","never_married","married","married","married","married","married","never_married","married","married","married","never_married","other","other","married","married","other","married","other","married","married","married","married","married","married","married","married","never_married"],["female","male","male","female","female","male","female","male","female","female","female","male","male","female","female","female","female","female","male","male","female","female","female","male","male","male","male","female","female","female","female","male","female","female","male","female","male","male","male","female","male","male","female","female","male","female","female","male","male","male","female","male","female","male","female","male","female","male","male","male","male","male","male","female","male","male","male","female","male","female","male","male","female","female","male","male","male","male","male","male","female","female","male","male","female","female","female","female","female","male","female","female","male","male","male","male","male","female","female","male","male","female","female","female","male","female","male","female","male","male","male","female","male","male","female","female","female","female","male","female","female","male","male","male","male","male","female","female","male","female","female","female","male","male","female","male","male","female","female","female","male","female","female","male","male","male","male","female","male","male","male","female","male","female","male","female","male","male","male","male","female","male","female","male","male","male","male","female","male","male","male","male","male","male","male","male","male","female","female","male","female","female","male","male","female","male","female","female","male","male","female","female","male","female","female","male","female","female","female","male","male","male","male","male","female","female","female","male","male","female","male","male","male","male","male","male","male","male","female","female","male","male","male","male","male","male","male","female","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","male","female","female","female","female","male","male","female","male","female","male","male","female","male","female","female","male","male","female","male","male","female","male","female","female","female","male","male","male","female","male","male","male","female","female","female","male","female","female","female","male","male","female","female","female","female","male","male","female","female","male","male","male","female","female","male","female","female","male","male","male","male","male","female","male","male","female","male","female","female","male","female","female","male","male","male","male","male","female","female","male","female","female","male","male","male","male","female","male","male","female","male","male","female","male","female","female","male","male","female","female","female","female","male","male","female","male","female","male","male","female","female","female","female","male","female","male","female","male","female","male","male","female","female","male","female","male","female","female","female","male","female","female","male","female","male","male","male","female","female","male","female","female","male","female","female","female","female","female","female","female","female","male","female","female","male","female","female","male","female","female","female","female","female","female","female","male","male","female","female","male","female","female","female","male","male","male","male","female","female","male","female","female","male","male","male","female","male","male","female","female","female","female","male","male","male","female","female","male","female","female","male","female","male","female","male","female","male","female","female","male","female","male","male","female","female","female","female","female","female","male","male","female","female","male","female","female","male","male","male","female","female","male","female","female","female","male","female","male","female","female","male","female","male","female","female","female","male","male","male","female","male","male","male","male"],[1125,1280,1350,1290,490,1870,903,1280,710,1830,760,1530,1140,720,1330,1655,1450,1855,170,766,565,650,635,1690,300,404,135,645,1900,1660,920,990,314,485,1120,1527,545,1950,2120,1410,930,1155,1920,825,1550,1367,650,1460,392,530,1640,1180,1150,255,1880,600,465,1225,880,1020,685,1180,1275,650,925,430,880,400,225,2125,310,790,1090,3040,445,750,1150,970,720,900,300,1020,578,1035,1700,1135,1470,3300,1700,1500,1550,610,2300,960,550,910,890,545,560,800,800,435,880,910,1605,2180,1042,725,220,415,2090,1400,2579,465,810,1200,1490,578,2480,1550,1300,2670,710,1130,850,1010,846,1550,615,350,1050,278,485,310,1670,1355,1650,1500,1700,1436,1645,880,548,730,915,815,130,1360,770,2040,1380,935,2274,787,1740,365,1405,670,400,70,535,1047,1523,870,865,325,1616,1150,1375,1250,2400,2300,3520,1100,2240,1680,1290,740,1090,880,480,985,1075,285,2360,1080,1150,880,1625,740,825,1200,876,1060,555,2080,1080,2325,505,240,340,1390,780,650,450,2348,3317,450,740,790,240,765,800,265,405,630,1215,1140,225,1480,640,1040,1170,595,1595,2350,1310,581,690,510,1500,460,350,335,530,886,1180,519,828,1980,1205,385,1330,392,440,210,630,920,3640,2065,705,846,1120,110,951,525,1195,1140,640,675,1050,475,349,415,840,695,800,220,1820,315,1545,510,800,1060,330,2195,1451,1190,845,395,1392,580,1325,860,3335,3100,315,2717,1320,1195,1340,665,380,450,710,540,1100,1960,2218,775,450,1700,660,470,945,760,475,665,850,699,930,770,1155,2175,4060,215,638,830,1430,1055,1030,400,395,466,350,749,905,2050,3700,1254,1900,2400,1853,1670,580,1230,2198,273,1551,638,500,1100,900,760,1110,1775,2077,1380,540,1610,965,375,540,2060,1927,1180,1985,1995,3440,1680,655,980,1555,2525,924,1700,935,1040,265,950,1580,1400,245,1200,545,1770,1080,780,915,490,500,639,1340,1020,738,1570,295,545,1625,1525,1810,730,1600,323,1705,312,1930,470,225,1164,310,275,940,480,3540,595,540,1240,810,775,1790,705,108,1025,990,1530,3210,770,1780,1680,1100,1540,2400,670,1280,1045,1070,800,230,2175,220,2395,580,580,418,750,135,355,525,475,510,265,1575,2950,1280,190,640,1890,850,950,1572,639,540,2890,1480,1905,2570,850,1250,395,1350,489,855,1864,555,425,660,2410,895,1010,902,523,1295,174,305,831,730,380,1850,576,2240,1275,750,210,1745,1550,1065,3350,410,795,960,2170,798,880,381,2865,388,2130,1230,220]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>clothing_expenditure<\/th>\n      <th>income<\/th>\n      <th>marital_status<\/th>\n      <th>sex<\/th>\n      <th>personal_care_expenditure<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[1,2,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---

```r
X = model.matrix(clothing_model)

Xnew1 = t(data.frame( `(Intercept)`=1, income=68000, marital_statusnever_married=1, marital_statusother=0, sexmale=0, personal_care_expenditure=225))

Xnew2 = t(data.frame( `(Intercept)`=1, income=68000, marital_statusnever_married=0, marital_statusother=0, sexmale=0, personal_care_expenditure=225))

Xnew3 = t(data.frame( `(Intercept)`=1, income=68000, marital_statusnever_married=1, marital_statusother=0, sexmale=1, personal_care_expenditure=3300))

Xnew4 = t(data.frame( `(Intercept)`=1, income=68000, marital_statusnever_married=0, marital_statusother=0, sexmale=1, personal_care_expenditure=3300))

datatable(t(cbind(Xnew1, Xnew2, Xnew3, Xnew4)))
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0265c99c9bfa2fe83414" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0265c99c9bfa2fe83414">{"x":{"filter":"none","vertical":false,"data":[[1,1,1,1],[68000,68000,68000,68000],[1,0,1,0],[0,0,0,0],[0,0,1,1],[225,225,3300,3300]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>X.Intercept.<\/th>\n      <th>income<\/th>\n      <th>marital_statusnever_married<\/th>\n      <th>marital_statusother<\/th>\n      <th>sexmale<\/th>\n      <th>personal_care_expenditure<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
t(Xnew1) %*% solve(t(X) %*% X) %*% Xnew1
```

```
##         [,1]
## [1,] 0.02353
```

```r
t(Xnew2) %*% solve(t(X) %*% X) %*% Xnew2
```

```
##         [,1]
## [1,] 0.02265
```

```r
t(Xnew3) %*% solve(t(X) %*% X) %*% Xnew3
```

```
##         [,1]
## [1,] 0.04658
```

```r
t(Xnew4) %*% solve(t(X) %*% X) %*% Xnew4
```

```
##        [,1]
## [1,] 0.0265
```

&lt;!-- leverage for two new observations: one extrapolating, one interpolating (use socrative to identify which is which)--&gt;


---


```r
GGally::ggpairs(spending_subset %&gt;% select(clothing_expenditure, income, marital_status, sex, personal_care_expenditure))
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-32-1.png" width="504" style="display: block; margin: auto;" /&gt;

---
layout: false

### Identifying Influential Cases `\(-\)` DFFITS, Cook's Distance, and DFBETAS

Points with high *leverage* might have undue influence on the fit of the regression surface. 

However, we can more directly measure which points are **influential**. That is, we can identify the points whose exclusion would cause major changes in the fitted regression function. 

--

To do this, we will consider removing each point `\(i=1, \ldots, n\)` (one-at-a-time) and consider how much that effects

1. the corresponding fitted value `\(\hat Y_i\)`
2. all fitted values  `\(\hat Y_j, \ \ j=1, \ldots, n\)`
3. the estimated regression coefficients

--

We call these measures, respectively, `\(DFFITS\)`, **Cook's Distance**, and `\(DFBETAS\)`. 

---

| Influence Measure | Formula | Guideline for identifying influential cases | 
|-----------|-------------|-----------------------------------------------|
| `\(DFFITS_i\)` | `\(\displaystyle \frac{\hat Y_i - \hat Y_{i(i)}}{\sqrt{MSE_{(i)} h_{ii}}}\)` | exceeding `\(1\)` for small data sets, exceeding `\(2\sqrt{p/n}\)` for large data sets| 
| Cook's `\(D_i\)` | `\(\displaystyle \frac{\sum_{j=1}^n (\hat Y_j - \hat Y_{j(i)})^2}{p MSE}\)` | Near or exceeding the `\(50\)`th percetile of `\(F(p, n-p)\)` | 
| `\(DFBETAS_{k(i)}\)` | `\(\displaystyle \frac{b_k  - b_{k(i)}}{\sqrt{MSE_{(i)} (\mathbb{X'X})^{-1}_{[k,k]}}}\)` | exceeding `\(1\)` for small data sets, exceeding `\(2/\sqrt{n}\)` for large data sets| 

--

&lt;!-- Cook's is large if neither e_i nor h_{ii} are small (either an outlier or with high leverage) --&gt;
&lt;!-- DFFITS is similar, but using studentized deleted residuals t_i--&gt;

* Note that Cook's distance can be calculated from the original model fit since `\(\displaystyle D_i = \frac{e_i^2}{pMSE} \frac{h_{ii}}{(1-h_{ii})^2}\)`. 
  + This will be large if neither `\(e_i\)` nor `\(h_{ii}\)` are small 
  + E.g., it will be large if the point is an outlier and has high leverage

* Similarly, `\(\displaystyle DFFITS_i = t_i \left( \frac{h_{ii}}{1-h_{ii}} \right)\)`, where `\(t_i\)` is the studentized deleted residual


---

layout: true
class: inverse

---


```r
clothing_model = lm(clothing_expenditure~income+marital_status +sex + personal_care_expenditure, data=spending_subset[1:30,])

par(mfrow=c(2,2))
plot(clothing_model)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-33-1.png" width="504" style="display: block; margin: auto;" /&gt;
---

```r
plot(dffits(clothing_model), ylab="DFFITS", type="h")
abline(h=c(-1,1), lty=2)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-34-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

```r
cbind(spending_subset[1:30,], round(abs(dffits(clothing_model)), 4))  %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-67388d3d02ad693eef15" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-67388d3d02ad693eef15">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],["NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL"],["single_detached","single_detached","single_detached","row_house","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","single_detached","single_detached","apartment","apartment","apartment","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000],["never_married","never_married","married","never_married","married","married","other","married","never_married","other","married","never_married","other","other","never_married","never_married","other","married","never_married","other","other","never_married","married","married","married","married","other","other","married","married"],["30-34","25-29","35-39","30-34","25-29","25-29","55-59","55-59","25-29","40-44","50-54","25-29","50-54","50-54","&lt;25","&lt;25","50-54","40-44","35-39","40-44","50-54","50-54","55-59","45-49","30-34","25-29","35-39","60-64","25-29","30-34"],["female","male","male","female","female","male","female","male","female","female","female","male","male","female","female","female","female","female","male","male","female","female","female","male","male","male","male","female","female","female"],[3940,7350,5150,6240,4480,10120,3200,10200,2850,6500,5400,5180,8100,6040,3800,2800,8880,10825,4450,9120,4300,4440,8400,9000,4800,3010,6000,3950,8740,4500],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800],[32670,8396,3456,5308,11576,4501,7846,7982,560,6649,12601,6481,24900,2640,2550,5029,8343,8450,4405,9910,8206,22450,6440,10340,7282,4090,150,4622,4751,6062],[1125,1280,1350,1290,490,1870,903,1280,710,1830,760,1530,1140,720,1330,1655,1450,1855,170,766,565,650,635,1690,300,404,135,645,1900,1660],[2637,5247,2610,2300,1410,1360,2480,6980,1240,4185,3947,2028,4680,800,625,5050,5415,7510,4145,2920,1178,1450,1344,3070,5980,2027,1495,2505,4032,1600],[760,620,900,300,1040,20,2816,3212,105,520,560,0,5230,880,4575,1505,300,331,0,2500,2560,288,1200,2900,390,530,369,3660,0,650],[851,740,255,240,480,888,1307,680,90,784,2096,55,200,492,307,1104,748,1499,77,236,182,312,100,260,1200,350,35,363,1402,743],[57695,46271,28466,33029,49198,76120,37661,58537,11970,58871,37931,19970,63855,36752,23702,34688,64441,73373,24589,32152,30660,47712,42323,64010,47847,28819,19928,39992,55650,34505],[75801,61511,43010,38586,71187,96812,46051,85446,13320,77883,65928,26926,84792,46330,27712,48319,85928,99228,38718,40161,48232,59347,65330,97759,80193,40914,25856,66920,96494,55567],[52,52,52,26,52,52,39,52,52,52,52,52,52,52,52,52,52,48,52,52,52,42,52,42,52,22,52,43,44,40],[0.4296,0.0425,0.036,0.2422,0.2088,0.3672,0.1422,0.4771,0.2028,0.9154,0.2294,0.3763,0.1525,0.4489,0.2668,0.008,2.6383,0.1458,0.0141,0.318,0.2329,0.1605,1.3483,0.2816,0.4351,0.1572,0.3814,0.539,0.6622,0.326]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province<\/th>\n      <th>type_of_dwelling<\/th>\n      <th>income<\/th>\n      <th>marital_status<\/th>\n      <th>age_group<\/th>\n      <th>sex<\/th>\n      <th>food_expenditure<\/th>\n      <th>clothing_expenditure<\/th>\n      <th>transportation_expenditure<\/th>\n      <th>personal_care_expenditure<\/th>\n      <th>recreation_expenditure<\/th>\n      <th>tobacco_alcohol_expenditure<\/th>\n      <th>miscellaneous_expenditure<\/th>\n      <th>total_consumption_expenditure<\/th>\n      <th>total_expenditure<\/th>\n      <th>weeks_worked<\/th>\n      <th>round(abs(dffits(clothing_model)), 4)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[3,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

&lt;!-- exceeding `\(1\)` for small data sets, exceeding `\(2\sqrt{p/n}\)` for large data sets --&gt;
---


```r
plot(cooks.distance(clothing_model), ylab="Cook's Distance", type="h")
abline(h=c(-1,1)*qf(.50, df1=length(clothing_model$coef), df2=summary(clothing_model)$df[2]), lty=2)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-36-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
qf(.50, df1=length(clothing_model$coef), df2=summary(clothing_model)$df[2])
```

```
## [1] 0.9169
```
 &lt;!-- Near or exceeding the `\(50\)`th percetile of `\(F(p, n-p)\)`  --&gt;
---


```r
cbind(spending_subset[1:30,], round(cooks.distance(clothing_model), 4))  %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-826d1a961d31eb28d8eb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-826d1a961d31eb28d8eb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],["NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL"],["single_detached","single_detached","single_detached","row_house","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","single_detached","single_detached","apartment","apartment","apartment","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000],["never_married","never_married","married","never_married","married","married","other","married","never_married","other","married","never_married","other","other","never_married","never_married","other","married","never_married","other","other","never_married","married","married","married","married","other","other","married","married"],["30-34","25-29","35-39","30-34","25-29","25-29","55-59","55-59","25-29","40-44","50-54","25-29","50-54","50-54","&lt;25","&lt;25","50-54","40-44","35-39","40-44","50-54","50-54","55-59","45-49","30-34","25-29","35-39","60-64","25-29","30-34"],["female","male","male","female","female","male","female","male","female","female","female","male","male","female","female","female","female","female","male","male","female","female","female","male","male","male","male","female","female","female"],[3940,7350,5150,6240,4480,10120,3200,10200,2850,6500,5400,5180,8100,6040,3800,2800,8880,10825,4450,9120,4300,4440,8400,9000,4800,3010,6000,3950,8740,4500],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800],[32670,8396,3456,5308,11576,4501,7846,7982,560,6649,12601,6481,24900,2640,2550,5029,8343,8450,4405,9910,8206,22450,6440,10340,7282,4090,150,4622,4751,6062],[1125,1280,1350,1290,490,1870,903,1280,710,1830,760,1530,1140,720,1330,1655,1450,1855,170,766,565,650,635,1690,300,404,135,645,1900,1660],[2637,5247,2610,2300,1410,1360,2480,6980,1240,4185,3947,2028,4680,800,625,5050,5415,7510,4145,2920,1178,1450,1344,3070,5980,2027,1495,2505,4032,1600],[760,620,900,300,1040,20,2816,3212,105,520,560,0,5230,880,4575,1505,300,331,0,2500,2560,288,1200,2900,390,530,369,3660,0,650],[851,740,255,240,480,888,1307,680,90,784,2096,55,200,492,307,1104,748,1499,77,236,182,312,100,260,1200,350,35,363,1402,743],[57695,46271,28466,33029,49198,76120,37661,58537,11970,58871,37931,19970,63855,36752,23702,34688,64441,73373,24589,32152,30660,47712,42323,64010,47847,28819,19928,39992,55650,34505],[75801,61511,43010,38586,71187,96812,46051,85446,13320,77883,65928,26926,84792,46330,27712,48319,85928,99228,38718,40161,48232,59347,65330,97759,80193,40914,25856,66920,96494,55567],[52,52,52,26,52,52,39,52,52,52,52,52,52,52,52,52,52,48,52,52,52,42,52,42,52,22,52,43,44,40],[0.031,0.0003,0.0002,0.0101,0.0075,0.023,0.0035,0.0384,0.0071,0.133,0.008999999999999999,0.0241,0.004,0.0336,0.0121,0,0.6523,0.0037,0,0.0173,0.009299999999999999,0.0045,0.2292,0.0136,0.0324,0.0043,0.0249,0.0487,0.0698,0.018]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province<\/th>\n      <th>type_of_dwelling<\/th>\n      <th>income<\/th>\n      <th>marital_status<\/th>\n      <th>age_group<\/th>\n      <th>sex<\/th>\n      <th>food_expenditure<\/th>\n      <th>clothing_expenditure<\/th>\n      <th>transportation_expenditure<\/th>\n      <th>personal_care_expenditure<\/th>\n      <th>recreation_expenditure<\/th>\n      <th>tobacco_alcohol_expenditure<\/th>\n      <th>miscellaneous_expenditure<\/th>\n      <th>total_consumption_expenditure<\/th>\n      <th>total_expenditure<\/th>\n      <th>weeks_worked<\/th>\n      <th>round(cooks.distance(clothing_model), 4)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[3,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

```r
qf(.50, df1=length(clothing_model$coef), df2=summary(clothing_model)$df[2])
```

```
## [1] 0.9169
```


---


```r
plot(dfbetas(clothing_model)[, "income"], ylab="DFBETAS (income)", type="h")
abline(h=c(-1,1), lty=2)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-38-1.png" width="504" style="display: block; margin: auto;" /&gt;
 &lt;!-- exceeding `\(1\)` for small data sets, exceeding `\(2/\sqrt{n}\)` for large data sets|  --&gt;
---

```r
par(mfrow=c(2,2))
plot(dfbetas(clothing_model)[, "marital_statusnever_married"], ylab="DFBETAS (marital_statusnever_married)", type="h")
abline(h=c(-1,1), lty=2)

plot(dfbetas(clothing_model)[, "marital_statusother"], ylab="DFBETAS (marital_statusother)", type="h")
abline(h=c(-1,1), lty=2)

plot(dfbetas(clothing_model)[, "sexmale"], ylab="DFBETAS (sexmale)", type="h")
abline(h=c(-1,1), lty=2)

plot(dfbetas(clothing_model)[, "personal_care_expenditure"], ylab="DFBETAS (personal_care_expenditure)", type="h")
abline(h=c(-1,1), lty=2)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-39-1.png" width="504" style="display: block; margin: auto;" /&gt;
---


```r
dfbetasPlots(clothing_model)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-40-1.png" width="504" style="display: block; margin: auto;" /&gt;
---

```r
cbind(spending_subset[1:30,], round(abs(dfbetas(clothing_model)), 4))  %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-566dc1322725984c8ab8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-566dc1322725984c8ab8">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],["NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL"],["single_detached","single_detached","single_detached","row_house","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","single_detached","single_detached","apartment","apartment","apartment","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000],["never_married","never_married","married","never_married","married","married","other","married","never_married","other","married","never_married","other","other","never_married","never_married","other","married","never_married","other","other","never_married","married","married","married","married","other","other","married","married"],["30-34","25-29","35-39","30-34","25-29","25-29","55-59","55-59","25-29","40-44","50-54","25-29","50-54","50-54","&lt;25","&lt;25","50-54","40-44","35-39","40-44","50-54","50-54","55-59","45-49","30-34","25-29","35-39","60-64","25-29","30-34"],["female","male","male","female","female","male","female","male","female","female","female","male","male","female","female","female","female","female","male","male","female","female","female","male","male","male","male","female","female","female"],[3940,7350,5150,6240,4480,10120,3200,10200,2850,6500,5400,5180,8100,6040,3800,2800,8880,10825,4450,9120,4300,4440,8400,9000,4800,3010,6000,3950,8740,4500],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800],[32670,8396,3456,5308,11576,4501,7846,7982,560,6649,12601,6481,24900,2640,2550,5029,8343,8450,4405,9910,8206,22450,6440,10340,7282,4090,150,4622,4751,6062],[1125,1280,1350,1290,490,1870,903,1280,710,1830,760,1530,1140,720,1330,1655,1450,1855,170,766,565,650,635,1690,300,404,135,645,1900,1660],[2637,5247,2610,2300,1410,1360,2480,6980,1240,4185,3947,2028,4680,800,625,5050,5415,7510,4145,2920,1178,1450,1344,3070,5980,2027,1495,2505,4032,1600],[760,620,900,300,1040,20,2816,3212,105,520,560,0,5230,880,4575,1505,300,331,0,2500,2560,288,1200,2900,390,530,369,3660,0,650],[851,740,255,240,480,888,1307,680,90,784,2096,55,200,492,307,1104,748,1499,77,236,182,312,100,260,1200,350,35,363,1402,743],[57695,46271,28466,33029,49198,76120,37661,58537,11970,58871,37931,19970,63855,36752,23702,34688,64441,73373,24589,32152,30660,47712,42323,64010,47847,28819,19928,39992,55650,34505],[75801,61511,43010,38586,71187,96812,46051,85446,13320,77883,65928,26926,84792,46330,27712,48319,85928,99228,38718,40161,48232,59347,65330,97759,80193,40914,25856,66920,96494,55567],[52,52,52,26,52,52,39,52,52,52,52,52,52,52,52,52,52,48,52,52,52,42,52,42,52,22,52,43,44,40],[0.0974,0.0171,0.006,0.0502,0.1758,0.02,0.0618,0.1551,0.1172,0.5149,0.146,0.1242,0.0522,0.2067,0.0116,0.0025,1.3154,0.0512,0.0013,0.0143,0.0949,0.0622,1.1626,0.0266,0.0518,0.1057,0.1531,0.0791,0.0292,0.1074],[0.2489,0.0059,0.0089,0.09329999999999999,0.0105,0.1232,0.0852,0.337,0.1029,0.4052,0.0463,0.0692,0.0017,0.1936,0.035,0.0014,1.6667,0.0725,0.0036,0.1101,0.0321,0.0025,0.1952,0.0377,0.2701,0.0394,0.1708,0.3624,0.0275,0.06519999999999999],[0.2034,0.0281,0.0139,0.1539,0.1124,0.0927,0.0012,0.1763,0.1058,0.0122,0.137,0.2481,0.0168,0.0121,0.1754,0.0047,0.1469,0.0535,0.0065,0.0341,0.0163,0.0863,0.7441,0.0922,0.1668,0.0625,0.0233,0.0626,0.3065,0.164],[0.0862,0.004,0.0103,0.0231,0.1209,0.0354,0.0911,0.2237,0.0056,0.3861,0.1516,0.0814,0.1034,0.2715,0.008800000000000001,0.0001,0.8572,0.0278,0.0018,0.2188,0.1202,0.0218,0.758,0.0607,0.238,0.06279999999999999,0.1992,0.1039,0.247,0.1262],[0.1078,0.0262,0.019,0.0776,0.1085,0.1718,0.0458,0.2089,0.0726,0.1113,0.1207,0.2187,0.0934,0.1633,0.0852,0.0018,0.4064,0.0529,0.0058,0.1697,0.0896,0.0611,0.7269,0.1487,0.1259,0.0512,0.1415,0.1291,0.2433,0.1457],[0.0362,0.0097,0.0097,0.0454,0.1273,0.2283,0.0046,0.0169,0.0543,0.4796,0.1084,0.1654,0.0424,0.0683,0.0539,0.0034,0.6711,0.0743,0.0081,0.0065,0.0795,0.0689,0.6925,0.148,0.2496,0.0827,0.1432,0.1651,0.3546,0.1274]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province<\/th>\n      <th>type_of_dwelling<\/th>\n      <th>income<\/th>\n      <th>marital_status<\/th>\n      <th>age_group<\/th>\n      <th>sex<\/th>\n      <th>food_expenditure<\/th>\n      <th>clothing_expenditure<\/th>\n      <th>transportation_expenditure<\/th>\n      <th>personal_care_expenditure<\/th>\n      <th>recreation_expenditure<\/th>\n      <th>tobacco_alcohol_expenditure<\/th>\n      <th>miscellaneous_expenditure<\/th>\n      <th>total_consumption_expenditure<\/th>\n      <th>total_expenditure<\/th>\n      <th>weeks_worked<\/th>\n      <th>(Intercept)<\/th>\n      <th>income<\/th>\n      <th>marital_statusnever_married<\/th>\n      <th>marital_statusother<\/th>\n      <th>sexmale<\/th>\n      <th>personal_care_expenditure<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[3,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>


---

```r
clothing_model = lm(clothing_expenditure~income+marital_status +sex + personal_care_expenditure, data=spending_subset)
```
&lt;!-- exceeding `\(1\)` for small data sets, exceeding `\(2/\sqrt{n}\)` for large data sets|  --&gt;


```r
ols_plot_dfbetas(clothing_model)
```

&lt;img src="chapter10_files/figure-html/unnamed-chunk-43-1.png" width="504" style="display: block; margin: auto;" /&gt;&lt;img src="chapter10_files/figure-html/unnamed-chunk-43-2.png" width="504" style="display: block; margin: auto;" /&gt;

```r
2/sqrt(dim(spending_subset)[1])
```

```
## [1] 0.08944
```
---


```r
cbind(spending_subset, round(abs(dfbetas(clothing_model)), 4))  %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-eb11ab1ffec1b461c0bf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-eb11ab1ffec1b461c0bf">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500"],["NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","masked","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","masked","PE","PE","PE","PE","masked","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","masked","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","masked","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","PE","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS"],["single_detached","single_detached","single_detached","row_house","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","single_detached","single_detached","apartment","apartment","apartment","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","semi_detached","duplex","single_detached","semi_detached","semi_detached","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","semi_detached","single_detached","single_detached","single_detached","single_detached","semi_detached","semi_detached","semi_detached","row_house","row_house","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","single_detached","duplex","duplex","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","duplex","duplex","single_detached","duplex","duplex","row_house","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","duplex","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","duplex","other","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","semi_detached","semi_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","semi_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","row_house","single_detached","single_detached","semi_detached","single_detached","single_detached","semi_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","row_house","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","apartment","apartment","apartment","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","apartment","single_detached","duplex","single_detached","apartment","row_house","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","row_house","row_house","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","semi_detached","row_house","single_detached","single_detached","other","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","single_detached","other","single_detached","single_detached","single_detached","other","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","single_detached","single_detached","other","duplex","duplex","apartment","single_detached","semi_detached","single_detached","single_detached","apartment","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","row_house","apartment","single_detached","single_detached","single_detached","single_detached","semi_detached","semi_detached","apartment","semi_detached","single_detached","single_detached","semi_detached","semi_detached","apartment","single_detached","apartment","single_detached","semi_detached","apartment","single_detached","single_detached","single_detached","semi_detached","single_detached","other","single_detached","apartment","apartment","apartment","apartment","semi_detached","apartment","single_detached","single_detached","apartment","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","row_house","single_detached","single_detached","apartment","apartment","duplex","single_detached","apartment","single_detached","apartment","single_detached","apartment","apartment","apartment","apartment","single_detached","semi_detached","apartment","apartment","apartment","single_detached","apartment","single_detached","apartment","apartment","single_detached","semi_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","row_house","row_house","apartment","apartment","single_detached","row_house","apartment","single_detached","single_detached","single_detached","apartment","apartment","single_detached","other","other","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","other","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","semi_detached","apartment"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000,33000,57000,50000,38000,75000,76000,74000,21000,45000,66000,38000,23000,26000,15000,69000,24000,60000,38000,36000,60000,30000,30000,40000,68000,52000,52000,21000,42000,60000,54000,53000,40000,70000,25000,59000,65000,31000,13000,35000,35000,45000,50000,50000,30000,42000,75000,69000,37000,95000,45000,37000,30000,40000,28000,45000,29000,28000,37000,60000,34000,41000,50000,58000,52000,69000,40000,90000,31000,33000,60000,35000,17000,27000,19000,43000,24000,46000,20000,45000,10000,84000,34000,55000,20000,32000,40000,26000,30000,70000,44000,46000,41000,70000,50000,82000,42000,23000,35000,33000,16000,54000,20000,32000,62000,27000,33000,24000,46000,77000,31000,32000,34000,19000,50000,31000,75000,25000,55000,29000,55000,25000,29000,43000,65000,53000,26000,43000,27000,50000,23000,14000,32000,38000,53000,30000,30000,45000,28000,50000,55000,60000,59000,55000,24000,42000,21000,54000,50000,48000,8000,52000,26000,45000,42000,21000,51000,37000,26000,59000,22000,37000,28000,30000,66000,25000,62000,49000,74000,34000,42000,77000,51000,42000,32000,78000,15000,19000,35000,40000,21000,33000,37000,30000,34000,20000,36000,25000,32000,17000,14000,28000,31000,36000,26000,60000,24000,78000,17000,42000,36000,46000,51000,46000,67000,33000,75000,40000,33000,41000,87000,25000,15000,38000,16000,24000,21000,52000,34000,68000,48000,33000,77000,16000,26000,22000,32000,85000,32000,42000,15000,77000,71000,35000,9900,39000,72000,60000,67000,64000,20000,28000,83000,80000,59000,34000,50000,35000,30000,26000,51000,62000,23000,11000,44000,39000,33000,21000,43000,39000,36000,64000,55000,36000,38000,29000,45000,34000,34000,43000,35000,22000,26000,20000,57000,31000,35000,35000,45000,40000,30000,50000,40000,55000,35000,60000,39000,19000,51000,30000,39000,70000,32000,28000,48000,25000,38000,23000,68000,50000,39000,65000,65000,36000,40000,50000,51000,40000,16000,57000,27000,49000,26000,36000,45000,46000,40000,34000,36000,25000,55000,18000,46000,25000,42000,53000,49000,60000,51000,21000,63000,12000,45000,56000,49000,20000,51000,82000,36000,72000,75000,83000,10000,36000,38000,20000,22000,46000,26000,51000,35000,55000,48000,33000,71000,32000,80000,50000,21000,24000,41000,34000,40000,61000,26000,66000,6100,53000,35000,30000,72000,55000,19000,80000,38000,38000,38000,44000,10000,21000,23000,72000,57000,31000,50000,60000,55000,67000,43000,31000,45000,40000,65000,50000,20000,95000,48000,36000,38000,46000,29000,24000,27000,63000,55000,27000,69000,65000,21000,21000,35000,28000,18000,57000,39000,16000,26000,31000,52000,51000,46000,56000,47000,90000,47000,32000,49000,30000,41000,74000,75000,38000,21000,38000,34000,46000,19000,33000,29000,23000,40000,22000,24000,83000,34000,22000,15000,16000,33000,43000,42000,38000,43000,22000,20000,42000,34000,32000,34000,51000,31000,24000,37000,22000,37000,21000,20000,27000,87000,37000,19000],["never_married","never_married","married","never_married","married","married","other","married","never_married","other","married","never_married","other","other","never_married","never_married","other","married","never_married","other","other","never_married","married","married","married","married","other","other","married","married","other","never_married","other","never_married","other","never_married","never_married","married","married","never_married","never_married","married","married","married","married","never_married","married","married","married","never_married","married","married","never_married","married","never_married","married","never_married","married","married","married","married","married","married","married","married","other","married","married","married","married","other","married","never_married","never_married","never_married","married","married","married","married","married","other","married","married","married","other","other","married","never_married","married","married","other","other","married","married","never_married","married","married","never_married","married","married","married","married","married","other","married","married","married","other","other","married","married","married","married","married","never_married","other","other","married","married","married","never_married","married","married","married","married","married","never_married","married","married","married","other","other","married","married","married","married","married","married","other","married","married","married","married","married","married","married","never_married","married","married","married","married","never_married","married","married","married","never_married","married","married","married","other","never_married","married","married","married","married","married","married","never_married","married","married","married","married","married","married","married","married","married","married","never_married","married","other","married","married","never_married","married","married","married","married","married","married","married","married","married","never_married","married","married","married","married","never_married","married","other","married","married","married","other","married","married","married","married","never_married","other","married","married","married","married","married","married","other","married","married","married","married","married","married","married","married","married","married","married","married","married","married","other","married","married","married","married","married","married","married","married","married","married","married","never_married","married","other","never_married","other","other","other","married","married","other","never_married","married","married","married","married","married","other","other","other","other","married","married","other","other","other","other","married","other","married","married","other","married","married","married","married","other","other","married","married","married","married","married","never_married","other","married","other","never_married","married","never_married","married","married","married","married","married","married","married","never_married","married","married","married","married","married","married","married","married","married","married","other","married","married","married","never_married","married","other","never_married","never_married","married","never_married","married","never_married","married","married","married","married","married","married","married","married","married","married","other","other","married","married","other","married","never_married","married","married","married","other","married","married","married","married","married","married","other","other","married","married","married","married","other","married","other","never_married","married","married","other","other","married","married","married","other","married","other","married","married","married","other","married","married","married","other","married","other","married","married","married","married","married","married","never_married","married","other","married","married","never_married","never_married","married","never_married","married","married","never_married","never_married","other","never_married","never_married","other","other","never_married","never_married","other","never_married","married","other","married","married","never_married","never_married","married","married","married","married","married","married","married","married","married","never_married","married","married","never_married","never_married","married","never_married","never_married","married","married","other","married","other","married","married","never_married","never_married","never_married","other","married","other","other","married","never_married","never_married","married","married","married","other","married","married","married","married","married","married","never_married","other","married","married","married","never_married","married","never_married","married","married","never_married","married","married","married","never_married","married","married","married","married","married","never_married","married","married","married","never_married","other","other","married","married","other","married","other","married","married","married","married","married","married","married","married","never_married"],["30-34","25-29","35-39","30-34","25-29","25-29","55-59","55-59","25-29","40-44","50-54","25-29","50-54","50-54","&lt;25","&lt;25","50-54","40-44","35-39","40-44","50-54","50-54","55-59","45-49","30-34","25-29","35-39","60-64","25-29","30-34","30-34","&lt;25","55-59","25-29","55-59","40-44","30-34","35-39","55-59","30-34","25-29","60-64","45-49","55-59","25-29","&lt;25","45-49","40-44","40-44","40-44","40-44","25-29","25-29","50-54","30-34","45-49","30-34","50-54","40-44","60-64","55-59","40-44","25-29","45-49","40-44","65-69","30-34","&lt;25","45-49","45-49","40-44","40-44","45-49","40-44","35-39","45-49","35-39","35-39","35-39","25-29","60-64","25-29","50-54","40-44","45-49","40-44","45-49","55-59","40-44","45-49","40-44","55-59","30-34","45-49","35-39","25-29","45-49","25-29","&lt;25","55-59","55-59","65-69","25-29","50-54","45-49","40-44","55-59","50-54","30-34","50-54","35-39","40-44","50-54","30-34","35-39","40-44","50-54","25-29","30-34","50-54","25-29","35-39","30-34","40-44","50-54","50-54","40-44","55-59","50-54","35-39","50-54","60-64","60-64","55-59","35-39","50-54","35-39","40-44","65-69","50-54","60-64","55-59","35-39","35-39","40-44","50-54","40-44","35-39","50-54","35-39","45-49","30-34","45-49","45-49","30-34","60-64","40-44","45-49","45-49","55-59","35-39","55-59","35-39","50-54","40-44","55-59","40-44","25-29","60-64","45-49","35-39","50-54","40-44","45-49","40-44","45-49","55-59","50-54","30-34","30-34","40-44","&lt;25","45-49","40-44","40-44","50-54","50-54","50-54","55-59","45-49","45-49","40-44","50-54","45-49","45-49","30-34","45-49","40-44","25-29","65-69","45-49","35-39","25-29","45-49","60-64","&lt;25","35-39","60-64","35-39","45-49","40-44","45-49","55-59","60-64","60-64","55-59","50-54","45-49","50-54","30-34","45-49","55-59","50-54","60-64","45-49","40-44","60-64","50-54","45-49","50-54","50-54","60-64","60-64","45-49","40-44","60-64","45-49","45-49","50-54","25-29","40-44","&lt;25","40-44","30-34","30-34","&lt;25","50-54","40-44","45-49","60-64","75-79","45-49","50-54","45-49","35-39","35-39","30-34","50-54","&lt;25","45-49","50-54","50-54","55-59","50-54","55-59","55-59","55-59","30-34","45-49","30-34","40-44","50-54","30-34","65-69","45-49","40-44","55-59","40-44","25-29","35-39","30-34","45-49","50-54","25-29","35-39","40-44","25-29","50-54","25-29","40-44","55-59","50-54","55-59","40-44","45-49","25-29","25-29","&lt;25","45-49","40-44","45-49","50-54","40-44","55-59","25-29","40-44","25-29","45-49","50-54","45-49","45-49","40-44","35-39","45-49","45-49","45-49","55-59","50-54","25-29","25-29","65-69","30-34","50-54","50-54","50-54","60-64","25-29","25-29","35-39","35-39","50-54","45-49","50-54","30-34","30-34","35-39","35-39","55-59","40-44","40-44","55-59","40-44","35-39","40-44","45-49","35-39","50-54","30-34","45-49","35-39","55-59","60-64","50-54","30-34","55-59","45-49","45-49","45-49","35-39","35-39","&lt;25","30-34","25-29","55-59","50-54","30-34","35-39","55-59","45-49","55-59","60-64","50-54","55-59","50-54","60-64","30-34","45-49","30-34","45-49","30-34","50-54","60-64","45-49","55-59","40-44","40-44","60-64","&lt;25","30-34","50-54","35-39","60-64","50-54","&lt;25","45-49","35-39","30-34","45-49","30-34","55-59","60-64","50-54","55-59","50-54","55-59","50-54","35-39","35-39","40-44","25-29","60-64","30-34","45-49","50-54","30-34","35-39","55-59","40-44","&lt;25","50-54","55-59","30-34","35-39","30-34","45-49","55-59","40-44","30-34","&lt;25","35-39","25-29","&lt;25","30-34","30-34","30-34","55-59","55-59","25-29","&lt;25","30-34","25-29","45-49","45-49","35-39","40-44","55-59","55-59","25-29","25-29","60-64","60-64","50-54","30-34","30-34","25-29","30-34","25-29","30-34","55-59","55-59","75-79","45-49","45-49","25-29","30-34","30-34","30-34","35-39","45-49","40-44","50-54","45-49","35-39","55-59","45-49","40-44","&lt;25","25-29","45-49","40-44","35-39","50-54","50-54","55-59","25-29","40-44","45-49","50-54","55-59","45-49","55-59","70-74","30-34","60-64","60-64","25-29","45-49","35-39","45-49","45-49"],["female","male","male","female","female","male","female","male","female","female","female","male","male","female","female","female","female","female","male","male","female","female","female","male","male","male","male","female","female","female","female","male","female","female","male","female","male","male","male","female","male","male","female","female","male","female","female","male","male","male","female","male","female","male","female","male","female","male","male","male","male","male","male","female","male","male","male","female","male","female","male","male","female","female","male","male","male","male","male","male","female","female","male","male","female","female","female","female","female","male","female","female","male","male","male","male","male","female","female","male","male","female","female","female","male","female","male","female","male","male","male","female","male","male","female","female","female","female","male","female","female","male","male","male","male","male","female","female","male","female","female","female","male","male","female","male","male","female","female","female","male","female","female","male","male","male","male","female","male","male","male","female","male","female","male","female","male","male","male","male","female","male","female","male","male","male","male","female","male","male","male","male","male","male","male","male","male","female","female","male","female","female","male","male","female","male","female","female","male","male","female","female","male","female","female","male","female","female","female","male","male","male","male","male","female","female","female","male","male","female","male","male","male","male","male","male","male","male","female","female","male","male","male","male","male","male","male","female","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","male","female","female","female","female","male","male","female","male","female","male","male","female","male","female","female","male","male","female","male","male","female","male","female","female","female","male","male","male","female","male","male","male","female","female","female","male","female","female","female","male","male","female","female","female","female","male","male","female","female","male","male","male","female","female","male","female","female","male","male","male","male","male","female","male","male","female","male","female","female","male","female","female","male","male","male","male","male","female","female","male","female","female","male","male","male","male","female","male","male","female","male","male","female","male","female","female","male","male","female","female","female","female","male","male","female","male","female","male","male","female","female","female","female","male","female","male","female","male","female","male","male","female","female","male","female","male","female","female","female","male","female","female","male","female","male","male","male","female","female","male","female","female","male","female","female","female","female","female","female","female","female","male","female","female","male","female","female","male","female","female","female","female","female","female","female","male","male","female","female","male","female","female","female","male","male","male","male","female","female","male","female","female","male","male","male","female","male","male","female","female","female","female","male","male","male","female","female","male","female","female","male","female","male","female","male","female","male","female","female","male","female","male","male","female","female","female","female","female","female","male","male","female","female","male","female","female","male","male","male","female","female","male","female","female","female","male","female","male","female","female","male","female","male","female","female","female","male","male","male","female","male","male","male","male"],[3940,7350,5150,6240,4480,10120,3200,10200,2850,6500,5400,5180,8100,6040,3800,2800,8880,10825,4450,9120,4300,4440,8400,9000,4800,3010,6000,3950,8740,4500,5340,3300,3000,2350,7140,2650,8150,6700,12900,2200,4840,7570,14080,5800,8850,4420,10400,8800,5050,5410,8000,7060,3800,3490,5440,9200,6000,9890,7800,6280,5430,9710,5600,4500,10800,11100,6000,5700,5160,7050,4940,7460,3450,9500,6400,7800,6860,7350,7300,4780,2600,6815,5500,6800,6100,6750,3300,7900,15800,7830,11440,4200,9580,6650,6400,3350,9620,3240,4000,8500,7100,7780,11000,3900,6700,9260,14404,2700,5200,6480,9500,7200,5680,4940,6200,16900,7740,760,8500,3460,4318,6860,6600,7700,9000,6250,3950,6400,4900,3380,7800,1810,6440,6000,14600,5000,6420,7700,4500,5750,9120,10800,6300,6540,8900,6400,7800,1290,7850,5900,5400,9800,7200,6960,5400,3800,11300,8100,8100,3640,5440,7100,8800,5895,8550,6200,13000,4400,11440,8050,5550,3290,7800,6300,4950,5090,6760,7800,1850,4775,2810,5400,5400,4750,12600,4940,13396,6470,10520,5800,8050,8650,5044,5800,6600,5150,11880,6440,2260,3900,4400,7700,6700,8000,5050,10455,9420,6240,7600,5500,2775,5134,5600,6144,4925,8430,5800,11500,5370,5700,8540,7400,5400,5600,8340,10300,3900,8075,3260,8000,8400,4300,5650,4510,5430,8800,6295,6400,5650,7945,6300,2940,6020,4080,3262,5400,4100,4010,7660,7580,5350,6820,10050,2760,10046,5720,10500,7280,6480,15080,5800,6700,8500,3195,6600,7900,5750,6640,6160,5300,14420,9600,7200,7100,2860,9400,7200,6600,9230,8880,8200,9320,6840,5960,6760,15400,5800,8920,7400,5600,3640,8600,5200,8400,4620,6225,7440,3900,12040,5770,5300,3500,5000,6350,3300,8910,4600,4940,6800,6350,10050,4900,10205,7800,9600,2900,5785,4625,2800,16380,5560,4552,4810,5180,11330,5108,10700,9050,10000,7020,9175,13125,11578,5240,4200,6450,8860,8778,9050,8150,3500,8850,9550,4780,9600,10030,7310,8290,6700,12100,8860,6120,5270,8800,6940,6320,8800,6200,7680,8700,4890,8300,7300,6660,2020,5784,7600,5700,7100,7690,3280,10800,15625,7280,4050,4420,12160,6600,10900,11700,5980,4500,10240,6400,13080,5920,7870,3040,10320,6960,7200,6750,3500,5950,4325,300,11960,9080,3110,5500,11230,7020,4930,10450,8400,3980,2840,5680,2400,4900,8200,9350,2396,8300,2400,8500,5760,8150,9300,7170,6300,10500,2000,10935,4453,7200,11300,7200,1800,11520,5000,7800,10320,7680,3600,4900,4000,3975,5235,4200,2800,2900,7600,5415,2800,2280,4710,5800,3900,6080,5290,7740,6700,5600,5900,5720,8110,7850,4800,6891,6600,11700,7460,7340,5250,2000,4200,10020,6500,5245,10130,4400,9045,6100,2710,8250,9080,7620,9150,5000,9680,16620,8784,2700,5450,6440,5200,8680,5300,10200,1600,11250,8640,5748,5160,6880,8490,16320,7800,4400],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800,313,3000,3440,1570,2475,630,1570,3001,955,3790,1910,1860,2205,4180,7790,1900,1000,3280,2355,1740,5520,1240,3450,1130,3140,3040,1500,1408,455,1000,1120,3410,2655,1800,3830,2250,1100,500,1200,3545,200,3620,2172,3940,1644,2090,909,935,1730,1870,1250,1095,982,1555,5140,1660,1670,4810,2300,1050,4670,3500,2700,2370,3650,910,3100,550,2500,3885,970,1380,2395,1300,1550,7075,4030,1270,1100,820,5505,2400,2390,1130,3250,3470,1790,1850,3400,980,3198,3225,5060,5380,4000,2780,360,4050,1510,3052,3800,525,1609,1510,6840,4140,3415,3350,8600,3560,7890,4660,1540,2215,2710,1550,715,3745,2415,3880,3650,2760,4895,4075,2825,575,4095,1895,2509,232,1135,1419,6120,1930,3995,1580,6105,3025,3340,1360,4190,2440,1655,1460,5210,5300,1410,3050,2550,1260,1550,400,2675,1680,3600,2760,1700,1310,3675,1270,3100,7350,1270,1363,1676,5380,2610,5800,2300,485,800,3960,4200,1775,550,1515,3145,900,2770,800,1070,1750,1530,652,880,1070,2670,4060,1490,1650,3620,4130,3501,750,4615,7440,2950,3827,1325,2200,4600,1500,100,1070,2330,800,1599,1400,2200,980,2500,540,2501,2135,892,1200,2120,2970,2945,2188,3350,5980,1615,3300,1673,1637,3710,4570,4890,2450,2880,1900,1805,265,916,2360,2400,1100,2830,1220,5420,1370,2430,3800,250,7020,3659,8930,300,1150,1119,900,1300,1900,5370,4950,720,1680,3301,1620,1400,1530,400,500,1805,2710,1805,1910,4225,2810,660,4600,900,1600,2150,2050,2355,950,2225,1925,4065,2365,1930,5065,4700,150,999,1665,1410,4210,700,1250,620,1215,580,855,1980,3750,8050,780,3132,4830,6400,1590,1630,2700,3190,610,2045,1185,400,2420,3275,660,2090,2815,4098,5230,2210,4105,1610,1750,477,3100,1522,2863,6620,2600,5380,5200,3050,1615,4401,1165,530,1840,2270,1902,4750,2690,2150,1350,6425,1520,1060,1885,870,1470,1525,1020,300,800,5699,3505,3450,6110,3160,575,730,1850,1590,2950,4780,1150,3270,50,2835,1800,413,2550,305,1130,4335,1340,5700,1700,1850,1172,1900,2185,1500,7725,1375,7264,3907,2810,4575,3560,4866,2509,1290,5075,6175,1499,3120,3400,2580,965,485,1765,650,8820,7000,1710,2030,3085,410,374,1875,3510,2655,1095,1750,950,832,1125,1558,2220,1214,2320,2298,2445,2330,3900,1709,3220,1185,3160,250,1550,2800,890,2529,924,755,850,1660,2562,1680,2130,2644,1450,3470,310,419,1720,1182,1500,2350,910,5880,2600,2090,150,3070,5870,1250,3425,2055,900,150,2899,3030,1375,2752,970,932,2076,850,225],[32670,8396,3456,5308,11576,4501,7846,7982,560,6649,12601,6481,24900,2640,2550,5029,8343,8450,4405,9910,8206,22450,6440,10340,7282,4090,150,4622,4751,6062,60,9478,10666,7371,4670,4454,4578,4826,8326,22616,2266,6420,3821,3296,12695,6590,4940,21049,555,5370,7640,3748,15394,3274,4300,3664,40,4815,15166,8054,4850,9880,10147,5440,16718,4188,3841,4280,23202,4840,2040,26080,4145,6444,8960,10412,5567,23193,3776,9376,18930,38620,8428,29320,9285,550,5952,5690,4406,16553,4830,4370,11102,8700,20130,32700,11860,1160,1200,9080,2326,3664,5966,6596,10970,26333,9526,70,2580,5676,8906,12288,9442,4940,4380,5860,13298,3514,26940,3950,3478,17020,15426,9286,5360,4020,3305,10630,4470,3780,9146,2246,5876,5812,12800,11360,7580,4626,4600,12040,4682,5262,7780,3026,6992,11372,5817,6616,6390,24216,4512,1040,5036,4830,5422,2510,4750,36151,5475,1486,364,4300,10168,7750,7986,4155,23325,4201,3590,3700,6126,6126,3670,4788,3670,4530,26769,8340,9330,2880,2050,3510,5482,6100,5530,26945,5700,6900,3908,39509,10845,15961,5452,6146,34985,10752,15276,7900,3150,3662,3630,6610,10230,8005,7530,7728,16076,34156,6570,6860,4818,16314,3102,2382,2453,7960,3757,9045,3270,16233,5970,12149,13530,13252,7652,5000,4562,15303,4926,4720,6680,13674,31370,13980,3216,13436,2850,3418,4552,5442,22336,8760,12552,80,1752,2740,25657,3788,3926,7474,3940,10103,34060,12088,568,3054,7272,7074,4610,24863,2546,6990,6290,330,7680,5990,5410,5170,30626,300,11700,2684,11120,6469,3305,6330,11595,10200,7415,3990,3189,2840,4400,11042,16311,4460,2930,14264,6379,3180,3467,5248,3290,3496,5368,5408,2560,9702,9789,34885,3565,8993,4235,5820,12960,8925,3113,4390,2905,2872,5378,4870,26706,13475,12808,5250,5878,18590,20115,14340,4074,445,4670,20977,14252,5914,31925,7369,5560,5090,8285,10170,5686,20794,6810,4890,6250,5885,5210,4380,7290,4130,7152,14500,10160,6973,12346,7588,8480,10224,6410,5375,3705,18940,11752,5087,19348,23700,8794,3250,4954,2715,5218,2655,4595,2355,4104,7708,2415,4605,7267,8190,7370,4630,1830,3008,10539,2050,5305,10780,3030,6698,10551,10619,4589,3880,6369,3399,5450,1655,6560,18163,4610,6630,6920,7981,3243,2024,1174,4465,5257,4116,3595,8043,10580,2190,7642,8483,2770,1400,3921,3735,3314,2180,1225,6160,7050,6295,3027,5235,6175,6490,11050,11845,3899,12728,11080,3000,10940,9917,5520,5187,4330,3815,9297,11255,4142,1150,7112,2600,8660,791,4514,5093,300,3095,560,4260,6200,16256,7570,3542,9630,21966,3486,10138,3038,6950,4919,2690,3056,7720,4630,9852,8473,5660,3555,9485,6713,7786,8964,6862,14964,4824,100,7327,5843,6154,8589,16510,5695,13025,707,3850,9930,1720,22533,2810,35860,5400,40,5042,28026,4343,3639,6680,27310,28120,3276,145],[1125,1280,1350,1290,490,1870,903,1280,710,1830,760,1530,1140,720,1330,1655,1450,1855,170,766,565,650,635,1690,300,404,135,645,1900,1660,920,990,314,485,1120,1527,545,1950,2120,1410,930,1155,1920,825,1550,1367,650,1460,392,530,1640,1180,1150,255,1880,600,465,1225,880,1020,685,1180,1275,650,925,430,880,400,225,2125,310,790,1090,3040,445,750,1150,970,720,900,300,1020,578,1035,1700,1135,1470,3300,1700,1500,1550,610,2300,960,550,910,890,545,560,800,800,435,880,910,1605,2180,1042,725,220,415,2090,1400,2579,465,810,1200,1490,578,2480,1550,1300,2670,710,1130,850,1010,846,1550,615,350,1050,278,485,310,1670,1355,1650,1500,1700,1436,1645,880,548,730,915,815,130,1360,770,2040,1380,935,2274,787,1740,365,1405,670,400,70,535,1047,1523,870,865,325,1616,1150,1375,1250,2400,2300,3520,1100,2240,1680,1290,740,1090,880,480,985,1075,285,2360,1080,1150,880,1625,740,825,1200,876,1060,555,2080,1080,2325,505,240,340,1390,780,650,450,2348,3317,450,740,790,240,765,800,265,405,630,1215,1140,225,1480,640,1040,1170,595,1595,2350,1310,581,690,510,1500,460,350,335,530,886,1180,519,828,1980,1205,385,1330,392,440,210,630,920,3640,2065,705,846,1120,110,951,525,1195,1140,640,675,1050,475,349,415,840,695,800,220,1820,315,1545,510,800,1060,330,2195,1451,1190,845,395,1392,580,1325,860,3335,3100,315,2717,1320,1195,1340,665,380,450,710,540,1100,1960,2218,775,450,1700,660,470,945,760,475,665,850,699,930,770,1155,2175,4060,215,638,830,1430,1055,1030,400,395,466,350,749,905,2050,3700,1254,1900,2400,1853,1670,580,1230,2198,273,1551,638,500,1100,900,760,1110,1775,2077,1380,540,1610,965,375,540,2060,1927,1180,1985,1995,3440,1680,655,980,1555,2525,924,1700,935,1040,265,950,1580,1400,245,1200,545,1770,1080,780,915,490,500,639,1340,1020,738,1570,295,545,1625,1525,1810,730,1600,323,1705,312,1930,470,225,1164,310,275,940,480,3540,595,540,1240,810,775,1790,705,108,1025,990,1530,3210,770,1780,1680,1100,1540,2400,670,1280,1045,1070,800,230,2175,220,2395,580,580,418,750,135,355,525,475,510,265,1575,2950,1280,190,640,1890,850,950,1572,639,540,2890,1480,1905,2570,850,1250,395,1350,489,855,1864,555,425,660,2410,895,1010,902,523,1295,174,305,831,730,380,1850,576,2240,1275,750,210,1745,1550,1065,3350,410,795,960,2170,798,880,381,2865,388,2130,1230,220],[2637,5247,2610,2300,1410,1360,2480,6980,1240,4185,3947,2028,4680,800,625,5050,5415,7510,4145,2920,1178,1450,1344,3070,5980,2027,1495,2505,4032,1600,1231,6215,899,1195,4520,1106,3000,2030,2740,2155,2671,2807,1215,2415,5470,1780,1510,1560,3402,6120,4210,5556,1457,600,2065,6357,1300,1790,1400,1275,1122,2510,2318,1164,6523,911,2648,600,1518,3110,1075,2050,1430,4155,2468,5998,3224,4206,2950,2265,1723,2760,982,4799,1457,2927,1840,1827,4410,1816,3500,597,4362,3220,5240,825,4542,600,2900,4661,1210,7729,5040,1261,1080,5160,1425,708,420,2450,2398,3895,5728,1269,1035,1647,1931,4880,2500,5720,4694,1335,5250,3020,1722,9137,680,9255,1198,1880,2790,504,922,1906,4765,590,5360,3225,820,3908,7075,1693,3382,2150,2836,3184,1085,6345,2078,4000,6119,2747,4280,2838,2080,943,5118,2615,1207,680,1655,1410,3275,8064,5205,1519,3802,3077,746,1317,7185,4917,1154,3477,4856,796,6116,3835,1935,1740,2985,560,2343,3443,8320,635,3018,1225,1110,860,3423,9190,3322,2120,2475,5490,5664,3610,1832,708,4355,3355,4401,1050,625,3155,1677,1488,6010,480,3680,7229,740,380,6380,3110,6922,5233,1300,1965,951,2975,3990,832,3181,6608,2855,2340,2428,1102,9003,840,6075,2310,2090,976,2244,1714,1850,3590,9510,2741,9157,775,1150,4071,1138,2850,4859,2285,65,7159,1248,1100,1071,1462,2944,674,1560,3936,2593,6100,2250,148,2092,2046,5120,5616,7982,720,6180,476,6300,5279,3226,4890,3200,2690,1495,770,1150,2680,740,3445,2557,3409,1075,2906,5750,2133,2511,2360,1240,1305,2215,3720,1045,5460,4285,1965,120,2660,360,2106,3660,3170,8193,3330,1847,2040,2976,4500,2698,4400,6640,750,3023,1835,2137,5421,1140,2230,1935,1562,1728,840,9312,3053,6780,6220,7187,5125,5064,5610,2547,2070,4720,528,3160,475,230,1596,6389,2791,404,5555,4798,3657,1753,6700,1550,1655,650,1375,892,3335,6481,4035,1955,8580,1870,1764,5051,2696,311,2772,2489,580,5277,1975,4120,3341,4501,3475,529,1970,1464,1002,1712,2380,720,1422,5309,1600,2850,1691,1740,672,3003,1752,2542,1756,1958,868,8320,612,2500,1025,1704,257,3581,1447,961,2465,1978,1970,1760,2007,844,1750,2680,3240,801,3265,1975,3705,8715,7248,4680,5978,750,4662,4173,7396,1786,1500,4169,695,874,2748,1287,2165,4395,1680,640,1900,1470,2840,3322,2900,3290,335,7902,2054,868,1237,2499,1060,4823,1845,1634,535,7304,7200,2114,3046,2916,6707,1350,1811,145,2748,7722,2761,3293,676,4037,2591,560,4410,1713,690,2287,5697,191,2049,5903,4240,3340,295,7750,550,6857,860,1195,3489,3215,1597,9123,2695,920,4370,3652,4283,3448,530,636,5347,5802,100],[760,620,900,300,1040,20,2816,3212,105,520,560,0,5230,880,4575,1505,300,331,0,2500,2560,288,1200,2900,390,530,369,3660,0,650,4685,3810,2220,3864,4000,120,1100,5280,1560,410,6980,2568,5350,45,2800,1980,1000,9980,0,1780,1960,50,540,14610,960,3432,1312,11380,75,850,300,360,0,0,2480,900,100,1775,3640,5265,3280,0,3620,12450,1410,4920,20,30,2875,120,200,1500,1800,50,2800,250,400,700,500,1075,0,600,50,1230,4200,1990,1200,100,1200,100,1020,4000,50,340,1200,1815,4800,78,2600,400,20,200,2640,980,1220,200,2300,0,1100,2000,100,240,1000,1470,300,4440,1074,2100,2910,4715,1200,0,300,2580,3000,1200,370,3220,600,4350,3160,1500,7060,700,2420,6495,500,752,50,3570,2802,1796,2600,2855,1294,25,5080,4590,10565,1000,892,1300,1900,1765,6310,1860,5680,1235,0,200,300,1800,800,150,6200,0,2020,1820,640,684,200,200,400,2380,0,50,520,600,710,600,200,2476,1600,444,200,900,12925,0,1950,150,800,260,2100,1000,0,1762,1012,0,240,80,980,0,20,23,3012,155,2300,2080,465,4206,526,1300,4250,1517,1120,0,3420,55,4069,700,500,400,5434,2455,1480,300,4220,1565,0,0,0,932,400,0,0,100,500,2420,960,1810,200,1340,1196,2400,1559,0,2200,4920,3664,500,400,750,5020,2585,1710,400,0,400,100,600,3020,4300,3000,200,670,4200,1750,300,1200,1540,20,60,100,120,300,1300,300,680,1200,180,84,1440,380,1180,2200,650,480,360,600,1400,250,100,1500,650,900,250,170,2280,750,4410,1760,2448,460,2280,1200,300,2760,1340,1156,11800,76,500,1170,0,5130,45,100,1500,200,480,1100,150,800,175,200,2500,900,3050,100,3640,1664,720,11110,100,0,2340,200,4785,400,200,30,250,900,300,875,2030,1200,700,1560,600,2520,50,350,500,240,600,75,50,1250,350,1540,3800,25,5090,350,930,1200,4150,150,1620,1300,610,380,200,510,9030,1020,540,3200,2055,7310,460,300,70,0,0,220,1630,0,400,1500,4045,130,300,5935,380,185,3858,3900,3270,3580,3000,400,5425,110,250,250,270,700,0,800,150,1900,1292,400,3620,640,2310,700,5490,2100,9849,1750,55,670,700,1000,900,3330,5610,1150,80,1010,0,1560,415,3160,4160,425,240,0,660,0,4120,142,690,40,1090,600,55,0,3165,1320,275,160,225,5520,4270,2990,780,3760,100,300,250,3090,250,1480,1404,200,480,4550,1650,1646,100,1255,250,350,1285,375,300,2570,0,3850,574,0,3525,0,690,8640,2200],[851,740,255,240,480,888,1307,680,90,784,2096,55,200,492,307,1104,748,1499,77,236,182,312,100,260,1200,350,35,363,1402,743,72,1085,835,271,455,1370,845,500,676,930,1797,395,310,340,990,680,45,1575,120,185,144,437,505,1378,1150,168,132,723,443,250,687,844,1370,200,940,1143,315,240,213,405,735,871,741,823,560,405,314,1083,366,1002,216,480,311,450,965,546,540,1713,800,464,322,200,419,50,476,100,240,68,200,855,1653,760,792,144,305,410,497,52,200,885,266,1080,1109,524,1044,144,140,664,150,858,120,240,256,462,2057,780,437,560,360,240,735,411,259,2256,370,160,100,696,580,350,1150,230,156,613,180,805,775,2405,192,1180,287,210,986,1003,570,355,1416,510,2569,490,72,448,117,683,800,168,300,203,797,1350,325,561,917,415,260,280,744,682,633,1122,541,20,310,596,546,700,950,880,219,140,360,577,142,780,140,894,1085,1118,394,448,1690,1428,984,500,624,150,495,50,276,505,1900,1480,350,161,44,100,100,462,370,1554,382,740,1160,752,1558,200,860,613,2463,1688,913,370,350,510,620,399,170,300,1140,2221,405,950,166,253,347,300,777,180,605,1414,400,647,600,180,210,144,840,381,400,120,964,325,300,120,1136,1350,900,574,144,50,616,1464,1757,1185,592,494,144,163,622,835,1612,180,270,310,889,780,166,2695,480,256,1125,997,375,395,100,120,393,440,1389,120,700,1350,270,990,150,480,30,1014,1898,620,320,205,936,725,750,144,220,1000,388,490,160,96,150,30,382,1768,375,696,350,552,1954,205,1735,750,450,600,180,695,370,300,940,380,1645,1644,480,332,990,445,893,558,350,107,290,873,736,1035,720,659,240,753,833,170,1565,450,50,2022,453,207,265,300,1826,425,820,120,872,545,870,274,220,354,1300,754,1768,1890,680,1424,295,240,742,510,640,568,710,50,2130,48,1160,220,224,440,1020,482,144,1260,975,380,215,60,84,1247,710,1436,2026,525,859,945,780,678,1700,250,201,575,205,230,1312,1120,1346,160,395,925,360,1120,1960,265,800,970,450,170,520,240,860,15,342,113,472,150,384,144,1836,211,1125,958,165,474,250,868,146,1185,345,179,144,395,825,460,320,219,630,384,84,120,718,330,360,230,456,526,75,400,530,260,850,400,653,220,300,290,1142,575,2150,520,200,120,1095,620,390,953,640,150,1004,150],[57695,46271,28466,33029,49198,76120,37661,58537,11970,58871,37931,19970,63855,36752,23702,34688,64441,73373,24589,32152,30660,47712,42323,64010,47847,28819,19928,39992,55650,34505,35315,60379,33679,27460,53383,34371,41153,40677,57737,62771,35809,30446,50961,32836,67675,32915,28379,66713,33223,40703,68042,40682,45657,33961,41466,49995,20374,59966,50344,47639,25883,67355,56536,36166,60185,34402,37317,23407,50420,58008,24142,63184,28001,60291,38310,60501,45521,64189,51837,42280,52204,75037,34379,66570,45255,25243,34359,60070,61345,52315,48337,28693,51118,45730,85927,73830,52103,24953,34318,47304,29121,37383,51393,28969,44175,70780,55882,14471,37805,41753,63855,55543,43633,33698,30955,57065,44351,49780,76960,36538,30198,48930,53292,37466,41469,40678,18234,46195,22810,26069,38825,15590,26089,34702,61165,34655,44959,44127,30065,46247,48838,44714,54787,28475,35320,42611,27499,53078,30268,65781,41407,39707,42605,38045,32963,15094,56068,65856,52091,14640,19297,23817,54396,39672,45925,35630,64289,31649,31535,36892,52928,46721,30678,31501,46832,33826,62926,43417,43020,37485,42314,20225,27598,26779,41138,43912,39201,34146,29709,59936,44588,65103,32037,30117,57926,56902,74574,59409,32678,20167,47852,37412,75794,43955,23559,38169,49786,54816,34857,24213,24244,49722,21343,17911,24761,31653,37870,54069,23134,44629,32681,40548,67050,28193,53906,38356,27201,39670,42894,25507,42436,30178,56749,37453,34176,42759,32128,24239,22669,46471,57701,36442,45625,16672,16830,24936,51295,31507,54421,39933,28189,50722,74143,32297,38799,27311,46467,37526,31115,61852,40600,36250,36209,10228,48501,41213,31050,45299,73125,16350,71152,31262,47352,46547,19922,62753,44529,44244,36364,29255,45262,31385,22720,38542,70326,56994,21336,48907,52822,32590,29757,44807,24880,41538,45310,30065,39561,43942,62317,79569,20383,51847,22254,29886,40420,41225,33850,40418,30983,31633,57714,35299,76878,50081,57448,22566,32980,52814,44147,82097,25763,21680,29389,40515,54030,41404,81196,60427,68838,56231,56304,60240,51370,53129,33265,36240,65506,43274,37682,33028,33455,33905,66597,48520,72552,52461,59333,62345,39278,50322,33398,26686,31365,63337,37534,44904,73000,57387,44767,61001,34702,41359,49048,33029,29809,38934,41723,52031,51210,32481,75742,62274,63616,43526,24402,30583,49519,35938,45750,48404,42200,31816,51964,54320,50568,49930,35816,16222,45471,29416,54101,47757,35397,35809,50929,20588,64621,31040,15747,30018,43447,40668,29820,53685,55607,32425,24365,35383,22068,30656,45730,62261,31066,47874,23996,37211,57952,47487,61742,51335,32439,64586,60714,61416,42499,49513,68961,31447,30231,56347,18607,56753,61720,28790,25365,47350,20959,27225,45367,34792,33644,14211,44333,33271,24706,18118,25734,39011,35448,41071,36953,43382,42820,78374,41421,48251,32703,55082,49882,33336,29439,42719,40969,41288,36985,17844,31125,66199,32519,33150,58540,26225,52245,28850,16181,36345,43955,36031,54179,34438,69995,54515,41593,16300,46082,39830,68414,32321,69840,43759,21009,56149,72444,31563,27542,44099,62714,69818,47826,16228],[75801,61511,43010,38586,71187,96812,46051,85446,13320,77883,65928,26926,84792,46330,27712,48319,85928,99228,38718,40161,48232,59347,65330,97759,80193,40914,25856,66920,96494,55567,43298,68449,51487,34738,73467,63307,60052,51939,76388,89450,51857,35796,69348,51214,89403,49632,69577,90667,42835,58232,76163,48438,56630,60738,56720,61766,21237,81803,68135,65553,58102,93124,89804,57472,86945,49590,44010,31410,55945,75934,37686,89716,44650,65630,39147,84312,66029,77258,85225,58296,55172,83553,46715,87734,57763,27640,50278,86172,96517,65834,57815,44230,74223,73006,98615,95258,90642,28458,51244,72395,37052,54676,65919,32240,69091,93133,70171,17471,55334,66631,79883,82429,74919,37404,36755,58745,46387,67479,98082,54331,45971,66691,81921,50223,90037,67748,20394,51807,30350,26601,48600,20429,32041,56864,82908,55522,55059,56965,54851,58823,53538,56802,61196,47476,48106,60342,32784,85075,36252,84860,46792,39477,54273,60501,48223,21762,81755,69521,71816,19365,18307,37142,66470,61598,53265,47131,82028,32954,56118,57844,85857,64916,46996,39676,61294,44720,90639,69146,50603,60342,55382,32306,37828,39018,59750,58624,58221,51455,51655,63806,67618,78367,44627,57850,78425,85001,90925,86168,39334,28158,69413,76780,99907,54255,48708,41739,57361,63449,47455,31963,31576,57807,21990,21698,28095,43046,52224,66015,36406,60520,40080,52613,80474,36901,85124,48590,47500,54359,53542,59442,69501,54443,69936,67544,46946,74394,41903,34169,26879,75022,70303,42351,59922,18361,19540,31681,63458,32917,66944,56024,32584,55932,84656,34511,39559,41077,83080,46426,48520,73606,68881,44099,41540,10753,75882,48244,42581,69748,81276,18548,99716,60252,70801,80579,40234,76955,63250,48989,50303,42623,64536,43005,32500,59373,96603,66265,21116,66138,88614,35885,54924,55282,30750,54817,59331,49117,56287,54706,99912,93884,26468,72255,34754,52563,49685,50105,44450,53277,58649,46458,76202,37962,92697,79110,94869,32689,49792,67430,48917,94932,45175,27401,34549,61359,69705,57572,87027,87933,82786,77320,95706,80168,89003,81997,33259,48030,73887,46878,43416,38293,67513,43229,73012,65887,74235,68743,87581,81327,55760,53483,44538,40987,41487,89484,56952,67385,98500,66967,63930,73435,37468,61542,90212,43016,36307,52258,64682,77303,62698,54240,99056,76097,86159,52743,24883,42762,76345,50089,58368,78564,63478,44315,71162,81912,58417,90549,55093,20844,52716,38495,67932,66350,63008,38403,94408,21383,80967,35170,20782,53431,67275,49752,58769,59304,76206,43080,35550,37967,30925,34247,65079,79371,39666,59892,47803,55942,86391,67747,63288,79316,61078,91235,77264,76685,77031,65459,90607,36147,34631,59102,23667,67013,98402,43900,29807,75691,35782,26480,54748,41593,37194,16776,59826,49233,30496,23598,36142,52441,65381,75033,66918,52599,75619,96974,57839,60394,39398,83632,75196,55938,38357,52269,61196,53990,46734,23474,44502,77787,42283,41683,86740,28348,72903,45435,17284,45885,53346,52309,61499,52819,88511,77921,55553,16700,56990,44274,96005,40978,86490,54345,26199,66721,78568,41821,35338,47256,74361,75067,67242,18233],[52,52,52,26,52,52,39,52,52,52,52,52,52,52,52,52,52,48,52,52,52,42,52,42,52,22,52,43,44,40,38,48,52,52,52,52,52,16,52,52,52,36,35,52,30,52,52,52,52,52,52,52,52,26,26,28,28,52,52,52,52,52,52,52,52,22,32,52,52,52,52,20,52,50,44,52,52,52,52,25,30,35,39,52,52,40,28,52,52,52,52,52,52,52,30,52,52,20,52,52,52,52,40,52,26,52,52,52,52,40,52,52,52,52,52,46,16,36,52,52,52,24,48,52,52,52,30,52,20,44,52,52,52,52,16,40,52,52,52,52,40,52,52,30,52,52,52,52,18,52,20,24,52,52,17,52,36,32,52,18,20,20,52,44,45,18,52,16,24,52,20,52,52,52,51,52,52,52,46,16,48,20,52,22,48,26,26,23,25,52,22,52,52,52,26,52,52,52,52,44,52,52,52,52,52,44,36,44,52,40,32,20,24,18,31,24,52,22,40,20,22,26,52,24,40,52,40,52,32,16,52,32,17,32,20,52,52,24,42,52,18,16,36,25,20,20,52,52,52,52,32,30,20,33,28,52,52,52,36,52,52,52,52,26,52,52,52,50,52,52,20,52,52,52,52,32,52,52,48,52,52,18,20,52,52,52,22,52,52,52,52,45,52,23,52,52,52,52,52,32,26,28,52,49,40,52,52,52,52,20,52,22,52,52,52,52,52,52,52,20,52,52,25,52,52,19,35,24,52,33,52,52,52,52,36,25,52,23,52,40,37,30,52,52,40,27,52,52,45,30,20,52,32,52,52,52,52,52,52,52,16,52,52,20,52,52,52,52,52,52,52,52,52,52,26,44,52,32,52,52,52,52,52,52,52,52,52,52,19,52,52,52,52,22,52,20,52,32,52,52,52,49,52,52,52,52,17,24,52,24,52,52,24,52,52,52,52,52,38,52,52,52,52,52,52,52,52,52,52,24,39,41,52,52,51,52,52,38,33,36,52,50,52,49,46,52,52,52,52,52,21,52,52,52,24,48,28,44,52,52,52,17,52,19,52,42,52,52,40,52,52,52,40,52,17,19,40,45,52,52,52,52,39,20,20,52,52,52,23,46,52,52,20,52,18,52,52,37,52,30],[0.0343,0.0164,0.0023,0.0044,0.0393,0.002,0.0236,0.0317,0.0311,0.0538,0.03,0.044,0.0223,0.0289,0.0037,0.0022,0.2324,0.0047,0.0025,0.0012,0.0062,0.0048,0.2001,0.0008,0,0.0053,0.0165,0.008399999999999999,0.023,0.0351,0.0359,0.0276,0.0377,0.0022,0.0054,0.1167,0.0241,0.0002,0.0547,0.0214,0.0005999999999999999,0.008500000000000001,0.0299,0.14,0.1346,0.0047,0.0418,0.0007,0.0182,0.0037,0.0756,0.0177,0.0016,0.0011,0.0041,0.007,0.0047,0.0037,0.0129,0.0058,0.0062,0.0052,0.0127,0.0129,0.0073,0.0117,0.0217,0.0819,0.0112,0.0012,0.0008,0.0072,0.0021,0.0033,0.0017,0.0113,0.0446,0.0188,0.0483,0.0039,0.004,0.0623,0.0199,0.0135,0.0172,0.008200000000000001,0.044,0.0192,0.0009,0.0072,0.0003,0.0217,0.0474,0,0.0622,0.0171,0.0013,0.0263,0.023,0.0056,0.0222,0.0209,0.0061,0.0128,0.0101,0.08599999999999999,0.0054,0.008699999999999999,0.0001,0.0246,0.07580000000000001,0.0165,0.07439999999999999,0.0159,0.0233,0.0107,0.0086,0.0104,0.0505,0.0439,0.0046,0.0241,0.0284,0.0063,0.0276,0.0029,0.0355,0.0276,0.009599999999999999,0.1113,0.0011,0.0267,0.0038,0.0032,0.1258,0.0132,0.007,0.0026,0.2024,0.0232,0.0138,0.1018,0.0185,0.0005,0.012,0.0237,0.0022,0.0069,0.0119,0.0066,0.0183,0.0136,0.0279,0.0216,0.0097,0.0264,0.0027,0.002,0.0081,0.0112,0.0075,0.0145,0.0786,0.0005,0.0444,0.0013,0.0276,0.0112,0.0034,0.0151,0.0044,0.0594,0.2248,0.0171,0.0334,0.0323,0.0148,0.0168,0.0005,0.0194,0.0038,0.0985,0.0005,0.0022,0.0003,0.0002,0.0362,0.05,0.008200000000000001,0.0182,0.0304,0.2065,0.0184,0.0295,0.0154,0.0571,0.0063,0.0361,0.015,0.0312,0.0345,0.0095,0.0272,0.0032,0.0163,0.0569,0.0023,0.0239,0.0106,0.0251,0.0009,0.0064,0.0117,0.0302,0.0248,0.02,0.0068,0.0177,0.0018,0.0493,0.0546,0.0336,0.0104,0.0328,0.03,0.0258,0.013,0.1382,0.0123,0.0095,0.0118,0.0068,0.0033,0.0002,0.015,0.0428,0.0057,0.0109,0.0003,0.186,0.0037,0.0392,0.0007,0.0367,0.0171,0.0036,0.0019,0.0118,0.1736,0.021,0.0027,0.0674,0.0399,0.0575,0.0044,0.004,0.0136,0.0795,0.0479,0.0396,0.0019,0.0004,0.0053,0.0427,0.0193,0.0036,0.0001,0.009299999999999999,0.0141,0.0065,0.0868,0.0323,0.0105,0.009599999999999999,0.0391,0.0916,0.0041,0.1025,0.1031,0.009900000000000001,0.0292,0.0281,0.0641,0.0234,0.008999999999999999,0.0216,0.0035,0.065,0.0115,0.007900000000000001,0.0413,0.003,0.0024,0.0798,0.0184,0.0114,0.0077,0.0086,0.0017,0.023,0.0043,0.0512,0.0663,0.0036,0.0003,0.0001,0.0159,0.0159,0.01,0.0004,0.0038,0.0094,0.0066,0.0186,0.07099999999999999,0.0016,0.0589,0.0034,0.0178,0.0476,0.0427,0,0.0346,0.0063,0.0761,0.0225,0.0139,0.0058,0.1869,0.009599999999999999,0.0194,0.0308,0.0606,0.008,0.0001,0.0004,0.0064,0.0324,0.0139,0.0191,0.0123,0.0026,0.0175,0.0175,0.0012,0.0101,0.0089,0.0721,0.0193,0.0161,0.0346,0.0013,0.0361,0.0057,0.0477,0.0021,0.0165,0.0136,0.0023,0.1163,0.06660000000000001,0.0049,0.0076,0.1364,0.0404,0.0236,0.0221,0.027,0.0016,0.0054,0.0528,0.0265,0.2714,0.0423,0.0112,0.008699999999999999,0.0556,0.0381,0.009299999999999999,0.0542,0.0199,0.0152,0.028,0.002,0.0615,0.1038,0.046,0.0299,0.0215,0.0003,0.0394,0.0253,0.0476,0.0059,0.0026,0.0496,0.0018,0.0008,0.0292,0.0116,0.0119,0.0009,0.0479,0,0.0532,0.0015,0.0001,0.0241,0.0054,0.0046,0.0694,0.0054,0.001,0.0255,0.0189,0.0057,0.0283,0.0433,0.0436,0.0065,0.0094,0.0459,0.0737,0.0287,0.0185,0.0013,0.0015,0.012,0.0074,0.0109,0.0037,0.0877,0.0083,0.003,0.0289,0.003,0.0135,0.09030000000000001,0.0116,0.0083,0.0028,0.0013,0.0196,0.1173,0.0344,0.0025,0.008500000000000001,0.03,0.0229,0.0113,0.0169,0.0021,0.0025,0.0103,0.0405,0.0038,0.0248,0.0117,0.0839,0.01,0.0029,0.0603,0.0035,0.0529,0.0112,0.0265,0.0009,0.0169,0.0299,0.0031,0.0241,0.027,0.0023,0.0032,0.0426,0.0194,0.0499,0.0047,0.0154,0.0123,0.0188,0.0001,0.0015,0.012,0.0012,0.0221,0.0172,0.0189,0.0052,0.068,0.0496,0.0094,0.0376,0.0133,0.0566,0.0362,0.0231,0.138,0.0131,0.0111],[0.07489999999999999,0.0002,0.0054,0.0097,0.0055,0.025,0.0256,0.0594,0.0295,0.0683,0.0205,0.0409,0.0062,0.0171,0.0011,0.0021,0.4087,0.0044,0.0033,0.0403,0.002,0.0038,0.0017,0.014,0.0439,0.0038,0.031,0.0332,0.0252,0.0063,0.031,0.0141,0.033,0.0007,0.0043,0.1797,0.0307,0.0015,0.0194,0.0344,0.0005,0.014,0.0253,0.0707,0.1866,0.0116,0.0843,0.0066,0.004,0.0037,0.0331,0.0286,0.0029,0.0543,0.0026,0.0176,0.0033,0.0046,0.0703,0.0331,0.0256,0.0059,0.0239,0.0027,0.0363,0.0143,0.0203,0.0342,0.0021,0.0008,0.0083,0.0195,0.0068,0.0034,0.0005,0.0401,0.0983,0.0139,0.1329,0.0025,0.0007,0.0098,0.0008,0.0176,0.0124,0.0112,0.0185,0.0102,0.0551,0.0361,0.0227,0.0239,0.0182,0.003,0.07389999999999999,0.0057,0.0034,0.008200000000000001,0.0013,0.0454,0.0137,0.0073,0.0013,0.0159,0.008500000000000001,0.1084,0.008200000000000001,0.0091,0.0005999999999999999,0.0251,0.0844,0.0019,0.011,0.0136,0.0115,0.0111,0.021,0.0005,0.0327,0.0292,0.0071,0.0163,0.1295,0.032,0.0767,0.0005999999999999999,0.036,0.0034,0.0051,0.0385,0.0249,0.0195,0.0018,0.0243,0.0736,0.0331,0.0281,0.0024,0.2811,0.0064,0.1337,0.0036,0.0062,0.0011,0.0118,0.0765,0.0048,0.018,0.0104,0.0027,0.0424,0.0121,0.0156,0.0732,0.0055,0.0118,0.0048,0.0017,0.0105,0.0196,0.0071,0.0174,0.007,0.0109,0.0423,0.0005999999999999999,0.0069,0.0167,0.004,0.0299,0.0018,0.0251,0.0123,0.0259,0.0226,0.1219,0.026,0.0164,0.0018,0.0277,0.0051,0.0277,0.0005,0.0005,0.0005,0.0016,0.0044,0.0124,0.008399999999999999,0.019,0.0054,0.0606,0.0179,0.0708,0.0029,0.0378,0.0066,0.0785,0.0011,0.0075,0.0543,0.0111,0.0016,0.0019,0.1155,0.0964,0.0708,0.0073,0.0016,0.0253,0.0021,0.0028,0.0101,0.0077,0.0202,0.0075,0.012,0.0891,0.0005,0.0406,0.0421,0.041,0.0145,0.0262,0.0332,0.197,0.0238,0.0534,0.0013,0.0027,0.0012,0.0111,0.0077,0.0578,0.007,0.1251,0.0066,0.005,0,0.2273,0.0064,0.0358,0.0019,0.0329,0.0098,0.0024,0.0031,0.0055,0.0385,0.0041,0.0646,0.2012,0.0238,0.1044,0.0053,0.002,0.0274,0.0092,0.0063,0.0181,0.005,0.0005,0.0177,0.0427,0.0068,0.0156,0.0045,0.0159,0.0139,0.0049,0.0401,0.0461,0.0315,0.03,0.0127,0.0031,0.0175,0.1686,0.0244,0.0106,0.0507,0.0245,0.0511,0.0131,0.0072,0.0261,0.0105,0.0427,0.0024,0.0102,0.0708,0.02,0.012,0.0207,0.002,0.0061,0.009599999999999999,0.0336,0.0016,0.0022,0.0187,0.033,0.0227,0.0174,0.0003,0.0001,0.0051,0.008800000000000001,0.0032,0.0003,0.0219,0.0025,0.0177,0.0137,0.0213,0.0063,0.0211,0.0067,0.0287,0.0324,0.1103,0.0001,0.0199,0.0153,0.0109,0.0077,0.0047,0.0198,0.0428,0.0174,0.0174,0.0173,0.0143,0.0172,0,0.0019,0.0061,0.0266,0.0162,0.0154,0.0388,0.0008,0.0121,0.0102,0.0005,0.0019,0.0057,0.0003,0.0151,0.014,0.0169,0.0026,0.0279,0.0042,0.0182,0.0023,0.1023,0.0017,0.0353,0.0259,0.07240000000000001,0.0035,0.0336,0.0551,0.0502,0.011,0.0563,0.0025,0.1672,0.0146,0.0839,0.0575,0.0549,0.0071,0.0101,0.0426,0.0415,0.0083,0.0013,0.0075,0.0117,0.018,0.0667,0.0223,0.0008,0.1556,0.039,0.0227,0.08069999999999999,0.0086,0.0136,0.0083,0.0592,0.0025,0.0254,0.0468,0.0235,0.0002,0.0054,0.024,0.0123,0.0005999999999999999,0.1171,0.0005,0.0444,0.0004,0.0001,0.0422,0.0056,0.0014,0.0839,0.1566,0.0003,0.1095,0.0555,0.0058,0.0258,0.0213,0.0215,0.0018,0.0072,0.061,0.0026,0.009900000000000001,0.0347,0.0076,0.0001,0.0027,0.0057,0.0585,0.0098,0.1906,0.1931,0.0137,0.0182,0.0137,0.0614,0.0217,0.0102,0.0344,0.0401,0.0008,0.0216,0.0905,0.0617,0.0013,0.0055,0.0185,0.0077,0.0081,0.0166,0.0015,0.0036,0.0033,0.0102,0.0004,0.0648,0.0016,0.1622,0.0524,0.0057,0.0164,0.0008,0.0207,0.0226,0.0226,0.0029,0.0289,0.0101,0.0018,0.0089,0.0056,0.0042,0.0113,0.0299,0.0098,0.0226,0.0017,0.009299999999999999,0.0115,0.0105,0.0002,0.0005,0.0292,0.0024,0.081,0.0213,0.0333,0.0013,0.0041,0.0598,0.005,0.0418,0.0078,0.0439,0.1405,0.014,0.1554,0.0219,0.0271],[0.0785,0.0367,0.0013,0.0366,0.0254,0.0001,0.0027,0.0157,0.0594,0.0011,0.0274,0.1279,0.0121,0.0072,0.0819,0.0063,0.0349,0.0024,0.015,0.0149,0.0031,0.0218,0.1233,0.0023,0.0193,0.0021,0.0045,0.0064,0.046,0.0299,0.0067,0.0555,0.0244,0.0063,0.0011,0.1665,0.038,0,0.0005999999999999999,0.0435,0.0028,0.0028,0.0188,0.0606,0.0439,0.0265,0.0596,0.0031,0.0113,0.0089,0.052,0.0094,0.0663,0.0242,0.01,0.015,0.0073,0.0116,0.0343,0.0221,0.02,0.0083,0.0067,0.0068,0.0183,0.0019,0.0117,0.0345,0.0065,0.0014,0.0058,0.0196,0.0185,0.0081,0.0123,0.0128,0.0303,0.0157,0.0308,0.0067,0.0014,0.0383,0.016,0.0062,0.0058,0.0005,0.0273,0.035,0.0338,0.0092,0.0031,0.0162,0.0002,0.0024,0.111,0.0174,0.0008,0.0601,0.0144,0.0228,0.0147,0.0094,0.0034,0.0008,0.0081,0.0523,0.0182,0.001,0.0004,0.0064,0.008200000000000001,0.0123,0.0059,0.0055,0.0795,0.0025,0.0017,0.0061,0,0.0545,0.036,0.0051,0.0473,0.0317,0.0204,0.0043,0.0858,0.0224,0.0055,0.0494,0.008200000000000001,0.0049,0.002,0.0129,0.078,0.0105,0.0016,0.0035,0.0112,0.0158,0.0178,0.06809999999999999,0.008699999999999999,0.0011,0.0065,0.0237,0.0109,0.0143,0.0057,0.0005999999999999999,0.0063,0.048,0.0021,0.044,0.0027,0.0431,0.0098,0.0009,0.0107,0.0026,0.0107,0.0086,0.0717,0.008200000000000001,0.0225,0.0005999999999999999,0.0174,0.0546,0.0038,0.0169,0.0001,0.0005,0.0478,0.0061,0.0024,0.004,0.0157,0.0173,0.006,0.0037,0.003,0.0545,0.0016,0.0254,0.0002,0.0014,0.0279,0.0275,0.0028,0.0064,0.0218,0.1231,0.0094,0.0779,0.0081,0.005,0.0074,0.0265,0.0366,0.024,0.0011,0.0091,0.0288,0.0017,0.0271,0.0227,0.0019,0.0144,0.0094,0.0535,0.0005,0.0047,0.0059,0.017,0.008699999999999999,0.0132,0.0025,0.0364,0.0008,0.0204,0.025,0.0186,0.0095,0.0139,0.0107,0.0218,0.0054,0.0624,0.012,0.0061,0.0116,0.0104,0.007,0.0259,0.008399999999999999,0.0376,0.0092,0.0061,0.0003,0.0254,0.0013,0.0118,0.0013,0.0114,0.0284,0.0013,0.0017,0.0555,0.0467,0.0067,0.0219,0.0589,0.0175,0.0155,0.0117,0.0021,0.0059,0.0526,0.045,0.0172,0.0008,0,0.0049,0.0048,0.017,0.0054,0.0013,0.0005999999999999999,0.0005,0.0012,0.0545,0.0015,0.0089,0.0143,0.0119,0.0005,0.0056,0.0544,0.0565,0.007,0.0058,0.0106,0.0248,0.0208,0.002,0.0081,0.0191,0.0305,0.01,0.001,0.0945,0.0137,0.0648,0.0549,0.0107,0.0121,0.0055,0.0005,0.0062,0.0155,0.035,0.0308,0.0317,0.0111,0.0002,0.0001,0.009599999999999999,0.019,0.0078,0.0002,0.022,0.0033,0.0104,0.0224,0.001,0.0727,0.0276,0.0036,0.06859999999999999,0.1733,0.0352,0.0003,0.0158,0.033,0.0397,0.0175,0.0071,0.008500000000000001,0.048,0.016,0.0031,0.0001,0.0599,0.0063,0,0.0005999999999999999,0.0005,0.0103,0.0007,0.008399999999999999,0.0791,0.0014,0.013,0.0235,0.0009,0.0119,0.0091,0.0576,0.007900000000000001,0.0063,0.0159,0.0024,0.0066,0.0002,0.007,0.0026,0.0591,0.0033,0.0002,0.0408,0.09950000000000001,0.0104,0.025,0.0692,0.0026,0.008,0.0144,0.0197,0.0485,0.0043,0.0055,0.0027,0.1742,0.0342,0.0016,0.0005999999999999999,0.0573,0.0208,0.0049,0.0351,0.008,0.0228,0.0218,0.0112,0.0383,0.0284,0.041,0.0503,0.0051,0.001,0.0342,0.0193,0.1021,0.0092,0.0127,0.0525,0.0197,0.0005,0.0465,0.0222,0.0045,0.0012,0.0795,0.0002,0.0283,0.0052,0.0003,0.0017,0.0117,0.0023,0.0008,0.094,0.0005,0.2866,0.0765,0.0028,0.0065,0.0362,0.0326,0.0031,0.0125,0.0165,0.0047,0.0137,0.0185,0.0104,0.0011,0.0594,0.0581,0.0042,0.0208,0.4309,0.0919,0.0095,0.0063,0.0075,0.0227,0.0438,0.0041,0.1557,0.1015,0.0016,0.0007,0.0325,0.0025,0.0005999999999999999,0.0044,0.0732,0.0604,0.0111,0.0071,0.0019,0.0001,0.0069,0.0288,0.0005999999999999999,0.0312,0.0123,0.0415,0.0336,0.0001,0.0293,0.0026,0.0472,0.0615,0.0089,0.0102,0.0158,0.0154,0.0112,0.0121,0.0139,0.0009,0.053,0.0161,0.008399999999999999,0.0221,0.0026,0.0239,0.0512,0.0332,0.0009,0.0008,0.0515,0.0007,0.008500000000000001,0.0103,0.0045,0.0033,0.0417,0.004,0.0133,0.0131,0.0104,0.0205,0.0204,0.0102,0.0141,0.0148,0.0457],[0.0205,0.0067,0.0007,0.0008,0.0249,0.0021,0.05,0.0238,0.0004,0.066,0.0292,0.0334,0.0672,0.0638,0.0026,0.0004,0.2636,0.002,0.0005999999999999999,0.0974,0.0166,0.0036,0.1182,0.0013,0.0233,0.0014,0.0513,0.0169,0.0531,0.0305,0.0963,0.006,0.08790000000000001,0.0011,0.0073,0.0388,0.0016,0.0002,0.0041,0.0081,0.0005,0.0009,0.0173,0.0493,0.0725,0.0018,0.0684,0.0026,0.009599999999999999,0.0003,0.0502,0.0057,0.0041,0.0291,0.0002,0.0162,0.0004,0.0112,0.042,0.0259,0.0219,0.0076,0.009900000000000001,0.0062,0.0223,0.0325,0.0083,0.028,0.0054,0.0015,0.07539999999999999,0.021,0.0026,0.0018,0.0015,0.0174,0.0431,0.0132,0.0468,0.0067,0.0064,0.0364,0.0145,0.0036,0.1444,0.0247,0.0256,0.0076,0.0426,0.0058,0.1282,0.0815,0.0061,0.0027,0.0014,0.0158,0.0012,0.0067,0.0139,0.0275,0.0119,0.007900000000000001,0.0031,0.0232,0.0086,0.0465,0.0188,0.014,0.006,0.0022,0.0222,0.0123,0.0017,0.0031,0.0055,0.0708,0.0378,0.0057,0.0073,0.0601,0.0027,0.0043,0.0615,0.0357,0.0296,0.004,0.0003,0.0228,0.0043,0.0413,0.0752,0.0314,0.0016,0.0149,0.0726,0.0068,0.0013,0.0039,0.2694,0.0153,0.0062,0.0667,0.0074,0.0012,0.0046,0.0327,0.0019,0.0169,0.0039,0.0014,0.0013,0.0013,0.0009,0.0523,0.0042,0.0048,0.009900000000000001,0.0005999999999999999,0.0111,0.0327,0,0.0061,0.07489999999999999,0.0092,0.0155,0.0005,0.0198,0.0007,0.0046,0.0211,0.0005,0.008,0.0293,0.0025,0.0012,0.008800000000000001,0.0196,0.0189,0.0008,0.0002,0.0125,0.0498,0.0016,0.0026,0.0001,0.0016,0.0283,0.0251,0.0043,0.0034,0.0219,0.115,0.0065,0.0203,0.0073,0.0134,0.008200000000000001,0.0403,0.0052,0.0223,0.0618,0.0111,0.0271,0.0013,0.06519999999999999,0.0155,0.0003,0.012,0.008500000000000001,0,0.0054,0.004,0.0041,0.014,0.005,0.0111,0.0009,0.1846,0.0007,0.0157,0.0172,0.0126,0.0076,0.0091,0.0164,0.0359,0.008699999999999999,0.0523,0.0113,0.0051,0.0131,0.0109,0.0863,0.0312,0.0067,0.0526,0.008399999999999999,0.0049,0.0003,0.0615,0.0005,0.0056,0.0011,0.0056,0.0023,0.0008,0.008399999999999999,0.0035,0.1687,0.0723,0.1499,0.0829,0.0142,0.194,0.0002,0.0017,0.0095,0.051,0.0422,0.0141,0.0037,0.0008,0.0496,0.0485,0.0151,0.0072,0.007,0.0286,0.0282,0.0078,0.0512,0.0439,0.0126,0.0179,0.0597,0.0092,0.004,0.0326,0.0515,0.0269,0.0945,0.0063,0.0184,0.0219,0.0037,0.008399999999999999,0.004,0.1619,0.0104,0.0375,0.0177,0.0153,0.009299999999999999,0.0548,0.01,0.0118,0.0041,0.0014,0.0073,0.0153,0.0077,0.0283,0.0274,0.0124,0.0001,0.0001,0.008,0.0187,0.008,0.0002,0.0239,0.0272,0.0127,0.0239,0.0107,0.0078,0.0236,0.0245,0.0188,0.0348,0.0489,0,0.0114,0.0086,0.0359,0.0152,0.0063,0.0119,0.0355,0.0141,0.0063,0.0043,0.06270000000000001,0.0058,0.0004,0.0102,0.0004,0.0055,0.0512,0.0056,0.0205,0.0013,0.0107,0.0233,0.0129,0.0129,0.0095,0.0585,0.0051,0.0091,0.0134,0.0278,0.0551,0.0003,0.013,0.0029,0.0776,0.0427,0.0005,0.1755,0.0036,0.0105,0.0302,0.2147,0.07580000000000001,0.0112,0.0214,0.0197,0.1104,0.0061,0.0609,0.0044,0.1704,0.0351,0.0157,0.0036,0.0622,0.019,0.0326,0.0343,0.09080000000000001,0.0234,0.0143,0.0139,0.0368,0.0512,0.0438,0.0021,0.0033,0.0496,0.0349,0.0197,0.0121,0.0011,0.0166,0.001,0.0243,0.0004,0.008,0.0063,0.07580000000000001,0.0001,0.0319,0.0016,0.1005,0.0008,0.0001,0.0471,0,0.0021,0.1048,0.1084,0.0004,0.0436,0.0177,0.0038,0.0131,0.0378,0.032,0.0036,0.0114,0.026,0.0017,0.0118,0.0081,0.0111,0.0011,0.0066,0.0042,0.0081,0.0039,0.0757,0.1105,0.0106,0.0416,0.0091,0.0523,0.0383,0.0023,0.0248,0.0201,0.0001,0.0698,0.0299,0.0801,0.003,0.0033,0.0013,0.0074,0.0119,0.0102,0.002,0.0027,0.0102,0.0283,0.001,0.032,0.0113,0.0634,0.0174,0.0244,0.0256,0.0026,0.0483,0.0137,0.0049,0.0019,0.0156,0.0136,0.0021,0.0106,0.0125,0.0015,0.0069,0.0102,0.0068,0.0182,0.0021,0.0269,0.009599999999999999,0.037,0.0009,0.0007,0.0106,0.0134,0.2224,0.0072,0.0074,0.0398,0.0398,0.1056,0.0146,0.0066,0.008800000000000001,0.0123,0.0146,0.0072,0.0397,0.0122,0.009599999999999999],[0.0444,0.0214,0.0064,0.0077,0.0354,0.0246,0.0106,0.0142,0.0154,0.0333,0.0412,0.08359999999999999,0.0413,0.0207,0.0226,0.0019,0.1942,0.0037,0.0075,0.0616,0.0081,0.009900000000000001,0.1711,0.0217,0.0026,0.0032,0.0319,0.0183,0.08260000000000001,0.0483,0.0259,0.0291,0.0559,0.003,0.0039,0.0867,0.015,0.0013,0.0868,0.0203,0.0017,0.012,0.0302,0.0769,0.07240000000000001,0.004,0.0939,0.0143,0.0117,0.0042,0.0813,0.0336,0.0211,0.0027,0.0025,0.0114,0.0024,0.0302,0.028,0.0282,0.0164,0.0215,0.0066,0.0091,0.0167,0.0165,0.0259,0.042,0.0056,0.0025,0.0429,0.0209,0.0077,0.0005999999999999999,0.0069,0.0032,0.0255,0.0328,0.0057,0.0098,0.003,0.0547,0.0182,0.0186,0.0295,0.0047,0.0409,0.0023,0.0619,0.0535,0.0259,0.0436,0.0371,0.003,0.0472,0.0305,0,0.0237,0.0199,0.0165,0.026,0.0118,0.0047,0.0036,0.0417,0.0887,0.0316,0.0028,0.0034,0.014,0.0206,0.0189,0.0609,0.009900000000000001,0.0266,0.019,0.0038,0.0083,0.0247,0.0906,0.0119,0.0329,0.0166,0.0546,0.0031,0.008,0.0216,0.0356,0.0081,0.0612,0.0339,0.009299999999999999,0.0027,0.0034,0.12,0.0464,0.0256,0.0058,0.1435,0.024,0.1718,0.0979,0.0111,0.0011,0.015,0.0072,0.0068,0.0243,0.0116,0.0065,0.0396,0.0134,0.0441,0.0717,0.0127,0.0172,0.0334,0.0017,0.0066,0.0202,0.0027,0.0235,0.115,0.008699999999999999,0.0503,0.0007,0.08450000000000001,0.0122,0.0097,0.0293,0.0031,0.0447,0.1561,0.023,0.0574,0.1018,0.03,0.0264,0.0024,0.016,0.0076,0.0757,0.003,0.014,0.0003,0.0022,0.0421,0.0377,0.0078,0.0153,0.0317,0.1774,0.0212,0.0441,0.0107,0.0398,0.0117,0.0591,0.0159,0.0166,0.0277,0.0228,0.0398,0.0028,0.0704,0.0374,0.0138,0.0165,0.0131,0.0133,0.0032,0.0075,0.0121,0.0161,0.0145,0.0183,0.0111,0.1216,0.001,0.0274,0.0443,0.0516,0.0275,0.0246,0.0274,0.1845,0.0038,0.0788,0.0148,0.0073,0.0424,0.0067,0.0492,0.0045,0.0113,0.0135,0.0239,0.0081,0.0005,0.0422,0.0059,0.0221,0.0044,0.0209,0.0102,0.0017,0.0047,0.018,0.0042,0.0113,0.0946,0.0161,0.023,0.1187,0.0026,0.0029,0.002,0.0771,0.052,0.0216,0.0029,0.0004,0.0299,0.008699999999999999,0.0281,0.0016,0.0042,0.0137,0.009900000000000001,0.0022,0.08260000000000001,0.0193,0.0015,0.016,0.0255,0.1061,0.0282,0.198,0.07729999999999999,0.0167,0.042,0.0201,0.032,0.0313,0.009299999999999999,0.0327,0.0125,0.0019,0.0157,0.008800000000000001,0.0443,0.01,0.038,0.07729999999999999,0.0147,0.0111,0.0151,0.0472,0.0119,0.0222,0.0231,0.0473,0.0412,0.0055,0.0004,0.0001,0.0113,0.0205,0.0115,0.0004,0.0284,0.0102,0.0156,0.0409,0.0256,0.0407,0.0355,0.0117,0.046,0.1062,0.0229,0.0002,0.0209,0.0192,0.0518,0.0264,0.009599999999999999,0.0174,0.1432,0.0481,0.0122,0.0181,0.1013,0.0439,0.0002,0.0037,0.0128,0.0166,0.0178,0.0153,0.0458,0.002,0.0254,0.0287,0.0045,0.0202,0.016,0.0892,0.0135,0.0203,0.0209,0.0159,0.0155,0.0116,0.0548,0.0042,0.1154,0.0083,0.0069,0.1078,0.0207,0.0171,0.0439,0.1488,0.012,0.0366,0.003,0.0291,0.1159,0.0018,0.0399,0.0367,0.2388,0.0522,0.0037,0.0368,0.0897,0.0283,0.0195,0.0489,0.0501,0.0214,0.09370000000000001,0.0191,0.0537,0.0294,0.0601,0.0155,0.0736,0.0103,0.0566,0.0282,0.0386,0.0038,0.0237,0.0125,0.0368,0.0005,0.0222,0.0131,0.0406,0.0004,0.0592,0.001,0.0124,0.0023,0.0002,0.0016,0.0029,0.0031,0.0466,0.0672,0.0004,0.1239,0.0407,0.0076,0.0219,0.0538,0.0526,0.0175,0.0286,0.0314,0.07770000000000001,0.0178,0.0144,0.0169,0.0016,0.023,0.0305,0.0644,0.0132,0.0003,0.0394,0.0062,0.0137,0.0124,0.0508,0.0559,0.0077,0.093,0.0643,0.0005999999999999999,0.0239,0.1516,0.0053,0.0011,0.0072,0.018,0.0328,0.017,0.0204,0.0028,0.0011,0.0185,0.0443,0.0056,0.0645,0.0192,0.0324,0.0304,0.0053,0.0378,0.0038,0.0791,0.0327,0.0157,0.0063,0.0302,0.0207,0.0068,0.0163,0.0183,0.0004,0.0309,0.0228,0.0107,0.028,0.0029,0.0421,0.0249,0.063,0.0024,0.001,0.0337,0.0023,0.0327,0.0287,0.0226,0.0222,0.0585,0.0193,0.0246,0.0337,0.0192,0.0325,0.0484,0.0138,0.0332,0.0458,0.0302],[0.0051,0.0127,0.0035,0.011,0.0302,0.0272,0.0005,0.0034,0.0039,0.0295,0.027,0.0677,0.016,0.0123,0.0222,0.0026,0.0151,0.0039,0.0057,0.0086,0.0073,0.0059,0.1251,0.0205,0.0388,0.0033,0.0122,0.0152,0.047,0.0189,0.0022,0.0077,0.0673,0.0025,0.0008,0.0331,0.0097,0.0015,0.123,0.0075,0.0005,0.004,0.0316,0.0374,0.0483,0.0102,0.0712,0.0094,0.0192,0.0016,0.0364,0.0105,0.0094,0.0498,0.0057,0.0225,0.002,0.008,0.0361,0.0128,0.0271,0.0045,0.0012,0.0064,0.017,0.0109,0.0052,0.0389,0.0125,0.003,0.0203,0.0216,0.0005999999999999999,0.0098,0.0016,0.0189,0.0164,0.0045,0.0517,0.0048,0.0039,0.0194,0.0224,0.0021,0.0692,0.004,0.0092,0.0456,0.0076,0.0386,0.0504,0.0365,0.0634,0.0017,0.0245,0.0101,0.0011,0.0173,0.0158,0.0278,0.0118,0.0106,0.0023,0.0013,0.035,0.1536,0.0054,0.0012,0.002,0.0086,0.0397,0.001,0.1161,0.0076,0.0055,0.0105,0.0155,0.0065,0.051,0.0113,0.0077,0.0596,0.07049999999999999,0.0029,0.0283,0.0012,0.0018,0.008500000000000001,0.0067,0.0593,0.0052,0.014,0.003,0.0255,0.06660000000000001,0.025,0.023,0.0003,0.0926,0.0033,0.1533,0.0504,0.008800000000000001,0.0014,0.002,0.0325,0.0027,0.0042,0.0043,0.0091,0.024,0.0024,0.0679,0.0482,0.013,0.0177,0.0185,0.0009,0.0191,0.0092,0.0018,0.0019,0.0187,0.0078,0.0105,0.0011,0.07199999999999999,0.0117,0.0044,0.0038,0.0056,0.07679999999999999,0.3834,0.0058,0.0862,0.0944,0.0071,0.0179,0.0003,0.0018,0.0076,0.0278,0.0002,0.0061,0.0008,0.0004,0.011,0.0181,0.0066,0.0044,0.0183,0.0235,0.004,0.008200000000000001,0.008500000000000001,0.0606,0.0046,0.0383,0.0127,0.0468,0.0324,0.0108,0.0285,0.002,0.0706,0.1079,0.1362,0.0229,0.009900000000000001,0.0005,0.0013,0.0044,0.004,0.0317,0.0131,0.0165,0.0045,0.0563,0.0011,0.0136,0.0273,0.0043,0.0066,0.0163,0.0218,0.2713,0.0015,0.0595,0.0144,0.008999999999999999,0.029,0.0177,0.0215,0.051,0.0119,0.0469,0.005,0.008800000000000001,0.0003,0.0766,0.0023,0.0176,0.0021,0.0169,0.0092,0.0025,0.0038,0.0003,0.257,0.0509,0.0086,0.079,0.0027,0.0531,0.0012,0.003,0.0044,0.0182,0.0588,0.0141,0.0011,0.0003,0.008699999999999999,0.0119,0.0131,0.0083,0.0025,0.0151,0.014,0.0032,0.0278,0.019,0.0128,0.008200000000000001,0.0324,0.162,0.0185,0.0648,0.0399,0.0186,0.016,0.0123,0.008800000000000001,0.0178,0.0453,0.0648,0.0018,0.1722,0.0014,0.0062,0.0126,0.0193,0.0089,0.0684,0.009599999999999999,0.0185,0.0022,0.0572,0.0134,0.0137,0.0004,0.0297,0.0281,0.0193,0,0.0001,0.0148,0.0246,0.0065,0.0002,0.0165,0.0054,0.0016,0.0526,0.1493,0.0197,0.025,0.006,0.0343,0.0456,0.0307,0,0.0255,0.0167,0.05,0.0174,0.0042,0.0072,0.3522,0.0166,0.016,0.0345,0.0678,0.0404,0,0.0011,0.0186,0.0177,0.0166,0.0091,0.038,0.0005,0.0066,0.0256,0.0005,0.009599999999999999,0.018,0.0007,0.0101,0.0169,0.0071,0.0064,0.0147,0.0156,0.0693,0.0013,0.0514,0.0279,0.07489999999999999,0.08790000000000001,0.0054,0.005,0.0004,0.199,0.0047,0.0354,0.0179,0.0107,0.1358,0.0048,0.0122,0.0247,0.2465,0.0112,0.0035,0.0372,0.0343,0.0164,0.0032,0.0417,0.0187,0.0316,0.0484,0.01,0.0344,0.0187,0.0593,0.0106,0.0643,0.0187,0.0363,0.0188,0.0346,0.0042,0.0017,0.0156,0.0176,0.0007,0.0271,0.0014,0.0263,0.0005,0.0258,0.0002,0.1427,0.0015,0.0001,0.0149,0.0001,0.0018,0.0463,0.1283,0.001,0.0058,0.0092,0.0053,0.0498,0.0345,0.0345,0.0163,0.0018,0.021,0.1325,0.012,0.0025,0.0036,0.0005999999999999999,0.0071,0.0178,0.0882,0.0036,0.4061,0.1498,0.0149,0.0162,0.008699999999999999,0.0663,0.0538,0.0052,0.0107,0.0007,0.0007,0.0239,0.2974,0.0254,0.0017,0.0051,0.0418,0.005,0.008500000000000001,0.0156,0.0021,0.0013,0.0457,0.0081,0.0069,0.1642,0.009599999999999999,0.0151,0.0286,0.0065,0.032,0.0021,0.0578,0.0247,0.013,0.0005999999999999999,0.0638,0.009299999999999999,0.0026,0.0071,0.015,0.0004,0.0143,0.0275,0.0051,0.0168,0.0044,0.0224,0.0178,0.08309999999999999,0.0008,0.0005999999999999999,0.0081,0.0069,0.09329999999999999,0.0032,0.1307,0.009599999999999999,0.0342,0.0068,0.0298,0.0063,0.0063,0.0321,0.2413,0.0165,0.0693,0.0149,0.0067]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province<\/th>\n      <th>type_of_dwelling<\/th>\n      <th>income<\/th>\n      <th>marital_status<\/th>\n      <th>age_group<\/th>\n      <th>sex<\/th>\n      <th>food_expenditure<\/th>\n      <th>clothing_expenditure<\/th>\n      <th>transportation_expenditure<\/th>\n      <th>personal_care_expenditure<\/th>\n      <th>recreation_expenditure<\/th>\n      <th>tobacco_alcohol_expenditure<\/th>\n      <th>miscellaneous_expenditure<\/th>\n      <th>total_consumption_expenditure<\/th>\n      <th>total_expenditure<\/th>\n      <th>weeks_worked<\/th>\n      <th>(Intercept)<\/th>\n      <th>income<\/th>\n      <th>marital_statusnever_married<\/th>\n      <th>marital_statusother<\/th>\n      <th>sexmale<\/th>\n      <th>personal_care_expenditure<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":250,"columnDefs":[{"className":"dt-right","targets":[3,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
layout: false

### Recap: Sections 10.3-10.4

After Sections 10.3-10.4, you should be able to 

- Define leverage and use it to examine model adequacy  
-	Define influential observations and use DFFITS, Cookâ€™s, and DFBETAS to examine model adequacy  


---
### Learning Objectives for Section 10.5

After Section 10.5, you should be able to 

- Define multicollinearity and understand the problems it can cause
- Assess multicollinearity using informal diagnostics and VIF

---
### 10.5: Multicollinearity Diagnostics `\(-\)` Variance Inflation Factor

When we discussed multicollinearity, we noted some key problems that typically arise when the predictor variables being considered for the regression model are highly correlated among themselves:

1. Adding or deleting a predictor variable changes the regression coefficients,
2. The extra sum of squares associated with a predictor variable varies, depending upon which other predictor variables are already included in the model.
3. The estimated standard deviations of the regression coefficients become large when the predictor variables in the regression model are highly correlated with each other.
4. The estimated regression coefficients individually may not be statistically significant even though a definite statistical relation exists between the response variable and the set of predictor variables.

---

### Variance Inflation Factor

The **variance inflation factors** `\((VIF)_{k}\)` measure how much the variances of the estimated regression coefficients are inflated as compared to when the predictor variables are not linearly related.

It can be shown that 

`$$s^2\{b_k\} = \frac{MSE}{(n-1) s^2\{X_k\}} \frac{1}{1-R^2_k}.$$`
where `\(R_k^2\)` is the coefficient of multiple determination for the regression of `\(X_k\)` on the other covariates. 

`$$\frac{1}{1-R^2_k} \text{ is }(VIF)_{k}.$$`

&lt;!--     MSE: greater scatter in the data around the regression surface leads to proportionately more variance in the coefficient estimates --&gt;
&lt;!--     n: greater sample size results in proportionately less variance in the coefficient estimates --&gt;
&lt;!--      s^2\{X_k\}: greater variability in a particular covariate leads to proportionately less variance in the corresponding coefficient estimate --&gt;
&lt;!-- The remaining term, 1 / (1 âˆ’ Rj2) is the VIF. --&gt;

--

`\((VIF)_{k}=1\)` when `\(R_k^2 = 0\)`, i.e., when `\(_k\)` is not linearly related to the other `\(X\)` variables. 

When `\(R_k^2 \neq 0\)`, `\((VIF)_{k}\)` is greater than `\(1\)`, indicating an inflated variance for `\(b_k\)` as a result of the intercorrelations among the `\(X\)` variables. 

---

#### Diagnostic Uses. 

* The largest VIF value among all `\(X\)` variables is often used as an indicator of the severity of multicollinearity. 
	+ A maximum VIF value in excess of `\(10\)` is frequently taken as an indication that multicollinearity may be unduly influencing the least squares estimates.

* Mean VIF values considerably larger than 1 are indicative of serious multicollinearity problems.
	+ Remember that `\(VIF_k \geq 1\)`
	
&gt; Personally, I tend to get concerned when a VIF is greater than 2.50, which corresponds to an `\(R^2\)` of `\(.60\)` with the other variables.  
&gt; `\(-\)` Paul Allison


---
layout: true
class: inverse
---



```r
clothing_model = lm(clothing_expenditure~income+marital_status + age_group + sex + food_expenditure + transportation_expenditure + personal_care_expenditure + recreation_expenditure + tobacco_alcohol_expenditure + miscellaneous_expenditure + total_consumption_expenditure + total_expenditure + weeks_worked + type_of_dwelling, data=spending_subset)

anova(clothing_model) 
```

```
## Analysis of Variance Table
## 
## Response: clothing_expenditure
##                                 Df   Sum Sq  Mean Sq F value  Pr(&gt;F)
## income                           1 2.95e+08 2.95e+08  168.64 &lt; 2e-16
## marital_status                   2 3.86e+08 1.93e+08  110.35 &lt; 2e-16
## age_group                       12 1.04e+08 8.66e+06    4.95 3.5e-08
## sex                              1 1.31e+08 1.31e+08   75.12 &lt; 2e-16
## food_expenditure                 1 5.38e+08 5.38e+08  307.16 &lt; 2e-16
## transportation_expenditure       1 1.40e+07 1.40e+07    7.99  0.0047
## personal_care_expenditure        1 1.40e+09 1.40e+09  798.36 &lt; 2e-16
## recreation_expenditure           1 1.94e+08 1.94e+08  110.81 &lt; 2e-16
## tobacco_alcohol_expenditure      1 2.25e+06 2.25e+06    1.29  0.2570
## miscellaneous_expenditure        1 3.48e+06 3.48e+06    1.99  0.1586
## total_consumption_expenditure    1 2.72e+08 2.72e+08  155.57 &lt; 2e-16
## total_expenditure                1 1.57e+06 1.57e+06    0.90  0.3441
## weeks_worked                     1 4.30e+05 4.30e+05    0.25  0.6204
## type_of_dwelling                 5 4.70e+07 9.41e+06    5.38 6.3e-05
## Residuals                     3316 5.80e+09 1.75e+06
```

---


```r
car::vif(clothing_model)
```

```
##                                GVIF Df GVIF^(1/(2*Df))
## income                        2.005  1           1.416
## marital_status                1.921  2           1.177
## age_group                     1.449 12           1.016
## sex                           1.158  1           1.076
## food_expenditure              1.562  1           1.250
## transportation_expenditure    1.985  1           1.409
## personal_care_expenditure     1.348  1           1.161
## recreation_expenditure        1.412  1           1.188
## tobacco_alcohol_expenditure   1.128  1           1.062
## miscellaneous_expenditure     1.152  1           1.073
## total_consumption_expenditure 7.819  1           2.796
## total_expenditure             7.492  1           2.737
## weeks_worked                  1.144  1           1.070
## type_of_dwelling              1.320  5           1.028
```

&lt;!-- Georges Monette and I [John Fox] introduced the GVIF in the paper "Generalized collinearity diagnostics," JASA 87:178-183, 1992 (link). As we explained, the GVIF represents the squared ratio of hypervolumes of the joint-confidence ellipsoid for a subset of coefficients to the "utopian" ellipsoid that would be obtained if the regressors in this subset were uncorrelated with regressors in the complementary subset. In the case of a single coefficient, this specializes to the usual VIF. To make GVIFs comparable across dimensions, we suggested using GVIF^(1/(2*Df)), where Df is the number of coefficients in the subset. In effect, this reduces the GVIF to a linear measure, and for the VIF, where Df = 1, is proportional to the inflation due to collinearity in the confidence interval for the coefficient. --&gt;
&lt;!-- https://stats.stackexchange.com/questions/70679/which-variance-inflation-factor-should-i-be-using-textgvif-or-textgvif/96584 --&gt;

---


* **Comment on whether there appears to be multicollinearity in this model and what effect it would have in this setting if it were present.**


&lt;!-- PUT SELECT WARM UP RESPONSES HEREHERE (preceded by a "&gt;"): --&gt;
&lt;!-- warm up question 10) 3 --&gt;

* the VIF values of total_consumption_expenditure and total_expenditure are much greater than 1 ( 7.818 and 7.492), which means they are related to the other X variables.

* total_consumption_expenditure and total_expenditure have high GVIFs. Therefore the variables' high multicollinearity could be unduly influencing the model.

* We look at the highest VIF value, 7.8186. That value does not exceed 10 so we would not say that there exists multicollinearity. If we would have multicollinearity our parameters would not be correct and the interpretations could be wrong.

--- 
* there doesn't seem to be much multicollinearity in this model, but if there was any then we wouldn't have a good model at all. Because independent variables should stay independent, they shouldn't depend on eachother

---

layout: false

### Recap: Section 10.5

After Section 10.5, you should be able to 

- Define multicollinearity and understand the problems it can cause
- Assess multicollinearity using informal diagnostics and VIF
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
